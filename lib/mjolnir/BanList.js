"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.USER_RULE_TYPES = exports.SERVER_RULE_TYPES = exports.RULE_USER = exports.RULE_SERVER = exports.RULE_ROOM = exports.ROOM_RULE_TYPES = exports.BanList = exports.ALL_RULE_TYPES = void 0;
exports.ruleTypeToStable = ruleTypeToStable;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _ListRule = require("./ListRule");

var _MatrixClientPeg = require("../MatrixClientPeg");

/*
Copyright 2019 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
// Inspiration largely taken from Mjolnir itself
const RULE_USER = "m.policy.rule.user";
exports.RULE_USER = RULE_USER;
const RULE_ROOM = "m.policy.rule.room";
exports.RULE_ROOM = RULE_ROOM;
const RULE_SERVER = "m.policy.rule.server"; // m.room.* events are legacy from when MSC2313 changed to m.policy.* last minute.

exports.RULE_SERVER = RULE_SERVER;
const USER_RULE_TYPES = [RULE_USER, "m.room.rule.user", "org.matrix.mjolnir.rule.user"];
exports.USER_RULE_TYPES = USER_RULE_TYPES;
const ROOM_RULE_TYPES = [RULE_ROOM, "m.room.rule.room", "org.matrix.mjolnir.rule.room"];
exports.ROOM_RULE_TYPES = ROOM_RULE_TYPES;
const SERVER_RULE_TYPES = [RULE_SERVER, "m.room.rule.server", "org.matrix.mjolnir.rule.server"];
exports.SERVER_RULE_TYPES = SERVER_RULE_TYPES;
const ALL_RULE_TYPES = [...USER_RULE_TYPES, ...ROOM_RULE_TYPES, ...SERVER_RULE_TYPES];
exports.ALL_RULE_TYPES = ALL_RULE_TYPES;

function ruleTypeToStable(rule) {
  if (USER_RULE_TYPES.includes(rule)) {
    return RULE_USER;
  }

  if (ROOM_RULE_TYPES.includes(rule)) {
    return RULE_ROOM;
  }

  if (SERVER_RULE_TYPES.includes(rule)) {
    return RULE_SERVER;
  }

  return null;
}

class BanList {
  constructor(roomId) {
    (0, _defineProperty2.default)(this, "_rules", []);
    (0, _defineProperty2.default)(this, "_roomId", void 0);
    this._roomId = roomId;
    this.updateList();
  }

  get roomId() {
    return this._roomId;
  }

  get serverRules() {
    return this._rules.filter(r => r.kind === RULE_SERVER);
  }

  get userRules() {
    return this._rules.filter(r => r.kind === RULE_USER);
  }

  get roomRules() {
    return this._rules.filter(r => r.kind === RULE_ROOM);
  }

  async banEntity(kind, entity, reason) {
    await _MatrixClientPeg.MatrixClientPeg.get().sendStateEvent(this._roomId, ruleTypeToStable(kind), {
      entity: entity,
      reason: reason,
      recommendation: (0, _ListRule.recommendationToStable)(_ListRule.RECOMMENDATION_BAN, true)
    }, "rule:" + entity);

    this._rules.push(new _ListRule.ListRule(entity, _ListRule.RECOMMENDATION_BAN, reason, ruleTypeToStable(kind)));
  }

  async unbanEntity(kind, entity) {
    // Empty state event is effectively deleting it.
    await _MatrixClientPeg.MatrixClientPeg.get().sendStateEvent(this._roomId, ruleTypeToStable(kind), {}, "rule:" + entity);
    this._rules = this._rules.filter(r => {
      if (r.kind !== ruleTypeToStable(kind)) return true;
      if (r.entity !== entity) return true;
      return false; // we just deleted this rule
    });
  }

  updateList() {
    this._rules = [];

    const room = _MatrixClientPeg.MatrixClientPeg.get().getRoom(this._roomId);

    if (!room) return;

    for (const eventType of ALL_RULE_TYPES) {
      const events = room.currentState.getStateEvents(eventType);

      for (const ev of events) {
        if (!ev.getStateKey()) continue;
        const kind = ruleTypeToStable(eventType);
        const entity = ev.getContent()['entity'];
        const recommendation = ev.getContent()['recommendation'];
        const reason = ev.getContent()['reason'];
        if (!entity || !recommendation || !reason) continue;

        this._rules.push(new _ListRule.ListRule(entity, recommendation, reason, kind));
      }
    }
  }

}

exports.BanList = BanList;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSVUxFX1VTRVIiLCJSVUxFX1JPT00iLCJSVUxFX1NFUlZFUiIsIlVTRVJfUlVMRV9UWVBFUyIsIlJPT01fUlVMRV9UWVBFUyIsIlNFUlZFUl9SVUxFX1RZUEVTIiwiQUxMX1JVTEVfVFlQRVMiLCJydWxlVHlwZVRvU3RhYmxlIiwicnVsZSIsImluY2x1ZGVzIiwiQmFuTGlzdCIsImNvbnN0cnVjdG9yIiwicm9vbUlkIiwiX3Jvb21JZCIsInVwZGF0ZUxpc3QiLCJzZXJ2ZXJSdWxlcyIsIl9ydWxlcyIsImZpbHRlciIsInIiLCJraW5kIiwidXNlclJ1bGVzIiwicm9vbVJ1bGVzIiwiYmFuRW50aXR5IiwiZW50aXR5IiwicmVhc29uIiwiTWF0cml4Q2xpZW50UGVnIiwiZ2V0Iiwic2VuZFN0YXRlRXZlbnQiLCJyZWNvbW1lbmRhdGlvbiIsInJlY29tbWVuZGF0aW9uVG9TdGFibGUiLCJSRUNPTU1FTkRBVElPTl9CQU4iLCJwdXNoIiwiTGlzdFJ1bGUiLCJ1bmJhbkVudGl0eSIsInJvb20iLCJnZXRSb29tIiwiZXZlbnRUeXBlIiwiZXZlbnRzIiwiY3VycmVudFN0YXRlIiwiZ2V0U3RhdGVFdmVudHMiLCJldiIsImdldFN0YXRlS2V5IiwiZ2V0Q29udGVudCJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tam9sbmlyL0Jhbkxpc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE5IFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuLy8gSW5zcGlyYXRpb24gbGFyZ2VseSB0YWtlbiBmcm9tIE1qb2xuaXIgaXRzZWxmXG5cbmltcG9ydCB7IExpc3RSdWxlLCBSRUNPTU1FTkRBVElPTl9CQU4sIHJlY29tbWVuZGF0aW9uVG9TdGFibGUgfSBmcm9tIFwiLi9MaXN0UnVsZVwiO1xuaW1wb3J0IHsgTWF0cml4Q2xpZW50UGVnIH0gZnJvbSBcIi4uL01hdHJpeENsaWVudFBlZ1wiO1xuXG5leHBvcnQgY29uc3QgUlVMRV9VU0VSID0gXCJtLnBvbGljeS5ydWxlLnVzZXJcIjtcbmV4cG9ydCBjb25zdCBSVUxFX1JPT00gPSBcIm0ucG9saWN5LnJ1bGUucm9vbVwiO1xuZXhwb3J0IGNvbnN0IFJVTEVfU0VSVkVSID0gXCJtLnBvbGljeS5ydWxlLnNlcnZlclwiO1xuXG4vLyBtLnJvb20uKiBldmVudHMgYXJlIGxlZ2FjeSBmcm9tIHdoZW4gTVNDMjMxMyBjaGFuZ2VkIHRvIG0ucG9saWN5LiogbGFzdCBtaW51dGUuXG5leHBvcnQgY29uc3QgVVNFUl9SVUxFX1RZUEVTID0gW1JVTEVfVVNFUiwgXCJtLnJvb20ucnVsZS51c2VyXCIsIFwib3JnLm1hdHJpeC5tam9sbmlyLnJ1bGUudXNlclwiXTtcbmV4cG9ydCBjb25zdCBST09NX1JVTEVfVFlQRVMgPSBbUlVMRV9ST09NLCBcIm0ucm9vbS5ydWxlLnJvb21cIiwgXCJvcmcubWF0cml4Lm1qb2xuaXIucnVsZS5yb29tXCJdO1xuZXhwb3J0IGNvbnN0IFNFUlZFUl9SVUxFX1RZUEVTID0gW1JVTEVfU0VSVkVSLCBcIm0ucm9vbS5ydWxlLnNlcnZlclwiLCBcIm9yZy5tYXRyaXgubWpvbG5pci5ydWxlLnNlcnZlclwiXTtcbmV4cG9ydCBjb25zdCBBTExfUlVMRV9UWVBFUyA9IFsuLi5VU0VSX1JVTEVfVFlQRVMsIC4uLlJPT01fUlVMRV9UWVBFUywgLi4uU0VSVkVSX1JVTEVfVFlQRVNdO1xuXG5leHBvcnQgZnVuY3Rpb24gcnVsZVR5cGVUb1N0YWJsZShydWxlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmIChVU0VSX1JVTEVfVFlQRVMuaW5jbHVkZXMocnVsZSkpIHtcbiAgICAgICAgcmV0dXJuIFJVTEVfVVNFUjtcbiAgICB9XG4gICAgaWYgKFJPT01fUlVMRV9UWVBFUy5pbmNsdWRlcyhydWxlKSkge1xuICAgICAgICByZXR1cm4gUlVMRV9ST09NO1xuICAgIH1cbiAgICBpZiAoU0VSVkVSX1JVTEVfVFlQRVMuaW5jbHVkZXMocnVsZSkpIHtcbiAgICAgICAgcmV0dXJuIFJVTEVfU0VSVkVSO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGNsYXNzIEJhbkxpc3Qge1xuICAgIF9ydWxlczogTGlzdFJ1bGVbXSA9IFtdO1xuICAgIF9yb29tSWQ6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHJvb21JZDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX3Jvb21JZCA9IHJvb21JZDtcbiAgICAgICAgdGhpcy51cGRhdGVMaXN0KCk7XG4gICAgfVxuXG4gICAgZ2V0IHJvb21JZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fcm9vbUlkO1xuICAgIH1cblxuICAgIGdldCBzZXJ2ZXJSdWxlcygpOiBMaXN0UnVsZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3J1bGVzLmZpbHRlcihyID0+IHIua2luZCA9PT0gUlVMRV9TRVJWRVIpO1xuICAgIH1cblxuICAgIGdldCB1c2VyUnVsZXMoKTogTGlzdFJ1bGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ydWxlcy5maWx0ZXIociA9PiByLmtpbmQgPT09IFJVTEVfVVNFUik7XG4gICAgfVxuXG4gICAgZ2V0IHJvb21SdWxlcygpOiBMaXN0UnVsZVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3J1bGVzLmZpbHRlcihyID0+IHIua2luZCA9PT0gUlVMRV9ST09NKTtcbiAgICB9XG5cbiAgICBhc3luYyBiYW5FbnRpdHkoa2luZDogc3RyaW5nLCBlbnRpdHk6IHN0cmluZywgcmVhc29uOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgICAgICBhd2FpdCBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuc2VuZFN0YXRlRXZlbnQodGhpcy5fcm9vbUlkLCBydWxlVHlwZVRvU3RhYmxlKGtpbmQpLCB7XG4gICAgICAgICAgICBlbnRpdHk6IGVudGl0eSxcbiAgICAgICAgICAgIHJlYXNvbjogcmVhc29uLFxuICAgICAgICAgICAgcmVjb21tZW5kYXRpb246IHJlY29tbWVuZGF0aW9uVG9TdGFibGUoUkVDT01NRU5EQVRJT05fQkFOLCB0cnVlKSxcbiAgICAgICAgfSwgXCJydWxlOlwiICsgZW50aXR5KTtcbiAgICAgICAgdGhpcy5fcnVsZXMucHVzaChuZXcgTGlzdFJ1bGUoZW50aXR5LCBSRUNPTU1FTkRBVElPTl9CQU4sIHJlYXNvbiwgcnVsZVR5cGVUb1N0YWJsZShraW5kKSkpO1xuICAgIH1cblxuICAgIGFzeW5jIHVuYmFuRW50aXR5KGtpbmQ6IHN0cmluZywgZW50aXR5OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgICAgICAvLyBFbXB0eSBzdGF0ZSBldmVudCBpcyBlZmZlY3RpdmVseSBkZWxldGluZyBpdC5cbiAgICAgICAgYXdhaXQgTWF0cml4Q2xpZW50UGVnLmdldCgpLnNlbmRTdGF0ZUV2ZW50KHRoaXMuX3Jvb21JZCwgcnVsZVR5cGVUb1N0YWJsZShraW5kKSwge30sIFwicnVsZTpcIiArIGVudGl0eSk7XG4gICAgICAgIHRoaXMuX3J1bGVzID0gdGhpcy5fcnVsZXMuZmlsdGVyKHIgPT4ge1xuICAgICAgICAgICAgaWYgKHIua2luZCAhPT0gcnVsZVR5cGVUb1N0YWJsZShraW5kKSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBpZiAoci5lbnRpdHkgIT09IGVudGl0eSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIHdlIGp1c3QgZGVsZXRlZCB0aGlzIHJ1bGVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdXBkYXRlTGlzdCgpIHtcbiAgICAgICAgdGhpcy5fcnVsZXMgPSBbXTtcblxuICAgICAgICBjb25zdCByb29tID0gTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFJvb20odGhpcy5fcm9vbUlkKTtcbiAgICAgICAgaWYgKCFyb29tKSByZXR1cm47XG5cbiAgICAgICAgZm9yIChjb25zdCBldmVudFR5cGUgb2YgQUxMX1JVTEVfVFlQRVMpIHtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50cyA9IHJvb20uY3VycmVudFN0YXRlLmdldFN0YXRlRXZlbnRzKGV2ZW50VHlwZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGV2IG9mIGV2ZW50cykge1xuICAgICAgICAgICAgICAgIGlmICghZXYuZ2V0U3RhdGVLZXkoKSkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBraW5kID0gcnVsZVR5cGVUb1N0YWJsZShldmVudFR5cGUpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZW50aXR5ID0gZXYuZ2V0Q29udGVudCgpWydlbnRpdHknXTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWNvbW1lbmRhdGlvbiA9IGV2LmdldENvbnRlbnQoKVsncmVjb21tZW5kYXRpb24nXTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWFzb24gPSBldi5nZXRDb250ZW50KClbJ3JlYXNvbiddO1xuICAgICAgICAgICAgICAgIGlmICghZW50aXR5IHx8ICFyZWNvbW1lbmRhdGlvbiB8fCAhcmVhc29uKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3J1bGVzLnB1c2gobmV3IExpc3RSdWxlKGVudGl0eSwgcmVjb21tZW5kYXRpb24sIHJlYXNvbiwga2luZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFrQkE7O0FBQ0E7O0FBbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBS08sTUFBTUEsU0FBUyxHQUFHLG9CQUFsQjs7QUFDQSxNQUFNQyxTQUFTLEdBQUcsb0JBQWxCOztBQUNBLE1BQU1DLFdBQVcsR0FBRyxzQkFBcEIsQyxDQUVQOzs7QUFDTyxNQUFNQyxlQUFlLEdBQUcsQ0FBQ0gsU0FBRCxFQUFZLGtCQUFaLEVBQWdDLDhCQUFoQyxDQUF4Qjs7QUFDQSxNQUFNSSxlQUFlLEdBQUcsQ0FBQ0gsU0FBRCxFQUFZLGtCQUFaLEVBQWdDLDhCQUFoQyxDQUF4Qjs7QUFDQSxNQUFNSSxpQkFBaUIsR0FBRyxDQUFDSCxXQUFELEVBQWMsb0JBQWQsRUFBb0MsZ0NBQXBDLENBQTFCOztBQUNBLE1BQU1JLGNBQWMsR0FBRyxDQUFDLEdBQUdILGVBQUosRUFBcUIsR0FBR0MsZUFBeEIsRUFBeUMsR0FBR0MsaUJBQTVDLENBQXZCOzs7QUFFQSxTQUFTRSxnQkFBVCxDQUEwQkMsSUFBMUIsRUFBZ0Q7RUFDbkQsSUFBSUwsZUFBZSxDQUFDTSxRQUFoQixDQUF5QkQsSUFBekIsQ0FBSixFQUFvQztJQUNoQyxPQUFPUixTQUFQO0VBQ0g7O0VBQ0QsSUFBSUksZUFBZSxDQUFDSyxRQUFoQixDQUF5QkQsSUFBekIsQ0FBSixFQUFvQztJQUNoQyxPQUFPUCxTQUFQO0VBQ0g7O0VBQ0QsSUFBSUksaUJB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