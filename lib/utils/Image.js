"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.blobIsAnimated = blobIsAnimated;
exports.mayBeAnimated = mayBeAnimated;

var _arrays = require("./arrays");

/*
 * Copyright 2022 The Matrix.org Foundation C.I.C.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function mayBeAnimated(mimeType) {
  // AVIF animation support at the time of writing is only available in Chrome hence not having `blobIsAnimated` check
  return ["image/gif", "image/webp", "image/png", "image/apng", "image/avif"].includes(mimeType);
}

function arrayBufferRead(arr, start, len) {
  return new Uint8Array(arr.slice(start, start + len));
}

function arrayBufferReadInt(arr, start) {
  const dv = new DataView(arr, start, 4);
  return dv.getUint32(0);
}

function arrayBufferReadStr(arr, start, len) {
  return String.fromCharCode.apply(null, arrayBufferRead(arr, start, len));
}

async function blobIsAnimated(mimeType, blob) {
  switch (mimeType) {
    case "image/webp":
      {
        // Only extended file format WEBP images support animation, so grab the expected data range and verify header.
        // Based on https://developers.google.com/speed/webp/docs/riff_container#extended_file_format
        const arr = await blob.slice(0, 17).arrayBuffer();

        if (arrayBufferReadStr(arr, 0, 4) === "RIFF" && arrayBufferReadStr(arr, 8, 4) === "WEBP" && arrayBufferReadStr(arr, 12, 4) === "VP8X") {
          const [flags] = arrayBufferRead(arr, 16, 1); // Flags: R R I L E X _A_ R (reversed)

          const animationFlagMask = 1 << 1;
          return (flags & animationFlagMask) != 0;
        }

        break;
      }

    case "image/gif":
      {
        // Based on https://gist.github.com/zakirt/faa4a58cec5a7505b10e3686a226f285
        // More info at http://www.matthewflickinger.com/lab/whatsinagif/bits_and_bytes.asp
        const dv = new DataView(await blob.arrayBuffer(), 10);
        const globalColorTable = dv.getUint8(0);
        let globalColorTableSize = 0; // check first bit, if 0, then we don't have a Global Color Table

        if (globalColorTable & 0x80) {
          // grab the last 3 bits, to calculate the global color table size -> RGB * 2^(N+1)
          // N is the value in the last 3 bits.
          globalColorTableSize = 3 * Math.pow(2, (globalColorTable & 0x7) + 1);
        } // move on to the Graphics Control Extension


        const offset = 3 + globalColorTableSize;
        const extensionIntroducer = dv.getUint8(offset);
        const graphicsControlLabel = dv.getUint8(offset + 1);
        let delayTime = 0; // Graphics Control Extension section is where GIF animation data is stored
        // First 2 bytes must be 0x21 and 0xF9

        if (extensionIntroducer & 0x21 && graphicsControlLabel & 0xF9) {
          // skip to the 2 bytes with the delay time
          delayTime = dv.getUint16(offset + 4);
        }

        return !!delayTime;
      }

    case "image/png":
    case "image/apng":
      {
        // Based on https://stackoverflow.com/a/68618296
        const arr = await blob.arrayBuffer();

        if ((0, _arrays.arrayHasDiff)([0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A], Array.from(arrayBufferRead(arr, 0, 8)))) {
          return false;
        }

        for (let i = 8; i < blob.size;) {
          const length = arrayBufferReadInt(arr, i);
          i += 4;
          const type = arrayBufferReadStr(arr, i, 4);
          i += 4;

          switch (type) {
            case "acTL":
              return true;

            case "IDAT":
              return false;
          }

          i += length + 4;
        }

        break;
      }
  }

  return false;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtYXlCZUFuaW1hdGVkIiwibWltZVR5cGUiLCJpbmNsdWRlcyIsImFycmF5QnVmZmVyUmVhZCIsImFyciIsInN0YXJ0IiwibGVuIiwiVWludDhBcnJheSIsInNsaWNlIiwiYXJyYXlCdWZmZXJSZWFkSW50IiwiZHYiLCJEYXRhVmlldyIsImdldFVpbnQzMiIsImFycmF5QnVmZmVyUmVhZFN0ciIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImFwcGx5IiwiYmxvYklzQW5pbWF0ZWQiLCJibG9iIiwiYXJyYXlCdWZmZXIiLCJmbGFncyIsImFuaW1hdGlvbkZsYWdNYXNrIiwiZ2xvYmFsQ29sb3JUYWJsZSIsImdldFVpbnQ4IiwiZ2xvYmFsQ29sb3JUYWJsZVNpemUiLCJNYXRoIiwicG93Iiwib2Zmc2V0IiwiZXh0ZW5zaW9uSW50cm9kdWNlciIsImdyYXBoaWNzQ29udHJvbExhYmVsIiwiZGVsYXlUaW1lIiwiZ2V0VWludDE2IiwiYXJyYXlIYXNEaWZmIiwiQXJyYXkiLCJmcm9tIiwiaSIsInNpemUiLCJsZW5ndGgiLCJ0eXBlIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL3V0aWxzL0ltYWdlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgMjAyMiBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgYXJyYXlIYXNEaWZmIH0gZnJvbSBcIi4vYXJyYXlzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXlCZUFuaW1hdGVkKG1pbWVUeXBlPzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgLy8gQVZJRiBhbmltYXRpb24gc3VwcG9ydCBhdCB0aGUgdGltZSBvZiB3cml0aW5nIGlzIG9ubHkgYXZhaWxhYmxlIGluIENocm9tZSBoZW5jZSBub3QgaGF2aW5nIGBibG9iSXNBbmltYXRlZGAgY2hlY2tcbiAgICByZXR1cm4gW1wiaW1hZ2UvZ2lmXCIsIFwiaW1hZ2Uvd2VicFwiLCBcImltYWdlL3BuZ1wiLCBcImltYWdlL2FwbmdcIiwgXCJpbWFnZS9hdmlmXCJdLmluY2x1ZGVzKG1pbWVUeXBlKTtcbn1cblxuZnVuY3Rpb24gYXJyYXlCdWZmZXJSZWFkKGFycjogQXJyYXlCdWZmZXIsIHN0YXJ0OiBudW1iZXIsIGxlbjogbnVtYmVyKTogVWludDhBcnJheSB7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGFyci5zbGljZShzdGFydCwgc3RhcnQgKyBsZW4pKTtcbn1cblxuZnVuY3Rpb24gYXJyYXlCdWZmZXJSZWFkSW50KGFycjogQXJyYXlCdWZmZXIsIHN0YXJ0OiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IGR2ID0gbmV3IERhdGFWaWV3KGFyciwgc3RhcnQsIDQpO1xuICAgIHJldHVybiBkdi5nZXRVaW50MzIoMCk7XG59XG5cbmZ1bmN0aW9uIGFycmF5QnVmZmVyUmVhZFN0cihhcnI6IEFycmF5QnVmZmVyLCBzdGFydDogbnVtYmVyLCBsZW46IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgYXJyYXlCdWZmZXJSZWFkKGFyciwgc3RhcnQsIGxlbikpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYmxvYklzQW5pbWF0ZWQobWltZVR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZCwgYmxvYjogQmxvYik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHN3aXRjaCAobWltZVR5cGUpIHtcbiAgICAgICAgY2FzZSBcImltYWdlL3dlYnBcIjoge1xuICAgICAgICAgICAgLy8gT25seSBleHRlbmRlZCBmaWxlIGZvcm1hdCBXRUJQIGltYWdlcyBzdXBwb3J0IGFuaW1hdGlvbiwgc28gZ3JhYiB0aGUgZXhwZWN0ZWQgZGF0YSByYW5nZSBhbmQgdmVyaWZ5IGhlYWRlci5cbiAgICAgICAgICAgIC8vIEJhc2VkIG9uIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3NwZWVkL3dlYnAvZG9jcy9yaWZmX2NvbnRhaW5lciNleHRlbmRlZF9maWxlX2Zvcm1hdFxuICAgICAgICAgICAgY29uc3QgYXJyID0gYXdhaXQgYmxvYi5zbGljZSgwLCAxNykuYXJyYXlCdWZmZXIoKTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBhcnJheUJ1ZmZlclJlYWRTdHIoYXJyLCAwLCA0KSA9PT0gXCJSSUZGXCIgJiZcbiAgICAgICAgICAgICAgICBhcnJheUJ1ZmZlclJlYWRTdHIoYXJyLCA4LCA0KSA9PT0gXCJXRUJQXCIgJiZcbiAgICAgICAgICAgICAgICBhcnJheUJ1ZmZlclJlYWRTdHIoYXJyLCAxMiwgNCkgPT09IFwiVlA4WFwiXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBbZmxhZ3NdID0gYXJyYXlCdWZmZXJSZWFkKGFyciwgMTYsIDEpO1xuICAgICAgICAgICAgICAgIC8vIEZsYWdzOiBSIFIgSSBMIEUgWCBfQV8gUiAocmV2ZXJzZWQpXG4gICAgICAgICAgICAgICAgY29uc3QgYW5pbWF0aW9uRmxhZ01hc2sgPSAxIDw8IDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChmbGFncyAmIGFuaW1hdGlvbkZsYWdNYXNrKSAhPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBjYXNlIFwiaW1hZ2UvZ2lmXCI6IHtcbiAgICAgICAgICAgIC8vIEJhc2VkIG9uIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL3pha2lydC9mYWE0YTU4Y2VjNWE3NTA1YjEwZTM2ODZhMjI2ZjI4NVxuICAgICAgICAgICAgLy8gTW9yZSBpbmZvIGF0IGh0dHA6Ly93d3cubWF0dGhld2ZsaWNraW5nZXIuY29tL2xhYi93aGF0c2luYWdpZi9iaXRzX2FuZF9ieXRlcy5hc3BcbiAgICAgICAgICAgIGNvbnN0IGR2ID0gbmV3IERhdGFWaWV3KGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSwgMTApO1xuXG4gICAgICAgICAgICBjb25zdCBnbG9iYWxDb2xvclRhYmxlID0gZHYuZ2V0VWludDgoMCk7XG4gICAgICAgICAgICBsZXQgZ2xvYmFsQ29sb3JUYWJsZVNpemUgPSAwO1xuICAgICAgICAgICAgLy8gY2hlY2sgZmlyc3QgYml0LCBpZiAwLCB0aGVuIHdlIGRvbid0IGhhdmUgYSBHbG9iYWwgQ29sb3IgVGFibGVcbiAgICAgICAgICAgIGlmIChnbG9iYWxDb2xvclRhYmxlICYgMHg4MCkge1xuICAgICAgICAgICAgICAgIC8vIGdyYWIgdGhlIGxhc3QgMyBiaXRzLCB0byBjYWxjdWxhdGUgdGhlIGdsb2JhbCBjb2xvciB0YWJsZSBzaXplIC0+IFJHQiAqIDJeKE4rMSlcbiAgICAgICAgICAgICAgICAvLyBOIGlzIHRoZSB2YWx1ZSBpbiB0aGUgbGFzdCAzIGJpdHMuXG4gICAgICAgICAgICAgICAgZ2xvYmFsQ29sb3JUYWJsZVNpemUgPSAzICogTWF0aC5wb3coMiwgKGdsb2JhbENvbG9yVGFibGUgJiAweDcpICsgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIG1vdmUgb24gdG8gdGhlIEdyYXBoaWNzIENvbnRyb2wgRXh0ZW5zaW9uXG4gICAgICAgICAgICBjb25zdCBvZmZzZXQgPSAzICsgZ2xvYmFsQ29sb3JUYWJsZVNpemU7XG5cbiAgICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbkludHJvZHVjZXIgPSBkdi5nZXRVaW50OChvZmZzZXQpO1xuICAgICAgICAgICAgY29uc3QgZ3JhcGhpY3NDb250cm9sTGFiZWwgPSBkdi5nZXRVaW50OChvZmZzZXQgKyAxKTtcbiAgICAgICAgICAgIGxldCBkZWxheVRpbWUgPSAwO1xuXG4gICAgICAgICAgICAvLyBHcmFwaGljcyBDb250cm9sIEV4dGVuc2lvbiBzZWN0aW9uIGlzIHdoZXJlIEdJRiBhbmltYXRpb24gZGF0YSBpcyBzdG9yZWRcbiAgICAgICAgICAgIC8vIEZpcnN0IDIgYnl0ZXMgbXVzdCBiZSAweDIxIGFuZCAweEY5XG4gICAgICAgICAgICBpZiAoKGV4dGVuc2lvbkludHJvZHVjZXIgJiAweDIxKSAmJiAoZ3JhcGhpY3NDb250cm9sTGFiZWwgJiAweEY5KSkge1xuICAgICAgICAgICAgICAgIC8vIHNraXAgdG8gdGhlIDIgYnl0ZXMgd2l0aCB0aGUgZGVsYXkgdGltZVxuICAgICAgICAgICAgICAgIGRlbGF5VGltZSA9IGR2LmdldFVpbnQxNihvZmZzZXQgKyA0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICEhZGVsYXlUaW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FzZSBcImltYWdlL3BuZ1wiOlxuICAgICAgICBjYXNlIFwiaW1hZ2UvYXBuZ1wiOiB7XG4gICAgICAgICAgICAvLyBCYXNlZCBvbiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNjg2MTgyOTZcbiAgICAgICAgICAgIGNvbnN0IGFyciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTtcbiAgICAgICAgICAgIGlmIChhcnJheUhhc0RpZmYoW1xuICAgICAgICAgICAgICAgIDB4ODksXG4gICAgICAgICAgICAgICAgMHg1MCwgMHg0RSwgMHg0NyxcbiAgICAgICAgICAgICAgICAweDBELCAweDBBLFxuICAgICAgICAgICAgICAgIDB4MUEsXG4gICAgICAgICAgICAgICAgMHgwQSxcbiAgICAgICAgICAgIF0sIEFycmF5LmZyb20oYXJyYXlCdWZmZXJSZWFkKGFyciwgMCwgOCkpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDg7IGkgPCBibG9iLnNpemU7KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVuZ3RoID0gYXJyYXlCdWZmZXJSZWFkSW50KGFyciwgaSk7XG4gICAgICAgICAgICAgICAgaSArPSA0O1xuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBhcnJheUJ1ZmZlclJlYWRTdHIoYXJyLCBpLCA0KTtcbiAgICAgICAgICAgICAgICBpICs9IDQ7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFjVExcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiSURBVFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpICs9IGxlbmd0aCArIDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFn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