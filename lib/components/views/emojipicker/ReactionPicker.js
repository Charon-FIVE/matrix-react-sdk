"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _relations = require("matrix-js-sdk/src/models/relations");

var _event = require("matrix-js-sdk/src/@types/event");

var _EmojiPicker = _interopRequireDefault(require("./EmojiPicker"));

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _actions = require("../../../dispatcher/actions");

var _RoomContext = _interopRequireDefault(require("../../../contexts/RoomContext"));

/*
Copyright 2019 Tulir Asokan <tulir@maunium.net>
Copyright 2020 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class ReactionPicker extends _react.default.Component {
  constructor(props, context) {
    super(props, context);
    (0, _defineProperty2.default)(this, "context", void 0);
    (0, _defineProperty2.default)(this, "onReactionsChange", () => {
      this.setState({
        selectedEmojis: new Set(Object.keys(this.getReactions()))
      });
    });
    (0, _defineProperty2.default)(this, "onChoose", reaction => {
      this.componentWillUnmount();
      this.props.onFinished();
      const myReactions = this.getReactions();

      if (myReactions.hasOwnProperty(reaction)) {
        if (this.props.mxEvent.isRedacted() || !this.context.canSelfRedact) return;

        _MatrixClientPeg.MatrixClientPeg.get().redactEvent(this.props.mxEvent.getRoomId(), myReactions[reaction]);

        _dispatcher.default.dispatch({
          action: _actions.Action.FocusAComposer,
          context: this.context.timelineRenderingType
        }); // Tell the emoji picker not to bump this in the more frequently used list.


        return false;
      } else {
        _MatrixClientPeg.MatrixClientPeg.get().sendEvent(this.props.mxEvent.getRoomId(), _event.EventType.Reaction, {
          "m.relates_to": {
            "rel_type": _event.RelationType.Annotation,
            "event_id": this.props.mxEvent.getId(),
            "key": reaction
          }
        });

        _dispatcher.default.dispatch({
          action: "message_sent"
        });

        _dispatcher.default.dispatch({
          action: _actions.Action.FocusAComposer,
          context: this.context.timelineRenderingType
        });

        return true;
      }
    });
    (0, _defineProperty2.default)(this, "isEmojiDisabled", unicode => {
      if (!this.getReactions()[unicode]) return false;
      if (this.context.canSelfRedact) return false;
      return true;
    });
    this.state = {
      selectedEmojis: new Set(Object.keys(this.getReactions()))
    };
    this.addListeners();
  }

  componentDidUpdate(prevProps) {
    if (prevProps.reactions !== this.props.reactions) {
      this.addListeners();
      this.onReactionsChange();
    }
  }

  addListeners() {
    if (this.props.reactions) {
      this.props.reactions.on(_relations.RelationsEvent.Add, this.onReactionsChange);
      this.props.reactions.on(_relations.RelationsEvent.Remove, this.onReactionsChange);
      this.props.reactions.on(_relations.RelationsEvent.Redaction, this.onReactionsChange);
    }
  }

  componentWillUnmount() {
    if (this.props.reactions) {
      this.props.reactions.removeListener(_relations.RelationsEvent.Add, this.onReactionsChange);
      this.props.reactions.removeListener(_relations.RelationsEvent.Remove, this.onReactionsChange);
      this.props.reactions.removeListener(_relations.RelationsEvent.Redaction, this.onReactionsChange);
    }
  }

  getReactions() {
    if (!this.props.reactions) {
      return {};
    }

    const userId = _MatrixClientPeg.MatrixClientPeg.get().getUserId();

    const myAnnotations = this.props.reactions.getAnnotationsBySender()[userId] || [];
    return Object.fromEntries([...myAnnotations].filter(event => !event.isRedacted()).map(event => [event.getRelation().key, event.getId()]));
  }

  render() {
    return /*#__PURE__*/_react.default.createElement(_EmojiPicker.default, {
      onChoose: this.onChoose,
      isEmojiDisabled: this.isEmojiDisabled,
      selectedEmojis: this.state.selectedEmojis,
      showQuickReactions: true
    });
  }

}

(0, _defineProperty2.default)(ReactionPicker, "contextType", _RoomContext.default);
var _default = ReactionPicker;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZWFjdGlvblBpY2tlciIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsImNvbnRleHQiLCJzZXRTdGF0ZSIsInNlbGVjdGVkRW1vamlzIiwiU2V0IiwiT2JqZWN0Iiwia2V5cyIsImdldFJlYWN0aW9ucyIsInJlYWN0aW9uIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJvbkZpbmlzaGVkIiwibXlSZWFjdGlvbnMiLCJoYXNPd25Qcm9wZXJ0eSIsIm14RXZlbnQiLCJpc1JlZGFjdGVkIiwiY2FuU2VsZlJlZGFjdCIsIk1hdHJpeENsaWVudFBlZyIsImdldCIsInJlZGFjdEV2ZW50IiwiZ2V0Um9vbUlkIiwiZGlzIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJBY3Rpb24iLCJGb2N1c0FDb21wb3NlciIsInRpbWVsaW5lUmVuZGVyaW5nVHlwZSIsInNlbmRFdmVudCIsIkV2ZW50VHlwZSIsIlJlYWN0aW9uIiwiUmVsYXRpb25UeXBlIiwiQW5ub3RhdGlvbiIsImdldElkIiwidW5pY29kZSIsInN0YXRlIiwiYWRkTGlzdGVuZXJzIiwiY29tcG9uZW50RGlkVXBkYXRlIiwicHJldlByb3BzIiwicmVhY3Rpb25zIiwib25SZWFjdGlvbnNDaGFuZ2UiLCJvbiIsIlJlbGF0aW9uc0V2ZW50IiwiQWRkIiwiUmVtb3ZlIiwiUmVkYWN0aW9uIiwicmVtb3ZlTGlzdGVuZXIiLCJ1c2VySWQiLCJnZXRVc2VySWQiLCJteUFubm90YXRpb25zIiwiZ2V0QW5ub3RhdGlvbnNCeVNlbmRlciIsImZyb21FbnRyaWVzIiwiZmlsdGVyIiwiZXZlbnQiLCJtYXAiLCJnZXRSZWxhdGlvbiIsImtleSIsInJlbmRlciIsIm9uQ2hvb3NlIiwiaXNFbW9qaURpc2FibGVkIiwiUm9vbUNvbnRleHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy92aWV3cy9lbW9qaXBpY2tlci9SZWFjdGlvblBpY2tlci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE5IFR1bGlyIEFzb2thbiA8dHVsaXJAbWF1bml1bS5uZXQ+XG5Db3B5cmlnaHQgMjAyMCBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBNYXRyaXhFdmVudCB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9tb2RlbHMvZXZlbnRcIjtcbmltcG9ydCB7IFJlbGF0aW9ucywgUmVsYXRpb25zRXZlbnQgfSBmcm9tICdtYXRyaXgtanMtc2RrL3NyYy9tb2RlbHMvcmVsYXRpb25zJztcbmltcG9ydCB7IEV2ZW50VHlwZSwgUmVsYXRpb25UeXBlIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvQHR5cGVzL2V2ZW50JztcblxuaW1wb3J0IEVtb2ppUGlja2VyIGZyb20gXCIuL0Vtb2ppUGlja2VyXCI7XG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tIFwiLi4vLi4vLi4vTWF0cml4Q2xpZW50UGVnXCI7XG5pbXBvcnQgZGlzIGZyb20gXCIuLi8uLi8uLi9kaXNwYXRjaGVyL2Rpc3BhdGNoZXJcIjtcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gJy4uLy4uLy4uL2Rpc3BhdGNoZXIvYWN0aW9ucyc7XG5pbXBvcnQgUm9vbUNvbnRleHQgZnJvbSBcIi4uLy4uLy4uL2NvbnRleHRzL1Jvb21Db250ZXh0XCI7XG5pbXBvcnQgeyBGb2N1c0NvbXBvc2VyUGF5bG9hZCB9IGZyb20gJy4uLy4uLy4uL2Rpc3BhdGNoZXIvcGF5bG9hZHMvRm9jdXNDb21wb3NlclBheWxvYWQnO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICBteEV2ZW50OiBNYXRyaXhFdmVudDtcbiAgICByZWFjdGlvbnM/OiBSZWxhdGlvbnM7XG4gICAgb25GaW5pc2hlZCgpOiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgSVN0YXRlIHtcbiAgICBzZWxlY3RlZEVtb2ppczogU2V0PHN0cmluZz47XG59XG5cbmNsYXNzIFJlYWN0aW9uUGlja2VyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElQcm9wcywgSVN0YXRlPiB7XG4gICAgc3RhdGljIGNvbnRleHRUeXBlID0gUm9vbUNvbnRleHQ7XG4gICAgcHVibGljIGNvbnRleHQhOiBSZWFjdC5Db250ZXh0VHlwZTx0eXBlb2YgUm9vbUNvbnRleHQ+O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHM6IElQcm9wcywgY29udGV4dDogUmVhY3QuQ29udGV4dFR5cGU8dHlwZW9mIFJvb21Db250ZXh0Pikge1xuICAgICAgICBzdXBlcihwcm9wcywgY29udGV4dCk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHNlbGVjdGVkRW1vamlzOiBuZXcgU2V0KE9iamVjdC5rZXlzKHRoaXMuZ2V0UmVhY3Rpb25zKCkpKSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5hZGRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XG4gICAgICAgIGlmIChwcmV2UHJvcHMucmVhY3Rpb25zICE9PSB0aGlzLnByb3BzLnJlYWN0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5hZGRMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHRoaXMub25SZWFjdGlvbnNDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYWRkTGlzdGVuZXJzKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5yZWFjdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMucmVhY3Rpb25zLm9uKFJlbGF0aW9uc0V2ZW50LkFkZCwgdGhpcy5vblJlYWN0aW9uc0NoYW5nZSk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLnJlYWN0aW9ucy5vbihSZWxhdGlvbnNFdmVudC5SZW1vdmUsIHRoaXMub25SZWFjdGlvbnNDaGFuZ2UpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5yZWFjdGlvbnMub24oUmVsYXRpb25zRXZlbnQuUmVkYWN0aW9uLCB0aGlzLm9uUmVhY3Rpb25zQ2hhbmdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5yZWFjdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMucmVhY3Rpb25zLnJlbW92ZUxpc3RlbmVyKFJlbGF0aW9uc0V2ZW50LkFkZCwgdGhpcy5vblJlYWN0aW9uc0NoYW5nZSk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLnJlYWN0aW9ucy5yZW1vdmVMaXN0ZW5lcihSZWxhdGlvbnNFdmVudC5SZW1vdmUsIHRoaXMub25SZWFjdGlvbnNDaGFuZ2UpO1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5yZWFjdGlvbnMucmVtb3ZlTGlzdGVuZXIoUmVsYXRpb25zRXZlbnQuUmVkYWN0aW9uLCB0aGlzLm9uUmVhY3Rpb25zQ2hhbmdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0UmVhY3Rpb25zKCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgICAgICBpZiAoIXRoaXMucHJvcHMucmVhY3Rpb25zKSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXNlcklkID0gTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFVzZXJJZCgpO1xuICAgICAgICBjb25zdCBteUFubm90YXRpb25zID0gdGhpcy5wcm9wcy5yZWFjdGlvbnMuZ2V0QW5ub3RhdGlvbnNCeVNlbmRlcigpW3VzZXJJZF0gfHwgW107XG4gICAgICAgIHJldHVybiBPYmplY3QuZnJvbUVudHJpZXMoWy4uLm15QW5ub3RhdGlvbnNdXG4gICAgICAgICAgICAuZmlsdGVyKGV2ZW50ID0+ICFldmVudC5pc1JlZGFjdGVkKCkpXG4gICAgICAgICAgICAubWFwKGV2ZW50ID0+IFtldmVudC5nZXRSZWxhdGlvbigpLmtleSwgZXZlbnQuZ2V0SWQoKV0pKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uUmVhY3Rpb25zQ2hhbmdlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNlbGVjdGVkRW1vamlzOiBuZXcgU2V0KE9iamVjdC5rZXlzKHRoaXMuZ2V0UmVhY3Rpb25zKCkpKSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25DaG9vc2UgPSAocmVhY3Rpb246IHN0cmluZykgPT4ge1xuICAgICAgICB0aGlzLmNvbXBvbmVudFdpbGxVbm1vdW50KCk7XG4gICAgICAgIHRoaXMucHJvcHMub25GaW5pc2hlZCgpO1xuICAgICAgICBjb25zdCBteVJlYWN0aW9ucyA9IHRoaXMuZ2V0UmVhY3Rpb25zKCk7XG4gICAgICAgIGlmIChteVJlYWN0aW9ucy5oYXNPd25Qcm9wZXJ0eShyZWFjdGlvbikpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLm14RXZlbnQuaXNSZWRhY3RlZCgpIHx8ICF0aGlzLmNvbnRleHQuY2FuU2VsZlJlZGFjdCkgcmV0dXJuO1xuXG4gICAgICAgICAgICBNYXRyaXhDbGllbnRQZWcuZ2V0KCkucmVkYWN0RXZlbnQodGhpcy5wcm9wcy5teEV2ZW50LmdldFJvb21JZCgpLCBteVJlYWN0aW9uc1tyZWFjdGlvbl0pO1xuICAgICAgICAgICAgZGlzLmRpc3BhdGNoPEZvY3VzQ29tcG9zZXJQYXlsb2FkPih7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiBBY3Rpb24uRm9jdXNBQ29tcG9zZXIsXG4gICAgICAgICAgICAgICAgY29udGV4dDogdGhpcy5jb250ZXh0LnRpbWVsaW5lUmVuZGVyaW5nVHlwZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gVGVsbCB0aGUgZW1vamkgcGlja2VyIG5vdCB0byBidW1wIHRoaXMgaW4gdGhlIG1vcmUgZnJlcXVlbnRseSB1c2VkIGxpc3QuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBNYXRyaXhDbGllbnRQZWcuZ2V0KCkuc2VuZEV2ZW50KHRoaXMucHJvcHMubXhFdmVudC5nZXRSb29tSWQoKSwgRXZlbnRUeXBlLlJlYWN0aW9uLCB7XG4gICAgICAgICAgICAgICAgXCJtLnJlbGF0ZXNfdG9cIjoge1xuICAgICAgICAgICAgICAgICAgICBcInJlbF90eXBlXCI6IFJlbGF0aW9uVHlwZS5Bbm5vdGF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBcImV2ZW50X2lkXCI6IHRoaXMucHJvcHMubXhFdmVudC5nZXRJZCgpLFxuICAgICAgICAgICAgICAgICAgICBcImtleVwiOiByZWFjdGlvbixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkaXMuZGlzcGF0Y2goeyBhY3Rpb246IFwibWVzc2FnZV9zZW50XCIgfSk7XG4gICAgICAgICAgICBkaXMuZGlzcGF0Y2g8Rm9jdXNDb21wb3NlclBheWxvYWQ+KHtcbiAgICAgICAgICAgICAgICBhY3Rpb246IEFjdGlvbi5Gb2N1c0FDb21wb3NlcixcbiAgICAgICAgICAgICAgICBjb250ZXh0OiB0aGlzLmNvbnRleHQudGltZWxpbmVSZW5kZXJpbmdUeXBlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIGlzRW1vamlEaXNhYmxlZCA9ICh1bmljb2RlOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmdldFJlYWN0aW9ucygpW3VuaWNvZGVdKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLmNvbnRleHQuY2FuU2VsZlJlZGFjdCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiA8RW1vamlQaWNrZXJcbiAgICAgICAgICAgIG9uQ2hvb3NlPXt0aGlzLm9uQ2hvb3NlfVxuICAgICAgICAgICAgaXNFbW9qaURpc2FibGVkPXt0aGlzLmlzRW1vamlEaXNhYmxlZH1cbiAgICAgICAgICAgIHNlbGVjdGVkRW1vamlzPXt0aGlzLnN0YXRlLnNlbGVjdGVkRW1vamlzfVxuICAgICAgICAgICAgc2hvd1F1aWNrUmVhY3Rpb25zPXt0cnVlfVxuICAgICAgICAvPjtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlYWN0aW9uUGlja2VyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWlCQTs7QUFFQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUExQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF3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