"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _SAS = require("matrix-js-sdk/src/crypto/verification/SAS");

var _Base = require("matrix-js-sdk/src/crypto/verification/Base");

var _logger = require("matrix-js-sdk/src/logger");

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _languageHandler = require("../../../languageHandler");

var _Media = require("../../../customisations/Media");

var _VerificationComplete = _interopRequireDefault(require("../verification/VerificationComplete"));

var _VerificationCancelled = _interopRequireDefault(require("../verification/VerificationCancelled"));

var _BaseAvatar = _interopRequireDefault(require("../avatars/BaseAvatar"));

var _Spinner = _interopRequireDefault(require("../elements/Spinner"));

var _VerificationShowSas = _interopRequireDefault(require("../verification/VerificationShowSas"));

var _BaseDialog = _interopRequireDefault(require("./BaseDialog"));

var _DialogButtons = _interopRequireDefault(require("../elements/DialogButtons"));

/*
Copyright 2019 New Vector Ltd

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const PHASE_START = 0;
const PHASE_SHOW_SAS = 1;
const PHASE_WAIT_FOR_PARTNER_TO_CONFIRM = 2;
const PHASE_VERIFIED = 3;
const PHASE_CANCELLED = 4;

class IncomingSasDialog extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "showSasEvent", void 0);
    (0, _defineProperty2.default)(this, "onFinished", () => {
      this.props.onFinished(this.state.phase === PHASE_VERIFIED);
    });
    (0, _defineProperty2.default)(this, "onCancelClick", () => {
      this.props.onFinished(this.state.phase === PHASE_VERIFIED);
    });
    (0, _defineProperty2.default)(this, "onContinueClick", () => {
      this.setState({
        phase: PHASE_WAIT_FOR_PARTNER_TO_CONFIRM
      });
      this.props.verifier.verify().then(() => {
        this.setState({
          phase: PHASE_VERIFIED
        });
      }).catch(e => {
        _logger.logger.log("Verification failed", e);
      });
    });
    (0, _defineProperty2.default)(this, "onVerifierShowSas", e => {
      this.showSasEvent = e;
      this.setState({
        phase: PHASE_SHOW_SAS,
        sas: e.sas
      });
    });
    (0, _defineProperty2.default)(this, "onVerifierCancel", () => {
      this.setState({
        phase: PHASE_CANCELLED
      });
    });
    (0, _defineProperty2.default)(this, "onSasMatchesClick", () => {
      this.showSasEvent.confirm();
      this.setState({
        phase: PHASE_WAIT_FOR_PARTNER_TO_CONFIRM
      });
    });
    (0, _defineProperty2.default)(this, "onVerifiedDoneClick", () => {
      this.props.onFinished(true);
    });
    let phase = PHASE_START;

    if (this.props.verifier.hasBeenCancelled) {
      _logger.logger.log("Verifier was cancelled in the background.");

      phase = PHASE_CANCELLED;
    }

    this.showSasEvent = null;
    this.state = {
      phase: phase,
      sasVerified: false,
      opponentProfile: null,
      opponentProfileError: null,
      sas: null
    };
    this.props.verifier.on(_SAS.SasEvent.ShowSas, this.onVerifierShowSas);
    this.props.verifier.on(_Base.VerificationEvent.Cancel, this.onVerifierCancel);
    this.fetchOpponentProfile();
  }

  componentWillUnmount() {
    if (this.state.phase !== PHASE_CANCELLED && this.state.phase !== PHASE_VERIFIED) {
      this.props.verifier.cancel(new Error('User cancel'));
    }

    this.props.verifier.removeListener(_SAS.SasEvent.ShowSas, this.onVerifierShowSas);
  }

  async fetchOpponentProfile() {
    try {
      const prof = await _MatrixClientPeg.MatrixClientPeg.get().getProfileInfo(this.props.verifier.userId);
      this.setState({
        opponentProfile: prof
      });
    } catch (e) {
      this.setState({
        opponentProfileError: e
      });
    }
  }

  renderPhaseStart() {
    const isSelf = this.props.verifier.userId === _MatrixClientPeg.MatrixClientPeg.get().getUserId();

    let profile;
    const oppProfile = this.state.opponentProfile;

    if (oppProfile) {
      const url = oppProfile.avatar_url ? (0, _Media.mediaFromMxc)(oppProfile.avatar_url).getSquareThumbnailHttp(48) : null;
      profile = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_IncomingSasDialog_opponentProfile"
      }, /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
        name: oppProfile.displayname,
        idName: this.props.verifier.userId,
        url: url,
        width: 48,
        height: 48,
        resizeMethod: "crop"
      }), /*#__PURE__*/_react.default.createElement("h2", null, oppProfile.displayname));
    } else if (this.state.opponentProfileError) {
      profile = /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
        name: this.props.verifier.userId.slice(1),
        idName: this.props.verifier.userId,
        width: 48,
        height: 48
      }), /*#__PURE__*/_react.default.createElement("h2", null, this.props.verifier.userId));
    } else {
      profile = /*#__PURE__*/_react.default.createElement(_Spinner.default, null);
    }

    const userDetailText = [/*#__PURE__*/_react.default.createElement("p", {
      key: "p1"
    }, (0, _languageHandler._t)("Verify this user to mark them as trusted. " + "Trusting users gives you extra peace of mind when using " + "end-to-end encrypted messages.")), /*#__PURE__*/_react.default.createElement("p", {
      key: "p2"
    }, (0, _languageHandler._t)( // NB. Below wording adjusted to singular 'session' until we have
    // cross-signing
    "Verifying this user will mark their session as trusted, and " + "also mark your session as trusted to them."))];
    const selfDetailText = [/*#__PURE__*/_react.default.createElement("p", {
      key: "p1"
    }, (0, _languageHandler._t)("Verify this device to mark it as trusted. " + "Trusting this device gives you and other users extra peace of mind when using " + "end-to-end encrypted messages.")), /*#__PURE__*/_react.default.createElement("p", {
      key: "p2"
    }, (0, _languageHandler._t)("Verifying this device will mark it as trusted, and users who have verified with " + "you will trust this device."))];
    return /*#__PURE__*/_react.default.createElement("div", null, profile, isSelf ? selfDetailText : userDetailText, /*#__PURE__*/_react.default.createElement(_DialogButtons.default, {
      primaryButton: (0, _languageHandler._t)('Continue'),
      hasCancel: true,
      onPrimaryButtonClick: this.onContinueClick,
      onCancel: this.onCancelClick
    }));
  }

  renderPhaseShowSas() {
    return /*#__PURE__*/_react.default.createElement(_VerificationShowSas.default, {
      sas: this.showSasEvent.sas,
      onCancel: this.onCancelClick,
      onDone: this.onSasMatchesClick,
      isSelf: this.props.verifier.userId === _MatrixClientPeg.MatrixClientPeg.get().getUserId(),
      inDialog: true
    });
  }

  renderPhaseWaitForPartnerToConfirm() {
    return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement(_Spinner.default, null), /*#__PURE__*/_react.default.createElement("p", null, (0, _languageHandler._t)("Waiting for partner to confirm...")));
  }

  renderPhaseVerified() {
    return /*#__PURE__*/_react.default.createElement(_VerificationComplete.default, {
      onDone: this.onVerifiedDoneClick
    });
  }

  renderPhaseCancelled() {
    return /*#__PURE__*/_react.default.createElement(_VerificationCancelled.default, {
      onDone: this.onCancelClick
    });
  }

  render() {
    let body;

    switch (this.state.phase) {
      case PHASE_START:
        body = this.renderPhaseStart();
        break;

      case PHASE_SHOW_SAS:
        body = this.renderPhaseShowSas();
        break;

      case PHASE_WAIT_FOR_PARTNER_TO_CONFIRM:
        body = this.renderPhaseWaitForPartnerToConfirm();
        break;

      case PHASE_VERIFIED:
        body = this.renderPhaseVerified();
        break;

      case PHASE_CANCELLED:
        body = this.renderPhaseCancelled();
        break;
    }

    return /*#__PURE__*/_react.default.createElement(_BaseDialog.default, {
      title: (0, _languageHandler._t)("Incoming Verification Request"),
      onFinished: this.onFinished,
      fixedWidth: false
    }, body);
  }

}

exports.default = IncomingSasDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQSEFTRV9TVEFSVCIsIlBIQVNFX1NIT1dfU0FTIiwiUEhBU0VfV0FJVF9GT1JfUEFSVE5FUl9UT19DT05GSVJNIiwiUEhBU0VfVkVSSUZJRUQiLCJQSEFTRV9DQU5DRUxMRUQiLCJJbmNvbWluZ1Nhc0RpYWxvZyIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsIm9uRmluaXNoZWQiLCJzdGF0ZSIsInBoYXNlIiwic2V0U3RhdGUiLCJ2ZXJpZmllciIsInZlcmlmeSIsInRoZW4iLCJjYXRjaCIsImUiLCJsb2dnZXIiLCJsb2ciLCJzaG93U2FzRXZlbnQiLCJzYXMiLCJjb25maXJtIiwiaGFzQmVlbkNhbmNlbGxlZCIsInNhc1ZlcmlmaWVkIiwib3Bwb25lbnRQcm9maWxlIiwib3Bwb25lbnRQcm9maWxlRXJyb3IiLCJvbiIsIlNhc0V2ZW50IiwiU2hvd1NhcyIsIm9uVmVyaWZpZXJTaG93U2FzIiwiVmVyaWZpY2F0aW9uRXZlbnQiLCJDYW5jZWwiLCJvblZlcmlmaWVyQ2FuY2VsIiwiZmV0Y2hPcHBvbmVudFByb2ZpbGUiLCJjb21wb25lbnRXaWxsVW5tb3VudCIsImNhbmNlbCIsIkVycm9yIiwicmVtb3ZlTGlzdGVuZXIiLCJwcm9mIiwiTWF0cml4Q2xpZW50UGVnIiwiZ2V0IiwiZ2V0UHJvZmlsZUluZm8iLCJ1c2VySWQiLCJyZW5kZXJQaGFzZVN0YXJ0IiwiaXNTZWxmIiwiZ2V0VXNlcklkIiwicHJvZmlsZSIsIm9wcFByb2ZpbGUiLCJ1cmwiLCJhdmF0YXJfdXJsIiwibWVkaWFGcm9tTXhjIiwiZ2V0U3F1YXJlVGh1bWJuYWlsSHR0cCIsImRpc3BsYXluYW1lIiwic2xpY2UiLCJ1c2VyRGV0YWlsVGV4dCIsIl90Iiwic2VsZkRldGFpbFRleHQiLCJvbkNvbnRpbnVlQ2xpY2siLCJvbkNhbmNlbENsaWNrIiwicmVuZGVyUGhhc2VTaG93U2FzIiwib25TYXNNYXRjaGVzQ2xpY2siLCJyZW5kZXJQaGFzZVdhaXRGb3JQYXJ0bmVyVG9Db25maXJtIiwicmVuZGVyUGhhc2VWZXJpZmllZCIsIm9uVmVyaWZpZWREb25lQ2xpY2siLCJyZW5kZXJQaGFzZUNhbmNlbGxlZCIsInJlbmRlciIsImJvZHkiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy92aWV3cy9kaWFsb2dzL0luY29taW5nU2FzRGlhbG9nLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTkgTmV3IFZlY3RvciBMdGRcblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgSUdlbmVyYXRlZFNhcywgSVNhc0V2ZW50LCBTYXNFdmVudCB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9jcnlwdG8vdmVyaWZpY2F0aW9uL1NBU1wiO1xuaW1wb3J0IHsgVmVyaWZpY2F0aW9uQmFzZSwgVmVyaWZpY2F0aW9uRXZlbnQgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvY3J5cHRvL3ZlcmlmaWNhdGlvbi9CYXNlXCI7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbG9nZ2VyXCI7XG5cbmltcG9ydCB7IE1hdHJpeENsaWVudFBlZyB9IGZyb20gJy4uLy4uLy4uL01hdHJpeENsaWVudFBlZyc7XG5pbXBvcnQgeyBfdCB9IGZyb20gJy4uLy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgeyBtZWRpYUZyb21NeGMgfSBmcm9tIFwiLi4vLi4vLi4vY3VzdG9taXNhdGlvbnMvTWVkaWFcIjtcbmltcG9ydCBWZXJpZmljYXRpb25Db21wbGV0ZSBmcm9tIFwiLi4vdmVyaWZpY2F0aW9uL1ZlcmlmaWNhdGlvbkNvbXBsZXRlXCI7XG5pbXBvcnQgVmVyaWZpY2F0aW9uQ2FuY2VsbGVkIGZyb20gXCIuLi92ZXJpZmljYXRpb24vVmVyaWZpY2F0aW9uQ2FuY2VsbGVkXCI7XG5pbXBvcnQgQmFzZUF2YXRhciBmcm9tIFwiLi4vYXZhdGFycy9CYXNlQXZhdGFyXCI7XG5pbXBvcnQgU3Bpbm5lciBmcm9tIFwiLi4vZWxlbWVudHMvU3Bpbm5lclwiO1xuaW1wb3J0IFZlcmlmaWNhdGlvblNob3dTYXMgZnJvbSBcIi4uL3ZlcmlmaWNhdGlvbi9WZXJpZmljYXRpb25TaG93U2FzXCI7XG5pbXBvcnQgQmFzZURpYWxvZyBmcm9tIFwiLi9CYXNlRGlhbG9nXCI7XG5pbXBvcnQgRGlhbG9nQnV0dG9ucyBmcm9tIFwiLi4vZWxlbWVudHMvRGlhbG9nQnV0dG9uc1wiO1xuaW1wb3J0IHsgSURpYWxvZ1Byb3BzIH0gZnJvbSBcIi4vSURpYWxvZ1Byb3BzXCI7XG5cbmNvbnN0IFBIQVNFX1NUQVJUID0gMDtcbmNvbnN0IFBIQVNFX1NIT1dfU0FTID0gMTtcbmNvbnN0IFBIQVNFX1dBSVRfRk9SX1BBUlRORVJfVE9fQ09ORklSTSA9IDI7XG5jb25zdCBQSEFTRV9WRVJJRklFRCA9IDM7XG5jb25zdCBQSEFTRV9DQU5DRUxMRUQgPSA0O1xuXG5pbnRlcmZhY2UgSVByb3BzIGV4dGVuZHMgSURpYWxvZ1Byb3BzIHtcbiAgICB2ZXJpZmllcjogVmVyaWZpY2F0aW9uQmFzZTxTYXNFdmVudCwgYW55Pjtcbn1cblxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgcGhhc2U6IG51bWJlcjtcbiAgICBzYXNWZXJpZmllZDogYm9vbGVhbjtcbiAgICBvcHBvbmVudFByb2ZpbGU6IHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICAgICAgICBhdmF0YXJfdXJsPzogc3RyaW5nO1xuICAgICAgICBkaXNwbGF5bmFtZT86IHN0cmluZztcbiAgICB9O1xuICAgIG9wcG9uZW50UHJvZmlsZUVycm9yOiBFcnJvcjtcbiAgICBzYXM6IElHZW5lcmF0ZWRTYXM7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEluY29taW5nU2FzRGlhbG9nIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PElQcm9wcywgSVN0YXRlPiB7XG4gICAgcHJpdmF0ZSBzaG93U2FzRXZlbnQ6IElTYXNFdmVudDtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIGxldCBwaGFzZSA9IFBIQVNFX1NUQVJUO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy52ZXJpZmllci5oYXNCZWVuQ2FuY2VsbGVkKSB7XG4gICAgICAgICAgICBsb2dnZXIubG9nKFwiVmVyaWZpZXIgd2FzIGNhbmNlbGxlZCBpbiB0aGUgYmFja2dyb3VuZC5cIik7XG4gICAgICAgICAgICBwaGFzZSA9IFBIQVNFX0NBTkNFTExFRDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2hvd1Nhc0V2ZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHBoYXNlOiBwaGFzZSxcbiAgICAgICAgICAgIHNhc1ZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICAgIG9wcG9uZW50UHJvZmlsZTogbnVsbCxcbiAgICAgICAgICAgIG9wcG9uZW50UHJvZmlsZUVycm9yOiBudWxsLFxuICAgICAgICAgICAgc2FzOiBudWxsLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnByb3BzLnZlcmlmaWVyLm9uKFNhc0V2ZW50LlNob3dTYXMsIHRoaXMub25WZXJpZmllclNob3dTYXMpO1xuICAgICAgICB0aGlzLnByb3BzLnZlcmlmaWVyLm9uKFZlcmlmaWNhdGlvbkV2ZW50LkNhbmNlbCwgdGhpcy5vblZlcmlmaWVyQ2FuY2VsKTtcbiAgICAgICAgdGhpcy5mZXRjaE9wcG9uZW50UHJvZmlsZSgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjb21wb25lbnRXaWxsVW5tb3VudCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUucGhhc2UgIT09IFBIQVNFX0NBTkNFTExFRCAmJiB0aGlzLnN0YXRlLnBoYXNlICE9PSBQSEFTRV9WRVJJRklFRCkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy52ZXJpZmllci5jYW5jZWwobmV3IEVycm9yKCdVc2VyIGNhbmNlbCcpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3BzLnZlcmlmaWVyLnJlbW92ZUxpc3RlbmVyKFNhc0V2ZW50LlNob3dTYXMsIHRoaXMub25WZXJpZmllclNob3dTYXMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZmV0Y2hPcHBvbmVudFByb2ZpbGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwcm9mID0gYXdhaXQgTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFByb2ZpbGVJbmZvKFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMudmVyaWZpZXIudXNlcklkLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIG9wcG9uZW50UHJvZmlsZTogcHJvZixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBvcHBvbmVudFByb2ZpbGVFcnJvcjogZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkZpbmlzaGVkID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnByb3BzLm9uRmluaXNoZWQodGhpcy5zdGF0ZS5waGFzZSA9PT0gUEhBU0VfVkVSSUZJRUQpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uQ2FuY2VsQ2xpY2sgPSAoKTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMucHJvcHMub25GaW5pc2hlZCh0aGlzLnN0YXRlLnBoYXNlID09PSBQSEFTRV9WRVJJRklFRCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Db250aW51ZUNsaWNrID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgcGhhc2U6IFBIQVNFX1dBSVRfRk9SX1BBUlRORVJfVE9fQ09ORklSTSB9KTtcbiAgICAgICAgdGhpcy5wcm9wcy52ZXJpZmllci52ZXJpZnkoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBwaGFzZTogUEhBU0VfVkVSSUZJRUQgfSk7XG4gICAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICBsb2dnZXIubG9nKFwiVmVyaWZpY2F0aW9uIGZhaWxlZFwiLCBlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25WZXJpZmllclNob3dTYXMgPSAoZTogSVNhc0V2ZW50KTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMuc2hvd1Nhc0V2ZW50ID0gZTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBwaGFzZTogUEhBU0VfU0hPV19TQVMsXG4gICAgICAgICAgICBzYXM6IGUuc2FzLFxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvblZlcmlmaWVyQ2FuY2VsID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHBoYXNlOiBQSEFTRV9DQU5DRUxMRUQsXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uU2FzTWF0Y2hlc0NsaWNrID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNob3dTYXNFdmVudC5jb25maXJtKCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgcGhhc2U6IFBIQVNFX1dBSVRfRk9SX1BBUlRORVJfVE9fQ09ORklSTSxcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25WZXJpZmllZERvbmVDbGljayA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgdGhpcy5wcm9wcy5vbkZpbmlzaGVkKHRydWUpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIHJlbmRlclBoYXNlU3RhcnQoKTogSlNYLkVsZW1lbnQge1xuICAgICAgICBjb25zdCBpc1NlbGYgPSB0aGlzLnByb3BzLnZlcmlmaWVyLnVzZXJJZCA9PT0gTWF0cml4Q2xpZW50UGVnLmdldCgpLmdldFVzZXJJZCgpO1xuXG4gICAgICAgIGxldCBwcm9maWxlO1xuICAgICAgICBjb25zdCBvcHBQcm9maWxlID0gdGhpcy5zdGF0ZS5vcHBvbmVudFByb2ZpbGU7XG4gICAgICAgIGlmIChvcHBQcm9maWxlKSB7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBvcHBQcm9maWxlLmF2YXRhcl91cmxcbiAgICAgICAgICAgICAgICA/IG1lZGlhRnJvbU14YyhvcHBQcm9maWxlLmF2YXRhcl91cmwpLmdldFNxdWFyZVRodW1ibmFpbEh0dHAoNDgpXG4gICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgcHJvZmlsZSA9IDxkaXYgY2xhc3NOYW1lPVwibXhfSW5jb21pbmdTYXNEaWFsb2dfb3Bwb25lbnRQcm9maWxlXCI+XG4gICAgICAgICAgICAgICAgPEJhc2VBdmF0YXJcbiAgICAgICAgICAgICAgICAgICAgbmFtZT17b3BwUHJvZmlsZS5kaXNwbGF5bmFtZX1cbiAgICAgICAgICAgICAgICAgICAgaWROYW1lPXt0aGlzLnByb3BzLnZlcmlmaWVyLnVzZXJJZH1cbiAgICAgICAgICAgICAgICAgICAgdXJsPXt1cmx9XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoPXs0OH1cbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXs0OH1cbiAgICAgICAgICAgICAgICAgICAgcmVzaXplTWV0aG9kPSdjcm9wJ1xuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPGgyPnsgb3BwUHJvZmlsZS5kaXNwbGF5bmFtZSB9PC9oMj5cbiAgICAgICAgICAgIDwvZGl2PjtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXRlLm9wcG9uZW50UHJvZmlsZUVycm9yKSB7XG4gICAgICAgICAgICBwcm9maWxlID0gPGRpdj5cbiAgICAgICAgICAgICAgICA8QmFzZUF2YXRhclxuICAgICAgICAgICAgICAgICAgICBuYW1lPXt0aGlzLnByb3BzLnZlcmlmaWVyLnVzZXJJZC5zbGljZSgxKX1cbiAgICAgICAgICAgICAgICAgICAgaWROYW1lPXt0aGlzLnByb3BzLnZlcmlmaWVyLnVzZXJJZH1cbiAgICAgICAgICAgICAgICAgICAgd2lkdGg9ezQ4fVxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9ezQ4fVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPGgyPnsgdGhpcy5wcm9wcy52ZXJpZmllci51c2VySWQgfTwvaDI+XG4gICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9maWxlID0gPFNwaW5uZXIgLz47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1c2VyRGV0YWlsVGV4dCA9IFtcbiAgICAgICAgICAgIDxwIGtleT1cInAxXCI+eyBfdChcbiAgICAgICAgICAgICAgICBcIlZlcmlmeSB0aGlzIHVzZXIgdG8gbWFyayB0aGVtIGFzIHRydXN0ZWQuIFwiICtcbiAgICAgICAgICAgICAgICBcIlRydXN0aW5nIHVzZXJzIGdpdmVzIHlvdSBleHRyYSBwZWFjZSBvZiBtaW5kIHdoZW4gdXNpbmcgXCIgK1xuICAgICAgICAgICAgICAgIFwiZW5kLXRvLWVuZCBlbmNyeXB0ZWQgbWVzc2FnZXMuXCIsXG4gICAgICAgICAgICApIH08L3A+LFxuICAgICAgICAgICAgPHAga2V5PVwicDJcIj57IF90KFxuICAgICAgICAgICAgICAgIC8vIE5CLiBCZWxvdyB3b3JkaW5nIGFkanVzdGVkIHRvIHNpbmd1bGFyICdzZXNzaW9uJyB1bnRpbCB3ZSBoYXZlXG4gICAgICAgICAgICAgICAgLy8gY3Jvc3Mtc2lnbmluZ1xuICAgICAgICAgICAgICAgIFwiVmVyaWZ5aW5nIHRoaXMgdXNlciB3aWxsIG1hcmsgdGhlaXIgc2Vzc2lvbiBhcyB0cnVzdGVkLCBhbmQgXCIgK1xuICAgICAgICAgICAgICAgIFwiYWxzbyBtYXJrIHlvdXIgc2Vzc2lvbiBhcyB0cnVzdGVkIHRvIHRoZW0uXCIsXG4gICAgICAgICAgICApIH08L3A+LFxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnN0IHNlbGZEZXRhaWxUZXh0ID0gW1xuICAgICAgICAgICAgPHAga2V5PVwicDFcIj57IF90KFxuICAgICAgICAgICAgICAgIFwiVmVyaWZ5IHRoaXMgZGV2aWNlIHRvIG1hcmsgaXQgYXMgdHJ1c3RlZC4gXCIgK1xuICAgICAgICAgICAgICAgIFwiVHJ1c3RpbmcgdGhpcyBkZXZpY2UgZ2l2ZXMgeW91IGFuZCBvdGhlciB1c2VycyBleHRyYSBwZWFjZSBvZiBtaW5kIHdoZW4gdXNpbmcgXCIgK1xuICAgICAgICAgICAgICAgIFwiZW5kLXRvLWVuZCBlbmNyeXB0ZWQgbWVzc2FnZXMuXCIsXG4gICAgICAgICAgICApIH08L3A+LFxuICAgICAgICAgICAgPHAga2V5PVwicDJcIj57IF90KFxuICAgICAgICAgICAgICAgIFwiVmVyaWZ5aW5nIHRoaXMgZGV2aWNlIHdpbGwgbWFyayBpdCBhcyB0cnVzdGVkLCBhbmQgdXNlcnMgd2hvIGhhdmUgdmVyaWZpZWQgd2l0aCBcIiArXG4gICAgICAgICAgICAgICAgXCJ5b3Ugd2lsbCB0cnVzdCB0aGlzIGRldmljZS5cIixcbiAgICAgICAgICAgICkgfTwvcD4sXG4gICAgICAgIF07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgeyBwcm9maWxlIH1cbiAgICAgICAgICAgICAgICB7IGlzU2VsZiA/IHNlbGZEZXRhaWxUZXh0IDogdXNlckRldGFpbFRleHQgfVxuICAgICAgICAgICAgICAgIDxEaWFsb2dCdXR0b25zXG4gICAgICAgICAgICAgICAgICAgIHByaW1hcnlCdXR0b249e190KCdDb250aW51ZScpfVxuICAgICAgICAgICAgICAgICAgICBoYXNDYW5jZWw9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgIG9uUHJpbWFyeUJ1dHRvbkNsaWNrPXt0aGlzLm9uQ29udGludWVDbGlja31cbiAgICAgICAgICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMub25DYW5jZWxDbGlja31cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJQaGFzZVNob3dTYXMoKTogSlNYLkVsZW1lbnQge1xuICAgICAgICByZXR1cm4gPFZlcmlmaWNhdGlvblNob3dTYXNcbiAgICAgICAgICAgIHNhcz17dGhpcy5zaG93U2FzRXZlbnQuc2FzfVxuICAgICAgICAgICAgb25DYW5jZWw9e3RoaXMub25DYW5jZWxDbGlja31cbiAgICAgICAgICAgIG9uRG9uZT17dGhpcy5vblNhc01hdGNoZXNDbGlja31cbiAgICAgICAgICAgIGlzU2VsZj17dGhpcy5wcm9wcy52ZXJpZmllci51c2VySWQgPT09IE1hdHJpeENsaWVudFBlZy5nZXQoKS5nZXRVc2VySWQoKX1cbiAgICAgICAgICAgIGluRGlhbG9nPXt0cnVlfVxuICAgICAgICAvPjtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlclBoYXNlV2FpdEZvclBhcnRuZXJUb0NvbmZpcm0oKTogSlNYLkVsZW1lbnQge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8U3Bpbm5lciAvPlxuICAgICAgICAgICAgICAgIDxwPnsgX3QoXCJXYWl0aW5nIGZvciBwYXJ0bmVyIHRvIGNvbmZpcm0uLi5cIikgfTwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyUGhhc2VWZXJpZmllZCgpOiBKU1guRWxlbWVudCB7XG4gICAgICAgIHJldHVybiA8VmVyaWZpY2F0aW9uQ29tcGxldGUgb25Eb25lPXt0aGlzLm9uVmVyaWZpZWREb25lQ2xpY2t9IC8+O1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyUGhhc2VDYW5jZWxsZWQoKTogSlNYLkVsZW1lbnQge1xuICAgICAgICByZXR1cm4gPFZlcmlmaWNhdGlvbkNhbmNlbGxlZCBvbkRvbmU9e3RoaXMub25DYW5jZWxDbGlja30gLz47XG4gICAgfVxuXG4gICAgcHVibGljIHJlbmRlcigpOiBKU1guRWxlbWVudCB7XG4gICAgICAgIGxldCBib2R5O1xuICAgICAgICBzd2l0Y2ggKHRoaXMuc3RhdGUucGhhc2UpIHtcbiAgICAgICAgICAgIGNhc2UgUEhBU0VfU1RBUlQ6XG4gICAgICAgICAgICAgICAgYm9keSA9IHRoaXMucmVuZGVyUGhhc2VTdGFydCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBQSEFTRV9TSE9XX1NBUzpcbiAgICAgICAgICAgICAgICBib2R5ID0gdGhpcy5yZW5kZXJQaGFzZVNob3dTYXMoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUEhBU0VfV0FJVF9GT1JfUEFSVE5FUl9UT19DT05GSVJNOlxuICAgICAgICAgICAgICAgIGJvZHkgPSB0aGlzLnJlbmRlclBoYXNlV2FpdEZvclBhcnRuZXJUb0NvbmZpcm0oKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUEhBU0VfVkVSSUZJRUQ6XG4gICAgICAgICAgICAgICAgYm9keSA9IHRoaXMucmVuZGVyUGhhc2VWZXJpZmllZCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBQSEFTRV9DQU5DRUxMRUQ6XG4gICAgICAgICAgICAgICAgYm9keSA9IHRoaXMucmVuZGVyUGhhc2VDYW5jZWxsZWQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8QmFzZURpYWxvZ1xuICAgICAgICAgICAgICAgIHRpdGxlPXtfdChcIkluY29taW5nIFZlcmlmaWNhdGlvbiBSZXF1ZXN0XCIpfVxuICAgICAgICAgICAgICAgIG9uRmluaXNoZWQ9e3RoaXMub25GaW5pc2hlZH1cbiAgICAgICAgICAgICAgICBmaXhlZFdpZHRoPXtmYWxzZX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7IGJvZHkgfVxuICAgICAgICAgICAgPC9CYXNlRGlhbG9nPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWdCQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUE5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbUJBLE1BQU1BLFdBQVcsR0FBRyxDQUFwQjtB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