"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _SetupEncryptionBody = _interopRequireDefault(require("../../../structures/auth/SetupEncryptionBody"));

var _BaseDialog = _interopRequireDefault(require("../BaseDialog"));

var _languageHandler = require("../../../../languageHandler");

var _SetupEncryptionStore = require("../../../../stores/SetupEncryptionStore");

/*
Copyright 2020 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
function iconFromPhase(phase) {
  if (phase === _SetupEncryptionStore.Phase.Done) {
    return require("../../../../../res/img/e2e/verified-deprecated.svg").default;
  } else {
    return require("../../../../../res/img/e2e/warning-deprecated.svg").default;
  }
}

class SetupEncryptionDialog extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "store", void 0);
    (0, _defineProperty2.default)(this, "onStoreUpdate", () => {
      this.setState({
        icon: iconFromPhase(this.store.phase)
      });
    });
    this.store = _SetupEncryptionStore.SetupEncryptionStore.sharedInstance();
    this.state = {
      icon: iconFromPhase(this.store.phase)
    };
  }

  componentDidMount() {
    this.store.on("update", this.onStoreUpdate);
  }

  componentWillUnmount() {
    this.store.removeListener("update", this.onStoreUpdate);
  }

  render() {
    return /*#__PURE__*/_react.default.createElement(_BaseDialog.default, {
      headerImage: this.state.icon,
      onFinished: this.props.onFinished,
      title: (0, _languageHandler._t)("Verify this session")
    }, /*#__PURE__*/_react.default.createElement(_SetupEncryptionBody.default, {
      onFinished: this.props.onFinished
    }));
  }

}

exports.default = SetupEncryptionDialog;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpY29uRnJvbVBoYXNlIiwicGhhc2UiLCJQaGFzZSIsIkRvbmUiLCJyZXF1aXJlIiwiZGVmYXVsdCIsIlNldHVwRW5jcnlwdGlvbkRpYWxvZyIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInNldFN0YXRlIiwiaWNvbiIsInN0b3JlIiwiU2V0dXBFbmNyeXB0aW9uU3RvcmUiLCJzaGFyZWRJbnN0YW5jZSIsInN0YXRlIiwiY29tcG9uZW50RGlkTW91bnQiLCJvbiIsIm9uU3RvcmVVcGRhdGUiLCJjb21wb25lbnRXaWxsVW5tb3VudCIsInJlbW92ZUxpc3RlbmVyIiwicmVuZGVyIiwib25GaW5pc2hlZCIsIl90Il0sInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvdmlld3MvZGlhbG9ncy9zZWN1cml0eS9TZXR1cEVuY3J5cHRpb25EaWFsb2cudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMCBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBTZXR1cEVuY3J5cHRpb25Cb2R5IGZyb20gJy4uLy4uLy4uL3N0cnVjdHVyZXMvYXV0aC9TZXR1cEVuY3J5cHRpb25Cb2R5JztcbmltcG9ydCBCYXNlRGlhbG9nIGZyb20gJy4uL0Jhc2VEaWFsb2cnO1xuaW1wb3J0IHsgX3QgfSBmcm9tICcuLi8uLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXInO1xuaW1wb3J0IHsgU2V0dXBFbmNyeXB0aW9uU3RvcmUsIFBoYXNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vc3RvcmVzL1NldHVwRW5jcnlwdGlvblN0b3JlJztcbmltcG9ydCB7IElEaWFsb2dQcm9wcyB9IGZyb20gXCIuLi9JRGlhbG9nUHJvcHNcIjtcblxuZnVuY3Rpb24gaWNvbkZyb21QaGFzZShwaGFzZTogUGhhc2UpIHtcbiAgICBpZiAocGhhc2UgPT09IFBoYXNlLkRvbmUpIHtcbiAgICAgICAgcmV0dXJuIHJlcXVpcmUoXCIuLi8uLi8uLi8uLi8uLi9yZXMvaW1nL2UyZS92ZXJpZmllZC1kZXByZWNhdGVkLnN2Z1wiKS5kZWZhdWx0O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXF1aXJlKFwiLi4vLi4vLi4vLi4vLi4vcmVzL2ltZy9lMmUvd2FybmluZy1kZXByZWNhdGVkLnN2Z1wiKS5kZWZhdWx0O1xuICAgIH1cbn1cblxuaW50ZXJmYWNlIElQcm9wcyBleHRlbmRzIElEaWFsb2dQcm9wcyB7fVxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgaWNvbjogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXR1cEVuY3J5cHRpb25EaWFsb2cgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SVByb3BzLCBJU3RhdGU+IHtcbiAgICBwcml2YXRlIHN0b3JlOiBTZXR1cEVuY3J5cHRpb25TdG9yZTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIHRoaXMuc3RvcmUgPSBTZXR1cEVuY3J5cHRpb25TdG9yZS5zaGFyZWRJbnN0YW5jZSgpO1xuICAgICAgICB0aGlzLnN0YXRlID0geyBpY29uOiBpY29uRnJvbVBoYXNlKHRoaXMuc3RvcmUucGhhc2UpIH07XG4gICAgfVxuXG4gICAgcHVibGljIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLnN0b3JlLm9uKFwidXBkYXRlXCIsIHRoaXMub25TdG9yZVVwZGF0ZSk7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB0aGlzLnN0b3JlLnJlbW92ZUxpc3RlbmVyKFwidXBkYXRlXCIsIHRoaXMub25TdG9yZVVwZGF0ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblN0b3JlVXBkYXRlID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgaWNvbjogaWNvbkZyb21QaGFzZSh0aGlzLnN0b3JlLnBoYXNlKSB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIDxCYXNlRGlhbG9nXG4gICAgICAgICAgICBoZWFkZXJJbWFnZT17dGhpcy5zdGF0ZS5pY29ufVxuICAgICAgICAgICAgb25GaW5pc2hlZD17dGhpcy5wcm9wcy5vbkZpbmlzaGVkfVxuICAgICAgICAgICAgdGl0bGU9e190KFwiVmVyaWZ5IHRoaXMgc2Vzc2lvblwiKX1cbiAgICAgICAgPlxuICAgICAgICAgICAgPFNldHVwRW5jcnlwdGlvbkJvZHkgb25GaW5pc2hlZD17dGhpcy5wcm9wcy5vbkZpbmlzaGVkfSAvPlxuICAgICAgICA8L0Jhc2VEaWFsb2c+O1xuICAgIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFnQkE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBLFNBQVNBLGFBQVQsQ0FBdUJDLEtBQXZCLEVBQXFDO0VBQ2pDLElBQUlBLEtBQUssS0FBS0MsMkJBQUEsQ0FBTUMsSUFBcEIsRUFBMEI7SUFDdEIsT0FBT0MsT0FBTyxDQUFDLG9EQUFELENBQVAsQ0FBOERDLE9BQXJFO0VBQ0gsQ0FGRCxNQUVPO0lBQ0gsT0FBT0QsT0FBTyxDQUFDLG1EQUFELENBQVAsQ0FBNkRDLE9BQXBFO0VBQ0g7QUFDSjs7QUFPYyxNQUFNQyxxQkFBTixTQUFvQ0MsY0FBQSxDQUFNQyxTQUExQyxDQUFvRTtFQUcvRUMsV0FBVyxDQUFDQyxLQUFELEVBQWdCO0lBQ3ZCLE1BQU1BLEtBQU47SUFEdUI7SUFBQSxxREFlSCxNQUFZO01BQ2hDLEtBQUtDLFFBQUwsQ0FBYztRQUFFQyxJQUFJLEVBQUVaLGFBQWEsQ0FBQyxLQUFLYSxLQUFMLENBQVdaLEtBQVo7TUFBckIsQ0FBZDtJQUNILENBakIwQjtJQUd2QixLQUFLWSxLQUFMLEdBQWFDLDBDQUFBLENBQXFCQyxjQUFyQixFQUFiO0lBQ0EsS0FBS0MsS0FBTCxHQUFhO01BQUVKLElBQUksRUFBRVosYUFBYSxDQUFDLEtBQUthLEtBQUwsQ0FBV1osS0FBWjtJQUFyQixDQUFiO0VBQ0g7O0VBRU1nQixpQkFBaUIsR0FBRztJQUN2QixLQUFLSixLQUFMLENBQVdLLEVBQVgsQ0FBYyxRQUFkLEVBQXdCLEtBQUtDLGFBQTdCO0VBQ0g7O0VBRU1DLG9CQUFvQixHQUFHO0lBQzFCLEtBQUtQLEtBQUwsQ0FBV1EsY0FBWCxDQUEwQixRQUExQixFQUFvQyxLQUFLRixhQUF6QztFQUNIOztFQU1NRyxNQUFNLEdBQUc7SUFDWixvQkFBTyw2QkFBQyxtQkFBRDtNQUNILFdBQVcsRUFBRSxLQUFLTixLQUFMLENBQVdKLElBRHJCO01BRUgsVUFBVSxFQUFFLEtBQUtGLEtBQUwsQ0FBV2EsVUFGcEI7TUFHSCxLQUFLLEVBQUUsSUFBQUMsbUJBQUEsRUFBRyxxQkFBSDtJQUhKLGdCQUtILDZCQUFDLDRCQUFEO01BQXFCLFVBQVUsRUFBRSxLQUFLZCxLQUFMLENBQVdhO0lBQTVDLEVBTEcsQ0FBUDtFQU9IOztBQTlCOEUifQ==