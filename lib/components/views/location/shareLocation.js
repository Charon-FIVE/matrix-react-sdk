"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.shareLocation = exports.shareLiveLocation = exports.LocationShareType = void 0;

var _contentHelpers = require("matrix-js-sdk/src/content-helpers");

var _logger = require("matrix-js-sdk/src/logger");

var _location = require("matrix-js-sdk/src/@types/location");

var _thread = require("matrix-js-sdk/src/models/thread");

var _languageHandler = require("../../../languageHandler");

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _QuestionDialog = _interopRequireDefault(require("../dialogs/QuestionDialog"));

var _SdkConfig = _interopRequireDefault(require("../../../SdkConfig"));

var _OwnBeaconStore = require("../../../stores/OwnBeaconStore");

var _localRoom = require("../../../utils/local-room");

/*
Copyright 2022 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
let LocationShareType;
exports.LocationShareType = LocationShareType;

(function (LocationShareType) {
  LocationShareType["Own"] = "Own";
  LocationShareType["Pin"] = "Pin";
  LocationShareType["Live"] = "Live";
})(LocationShareType || (exports.LocationShareType = LocationShareType = {}));

// default duration to 5min for now
const DEFAULT_LIVE_DURATION = 300000;

const getPermissionsErrorParams = shareType => {
  const errorMessage = shareType === LocationShareType.Live ? "Insufficient permissions to start sharing your live location" : "Insufficient permissions to send your location";
  const modalParams = {
    title: (0, _languageHandler._t)("You don't have permission to share locations"),
    description: (0, _languageHandler._t)("You need to have the right permissions in order to share locations in this room."),
    button: (0, _languageHandler._t)("OK"),
    hasCancelButton: false,
    onFinished: () => {} // NOOP

  };
  return {
    modalParams,
    errorMessage
  };
};

const getDefaultErrorParams = (shareType, openMenu) => {
  const errorMessage = shareType === LocationShareType.Live ? "We couldn't start sharing your live location" : "We couldn't send your location";
  const modalParams = {
    title: (0, _languageHandler._t)("We couldn't send your location"),
    description: (0, _languageHandler._t)("%(brand)s could not send your location. Please try again later.", {
      brand: _SdkConfig.default.get().brand
    }),
    button: (0, _languageHandler._t)('Try again'),
    cancelButton: (0, _languageHandler._t)('Cancel'),
    onFinished: tryAgain => {
      if (tryAgain) {
        openMenu();
      }
    }
  };
  return {
    modalParams,
    errorMessage
  };
};

const handleShareError = (error, openMenu, shareType) => {
  const {
    modalParams,
    errorMessage
  } = error.errcode === 'M_FORBIDDEN' ? getPermissionsErrorParams(shareType) : getDefaultErrorParams(shareType, openMenu);

  _logger.logger.error(errorMessage, error);

  _Modal.default.createDialog(_QuestionDialog.default, modalParams);
};

const shareLiveLocation = (client, roomId, displayName, openMenu) => async _ref => {
  let {
    timeout
  } = _ref;
  const description = (0, _languageHandler._t)(`%(displayName)s's live location`, {
    displayName
  });

  try {
    await _OwnBeaconStore.OwnBeaconStore.instance.createLiveBeacon(roomId, (0, _contentHelpers.makeBeaconInfoContent)(timeout ?? DEFAULT_LIVE_DURATION, true,
    /* isLive */
    description, _location.LocationAssetType.Self));
  } catch (error) {
    handleShareError(error, openMenu, LocationShareType.Live);
  }
};

exports.shareLiveLocation = shareLiveLocation;

const shareLocation = (client, roomId, shareType, relation, openMenu) => async _ref2 => {
  let {
    uri,
    timestamp
  } = _ref2;
  if (!uri) return;

  try {
    const threadId = relation?.rel_type === _thread.THREAD_RELATION_TYPE.name ? relation.event_id : null;
    const assetType = shareType === LocationShareType.Pin ? _location.LocationAssetType.Pin : _location.LocationAssetType.Self;
    const content = (0, _contentHelpers.makeLocationContent)(undefined, uri, timestamp, undefined, assetType);
    await (0, _localRoom.doMaybeLocalRoomAction)(roomId, actualRoomId => client.sendMessage(actualRoomId, threadId, content), client);
  } catch (error) {
    handleShareError(error, openMenu, shareType);
  }
};

exports.shareLocation = shareLocation;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJMb2NhdGlvblNoYXJlVHlwZSIsIkRFRkFVTFRfTElWRV9EVVJBVElPTiIsImdldFBlcm1pc3Npb25zRXJyb3JQYXJhbXMiLCJzaGFyZVR5cGUiLCJlcnJvck1lc3NhZ2UiLCJMaXZlIiwibW9kYWxQYXJhbXMiLCJ0aXRsZSIsIl90IiwiZGVzY3JpcHRpb24iLCJidXR0b24iLCJoYXNDYW5jZWxCdXR0b24iLCJvbkZpbmlzaGVkIiwiZ2V0RGVmYXVsdEVycm9yUGFyYW1zIiwib3Blbk1lbnUiLCJicmFuZCIsIlNka0NvbmZpZyIsImdldCIsImNhbmNlbEJ1dHRvbiIsInRyeUFnYWluIiwiaGFuZGxlU2hhcmVFcnJvciIsImVycm9yIiwiZXJyY29kZSIsImxvZ2dlciIsIk1vZGFsIiwiY3JlYXRlRGlhbG9nIiwiUXVlc3Rpb25EaWFsb2ciLCJzaGFyZUxpdmVMb2NhdGlvbiIsImNsaWVudCIsInJvb21JZCIsImRpc3BsYXlOYW1lIiwidGltZW91dCIsIk93bkJlYWNvblN0b3JlIiwiaW5zdGFuY2UiLCJjcmVhdGVMaXZlQmVhY29uIiwibWFrZUJlYWNvbkluZm9Db250ZW50IiwiTG9jYXRpb25Bc3NldFR5cGUiLCJTZWxmIiwic2hhcmVMb2NhdGlvbiIsInJlbGF0aW9uIiwidXJpIiwidGltZXN0YW1wIiwidGhyZWFkSWQiLCJyZWxfdHlwZSIsIlRIUkVBRF9SRUxBVElPTl9UWVBFIiwibmFtZSIsImV2ZW50X2lkIiwiYXNzZXRUeXBlIiwiUGluIiwiY29udGVudCIsIm1ha2VMb2NhdGlvbkNvbnRlbnQiLCJ1bmRlZmluZWQiLCJkb01heWJlTG9jYWxSb29tQWN0aW9uIiwiYWN0dWFsUm9vbUlkIiwic2VuZE1lc3NhZ2UiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy92aWV3cy9sb2NhdGlvbi9zaGFyZUxvY2F0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMiBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCB7IE1hdHJpeENsaWVudCB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9jbGllbnRcIjtcbmltcG9ydCB7IE1hdHJpeEVycm9yIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL2h0dHAtYXBpXCI7XG5pbXBvcnQgeyBtYWtlTG9jYXRpb25Db250ZW50LCBtYWtlQmVhY29uSW5mb0NvbnRlbnQgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvY29udGVudC1oZWxwZXJzXCI7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbG9nZ2VyXCI7XG5pbXBvcnQgeyBJRXZlbnRSZWxhdGlvbiB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9tb2RlbHMvZXZlbnRcIjtcbmltcG9ydCB7IExvY2F0aW9uQXNzZXRUeXBlIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL0B0eXBlcy9sb2NhdGlvblwiO1xuaW1wb3J0IHsgVEhSRUFEX1JFTEFUSU9OX1RZUEUgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL3RocmVhZFwiO1xuXG5pbXBvcnQgeyBfdCB9IGZyb20gXCIuLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXJcIjtcbmltcG9ydCBNb2RhbCBmcm9tIFwiLi4vLi4vLi4vTW9kYWxcIjtcbmltcG9ydCBRdWVzdGlvbkRpYWxvZywgeyBJUXVlc3Rpb25EaWFsb2dQcm9wcyB9IGZyb20gXCIuLi9kaWFsb2dzL1F1ZXN0aW9uRGlhbG9nXCI7XG5pbXBvcnQgU2RrQ29uZmlnIGZyb20gXCIuLi8uLi8uLi9TZGtDb25maWdcIjtcbmltcG9ydCB7IE93bkJlYWNvblN0b3JlIH0gZnJvbSBcIi4uLy4uLy4uL3N0b3Jlcy9Pd25CZWFjb25TdG9yZVwiO1xuaW1wb3J0IHsgZG9NYXliZUxvY2FsUm9vbUFjdGlvbiB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9sb2NhbC1yb29tXCI7XG5cbmV4cG9ydCBlbnVtIExvY2F0aW9uU2hhcmVUeXBlIHtcbiAgICBPd24gPSAnT3duJyxcbiAgICBQaW4gPSAnUGluJyxcbiAgICBMaXZlID0gJ0xpdmUnXG59XG5cbmV4cG9ydCB0eXBlIExvY2F0aW9uU2hhcmVQcm9wcyA9IHtcbiAgICB0aW1lb3V0PzogbnVtYmVyO1xuICAgIHVyaT86IHN0cmluZztcbiAgICB0aW1lc3RhbXA/OiBudW1iZXI7XG59O1xuXG4vLyBkZWZhdWx0IGR1cmF0aW9uIHRvIDVtaW4gZm9yIG5vd1xuY29uc3QgREVGQVVMVF9MSVZFX0RVUkFUSU9OID0gMzAwMDAwO1xuXG5leHBvcnQgdHlwZSBTaGFyZUxvY2F0aW9uRm4gPSAocHJvcHM6IExvY2F0aW9uU2hhcmVQcm9wcykgPT4gUHJvbWlzZTx2b2lkPjtcblxuY29uc3QgZ2V0UGVybWlzc2lvbnNFcnJvclBhcmFtcyA9IChzaGFyZVR5cGU6IExvY2F0aW9uU2hhcmVUeXBlKToge1xuICAgIGVycm9yTWVzc2FnZTogc3RyaW5nO1xuICAgIG1vZGFsUGFyYW1zOiBJUXVlc3Rpb25EaWFsb2dQcm9wcztcbn0gPT4ge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHNoYXJlVHlwZSA9PT0gTG9jYXRpb25TaGFyZVR5cGUuTGl2ZVxuICAgICAgICA/IFwiSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zIHRvIHN0YXJ0IHNoYXJpbmcgeW91ciBsaXZlIGxvY2F0aW9uXCJcbiAgICAgICAgOiBcIkluc3VmZmljaWVudCBwZXJtaXNzaW9ucyB0byBzZW5kIHlvdXIgbG9jYXRpb25cIjtcblxuICAgIGNvbnN0IG1vZGFsUGFyYW1zID0ge1xuICAgICAgICB0aXRsZTogX3QoXCJZb3UgZG9uJ3QgaGF2ZSBwZXJtaXNzaW9uIHRvIHNoYXJlIGxvY2F0aW9uc1wiKSxcbiAgICAgICAgZGVzY3JpcHRpb246IF90KFwiWW91IG5lZWQgdG8gaGF2ZSB0aGUgcmlnaHQgcGVybWlzc2lvbnMgaW4gb3JkZXIgdG8gc2hhcmUgbG9jYXRpb25zIGluIHRoaXMgcm9vbS5cIiksXG4gICAgICAgIGJ1dHRvbjogX3QoXCJPS1wiKSxcbiAgICAgICAgaGFzQ2FuY2VsQnV0dG9uOiBmYWxzZSxcbiAgICAgICAgb25GaW5pc2hlZDogKCkgPT4ge30sIC8vIE5PT1BcbiAgICB9O1xuICAgIHJldHVybiB7IG1vZGFsUGFyYW1zLCBlcnJvck1lc3NhZ2UgfTtcbn07XG5cbmNvbnN0IGdldERlZmF1bHRFcnJvclBhcmFtcyA9IChzaGFyZVR5cGU6IExvY2F0aW9uU2hhcmVUeXBlLCBvcGVuTWVudTogKCkgPT4gdm9pZCk6IHtcbiAgICBlcnJvck1lc3NhZ2U6IHN0cmluZztcbiAgICBtb2RhbFBhcmFtczogSVF1ZXN0aW9uRGlhbG9nUHJvcHM7XG59ID0+IHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBzaGFyZVR5cGUgPT09IExvY2F0aW9uU2hhcmVUeXBlLkxpdmVcbiAgICAgICAgPyBcIldlIGNvdWxkbid0IHN0YXJ0IHNoYXJpbmcgeW91ciBsaXZlIGxvY2F0aW9uXCJcbiAgICAgICAgOiBcIldlIGNvdWxkbid0IHNlbmQgeW91ciBsb2NhdGlvblwiO1xuICAgIGNvbnN0IG1vZGFsUGFyYW1zID0ge1xuICAgICAgICB0aXRsZTogX3QoXCJXZSBjb3VsZG4ndCBzZW5kIHlvdXIgbG9jYXRpb25cIiksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBfdChcIiUoYnJhbmQpcyBjb3VsZCBub3Qgc2VuZCB5b3VyIGxvY2F0aW9uLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiLCB7XG4gICAgICAgICAgICBicmFuZDogU2RrQ29uZmlnLmdldCgpLmJyYW5kLFxuICAgICAgICB9KSxcbiAgICAgICAgYnV0dG9uOiBfdCgnVHJ5IGFnYWluJyksXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogX3QoJ0NhbmNlbCcpLFxuICAgICAgICBvbkZpbmlzaGVkOiAodHJ5QWdhaW46IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIGlmICh0cnlBZ2Fpbikge1xuICAgICAgICAgICAgICAgIG9wZW5NZW51KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZXR1cm4geyBtb2RhbFBhcmFtcywgZXJyb3JNZXNzYWdlIH07XG59O1xuXG5jb25zdCBoYW5kbGVTaGFyZUVycm9yID0gKGVycm9yOiBFcnJvciwgb3Blbk1lbnU6ICgpID0+IHZvaWQsIHNoYXJlVHlwZTogTG9jYXRpb25TaGFyZVR5cGUpOiB2b2lkID0+IHtcbiAgICBjb25zdCB7IG1vZGFsUGFyYW1zLCBlcnJvck1lc3NhZ2UgfSA9IChlcnJvciBhcyBNYXRyaXhFcnJvcikuZXJyY29kZSA9PT0gJ01fRk9SQklEREVOJyA/XG4gICAgICAgIGdldFBlcm1pc3Npb25zRXJyb3JQYXJhbXMoc2hhcmVUeXBlKSA6XG4gICAgICAgIGdldERlZmF1bHRFcnJvclBhcmFtcyhzaGFyZVR5cGUsIG9wZW5NZW51KTtcblxuICAgIGxvZ2dlci5lcnJvcihlcnJvck1lc3NhZ2UsIGVycm9yKTtcblxuICAgIE1vZGFsLmNyZWF0ZURpYWxvZyhRdWVzdGlvbkRpYWxvZywgbW9kYWxQYXJhbXMpO1xufTtcblxuZXhwb3J0IGNvbnN0IHNoYXJlTGl2ZUxvY2F0aW9uID0gKFxuICAgIGNsaWVudDogTWF0cml4Q2xpZW50LCByb29tSWQ6IHN0cmluZywgZGlzcGxheU5hbWU6IHN0cmluZywgb3Blbk1lbnU6ICgpID0+IHZvaWQsXG4pOiBTaGFyZUxvY2F0aW9uRm4gPT4gYXN5bmMgKHsgdGltZW91dCB9KSA9PiB7XG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBfdChgJShkaXNwbGF5TmFtZSlzJ3MgbGl2ZSBsb2NhdGlvbmAsIHsgZGlzcGxheU5hbWUgfSk7XG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgT3duQmVhY29uU3RvcmUuaW5zdGFuY2UuY3JlYXRlTGl2ZUJlYWNvbihcbiAgICAgICAgICAgIHJvb21JZCxcbiAgICAgICAgICAgIG1ha2VCZWFjb25JbmZvQ29udGVudChcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID8/IERFRkFVTFRfTElWRV9EVVJBVElPTixcbiAgICAgICAgICAgICAgICB0cnVlLCAvKiBpc0xpdmUgKi9cbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICBMb2NhdGlvbkFzc2V0VHlwZS5TZWxmLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBoYW5kbGVTaGFyZUVycm9yKGVycm9yLCBvcGVuTWVudSwgTG9jYXRpb25TaGFyZVR5cGUuTGl2ZSk7XG4gICAgfVxufTtcblxuZXhwb3J0IGNvbnN0IHNoYXJlTG9jYXRpb24gPSAoXG4gICAgY2xpZW50OiBNYXRyaXhDbGllbnQsXG4gICAgcm9vbUlkOiBzdHJpbmcsXG4gICAgc2hhcmVUeXBlOiBMb2NhdGlvblNoYXJlVHlwZSxcbiAgICByZWxhdGlvbjogSUV2ZW50UmVsYXRpb24gfCB1bmRlZmluZWQsXG4gICAgb3Blbk1lbnU6ICgpID0+IHZvaWQsXG4pOiBTaGFyZUxvY2F0aW9uRm4gPT4gYXN5bmMgKHsgdXJpLCB0aW1lc3RhbXAgfSkgPT4ge1xuICAgIGlmICghdXJpKSByZXR1cm47XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdGhyZWFkSWQgPSByZWxhdGlvbj8ucmVsX3R5cGUgPT09IFRIUkVBRF9SRUxBVElPTl9UWVBFLm5hbWUgPyByZWxhdGlvbi5ldmVudF9pZCA6IG51bGw7XG4gICAgICAgIGNvbnN0IGFzc2V0VHlwZSA9IHNoYXJlVHlwZSA9PT0gTG9jYXRpb25TaGFyZVR5cGUuUGluID8gTG9jYXRpb25Bc3NldFR5cGUuUGluIDogTG9jYXRpb25Bc3NldFR5cGUuU2VsZjtcbiAgICAgICAgY29uc3QgY29udGVudCA9IG1ha2VMb2NhdGlvbkNvbnRlbnQodW5kZWZpbmVkLCB1cmksIHRpbWVzdGFtcCwgdW5kZWZpbmVkLCBhc3NldFR5cGUpO1xuICAgICAgICBhd2FpdCBkb01heWJlTG9jYWxSb29tQWN0aW9uKFxuICAgICAgICAgICAgcm9vbUlkLFxuICAgICAgICAgICAgKGFjdHVhbFJvb21JZDogc3RyaW5nKSA9PiBjbGllbnQuc2VuZE1lc3NhZ2UoYWN0dWFsUm9vbUlkLCB0aHJlYWRJZCwgY29udGVudCksXG4gICAgICAgICAgICBjbGllbnQsXG4gICAgICAgICk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaGFuZGxlU2hhcmVFcnJvcihlcnJvciwgb3Blbk1lbnUsIHNoYXJlVHlwZSk7XG4gICAgfVxufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBa0JBOztBQUNBOztBQUVBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQTdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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