"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _AccessibleTooltipButton = _interopRequireDefault(require("../../elements/AccessibleTooltipButton"));

var _LegacyCallContextMenu = _interopRequireDefault(require("../../context_menus/LegacyCallContextMenu"));

var _DialpadContextMenu = _interopRequireDefault(require("../../context_menus/DialpadContextMenu"));

var _Tooltip = require("../../elements/Tooltip");

var _ContextMenu = require("../../../structures/ContextMenu");

var _languageHandler = require("../../../../languageHandler");

var _DeviceContextMenu = _interopRequireDefault(require("../../context_menus/DeviceContextMenu"));

var _MediaDeviceHandler = require("../../../../MediaDeviceHandler");

const _excluded = ["children", "state", "className", "onLabel", "offLabel"],
      _excluded2 = ["state", "deviceKinds"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

// Height of the header duplicated from CSS because we need to subtract it from our max
// height to get the max height of the video
const CONTEXT_MENU_VPADDING = 8; // How far the context menu sits above the button (px)

const CONTROLS_HIDE_DELAY = 2000;

const LegacyCallViewToggleButton = _ref => {
  let {
    children,
    state: isOn,
    className,
    onLabel,
    offLabel
  } = _ref,
      props = (0, _objectWithoutProperties2.default)(_ref, _excluded);
  const classes = (0, _classnames.default)("mx_LegacyCallViewButtons_button", className, {
    mx_LegacyCallViewButtons_button_on: isOn,
    mx_LegacyCallViewButtons_button_off: !isOn
  });
  return /*#__PURE__*/_react.default.createElement(_AccessibleTooltipButton.default, (0, _extends2.default)({
    className: classes,
    title: isOn ? onLabel : offLabel,
    alignment: _Tooltip.Alignment.Top
  }, props), children);
};

const LegacyCallViewDropdownButton = _ref2 => {
  let {
    state,
    deviceKinds
  } = _ref2,
      props = (0, _objectWithoutProperties2.default)(_ref2, _excluded2);
  const [menuDisplayed, buttonRef, openMenu, closeMenu] = (0, _ContextMenu.useContextMenu)();
  const [hoveringDropdown, setHoveringDropdown] = (0, _react.useState)(false);
  const classes = (0, _classnames.default)("mx_LegacyCallViewButtons_button", "mx_LegacyCallViewButtons_dropdownButton", {
    mx_LegacyCallViewButtons_dropdownButton_collapsed: !menuDisplayed
  });

  const onClick = event => {
    event.stopPropagation();
    openMenu();
  };

  return /*#__PURE__*/_react.default.createElement(LegacyCallViewToggleButton, (0, _extends2.default)({
    inputRef: buttonRef,
    forceHide: menuDisplayed || hoveringDropdown,
    state: state
  }, props), /*#__PURE__*/_react.default.createElement(LegacyCallViewToggleButton, {
    className: classes,
    onClick: onClick,
    onHover: hovering => setHoveringDropdown(hovering),
    state: state
  }), menuDisplayed && /*#__PURE__*/_react.default.createElement(_DeviceContextMenu.default, (0, _extends2.default)({}, (0, _ContextMenu.alwaysAboveRightOf)(buttonRef.current?.getBoundingClientRect()), {
    onFinished: closeMenu,
    deviceKinds: deviceKinds
  })));
};

class LegacyCallViewButtons extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "dialpadButton", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "contextMenuButton", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "controlsHideTimer", null);
    (0, _defineProperty2.default)(this, "onControlsHideTimer", () => {
      if (this.state.hoveringControls || this.state.showDialpad || this.state.showMoreMenu) return;
      this.controlsHideTimer = null;
      this.setState({
        visible: false
      });
    });
    (0, _defineProperty2.default)(this, "onMouseEnter", () => {
      this.setState({
        hoveringControls: true
      });
    });
    (0, _defineProperty2.default)(this, "onMouseLeave", () => {
      this.setState({
        hoveringControls: false
      });
    });
    (0, _defineProperty2.default)(this, "onDialpadClick", () => {
      if (!this.state.showDialpad) {
        this.setState({
          showDialpad: true
        });
        this.showControls();
      } else {
        this.setState({
          showDialpad: false
        });
      }
    });
    (0, _defineProperty2.default)(this, "onMoreClick", () => {
      this.setState({
        showMoreMenu: true
      });
      this.showControls();
    });
    (0, _defineProperty2.default)(this, "closeDialpad", () => {
      this.setState({
        showDialpad: false
      });
    });
    (0, _defineProperty2.default)(this, "closeContextMenu", () => {
      this.setState({
        showMoreMenu: false
      });
    });
    this.state = {
      showDialpad: false,
      hoveringControls: false,
      showMoreMenu: false,
      visible: true
    };
  }

  componentDidMount() {
    this.showControls();
  }

  showControls() {
    if (this.state.showMoreMenu || this.state.showDialpad) return;

    if (!this.state.visible) {
      this.setState({
        visible: true
      });
    }

    if (this.controlsHideTimer !== null) {
      clearTimeout(this.controlsHideTimer);
    }

    this.controlsHideTimer = window.setTimeout(this.onControlsHideTimer, CONTROLS_HIDE_DELAY);
  }

  render() {
    const callControlsClasses = (0, _classnames.default)("mx_LegacyCallViewButtons", {
      mx_LegacyCallViewButtons_hidden: !this.state.visible
    });
    let dialPad;

    if (this.state.showDialpad) {
      dialPad = /*#__PURE__*/_react.default.createElement(_DialpadContextMenu.default, (0, _extends2.default)({}, (0, _ContextMenu.alwaysAboveLeftOf)(this.dialpadButton.current.getBoundingClientRect(), _ContextMenu.ChevronFace.None, CONTEXT_MENU_VPADDING), {
        // We mount the context menus as a as a child typically in order to include the
        // context menus when fullscreening the call content.
        // However, this does not work as well when the call is embedded in a
        // picture-in-picture frame. Thus, only mount as child when we are *not* in PiP.
        mountAsChild: !this.props.pipMode,
        onFinished: this.closeDialpad,
        call: this.props.call
      }));
    }

    let contextMenu;

    if (this.state.showMoreMenu) {
      contextMenu = /*#__PURE__*/_react.default.createElement(_LegacyCallContextMenu.default, (0, _extends2.default)({}, (0, _ContextMenu.alwaysAboveLeftOf)(this.contextMenuButton.current.getBoundingClientRect(), _ContextMenu.ChevronFace.None, CONTEXT_MENU_VPADDING), {
        mountAsChild: !this.props.pipMode,
        onFinished: this.closeContextMenu,
        call: this.props.call
      }));
    }

    return /*#__PURE__*/_react.default.createElement("div", {
      className: callControlsClasses,
      onMouseEnter: this.onMouseEnter,
      onMouseLeave: this.onMouseLeave
    }, dialPad, contextMenu, this.props.buttonsVisibility.dialpad && /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuTooltipButton, {
      className: "mx_LegacyCallViewButtons_button mx_LegacyCallViewButtons_dialpad",
      inputRef: this.dialpadButton,
      onClick: this.onDialpadClick,
      isExpanded: this.state.showDialpad,
      title: (0, _languageHandler._t)("Dialpad"),
      alignment: _Tooltip.Alignment.Top
    }), /*#__PURE__*/_react.default.createElement(LegacyCallViewDropdownButton, {
      state: !this.props.buttonsState.micMuted,
      className: "mx_LegacyCallViewButtons_button_mic",
      onLabel: (0, _languageHandler._t)("Mute the microphone"),
      offLabel: (0, _languageHandler._t)("Unmute the microphone"),
      onClick: this.props.handlers.onMicMuteClick,
      deviceKinds: [_MediaDeviceHandler.MediaDeviceKindEnum.AudioInput, _MediaDeviceHandler.MediaDeviceKindEnum.AudioOutput]
    }), this.props.buttonsVisibility.vidMute && /*#__PURE__*/_react.default.createElement(LegacyCallViewDropdownButton, {
      state: !this.props.buttonsState.vidMuted,
      className: "mx_LegacyCallViewButtons_button_vid",
      onLabel: (0, _languageHandler._t)("Stop the camera"),
      offLabel: (0, _languageHandler._t)("Start the camera"),
      onClick: this.props.handlers.onVidMuteClick,
      deviceKinds: [_MediaDeviceHandler.MediaDeviceKindEnum.VideoInput]
    }), this.props.buttonsVisibility.screensharing && /*#__PURE__*/_react.default.createElement(LegacyCallViewToggleButton, {
      state: this.props.buttonsState.screensharing,
      className: "mx_LegacyCallViewButtons_button_screensharing",
      onLabel: (0, _languageHandler._t)("Stop sharing your screen"),
      offLabel: (0, _languageHandler._t)("Start sharing your screen"),
      onClick: this.props.handlers.onScreenshareClick
    }), this.props.buttonsVisibility.sidebar && /*#__PURE__*/_react.default.createElement(LegacyCallViewToggleButton, {
      state: this.props.buttonsState.sidebarShown,
      className: "mx_LegacyCallViewButtons_button_sidebar",
      onLabel: (0, _languageHandler._t)("Hide sidebar"),
      offLabel: (0, _languageHandler._t)("Show sidebar"),
      onClick: this.props.handlers.onToggleSidebarClick
    }), this.props.buttonsVisibility.contextMenu && /*#__PURE__*/_react.default.createElement(_ContextMenu.ContextMenuTooltipButton, {
      className: "mx_LegacyCallViewButtons_button mx_LegacyCallViewButtons_button_more",
      onClick: this.onMoreClick,
      inputRef: this.contextMenuButton,
      isExpanded: this.state.showMoreMenu,
      title: (0, _languageHandler._t)("More"),
      alignment: _Tooltip.Alignment.Top
    }), /*#__PURE__*/_react.default.createElement(_AccessibleTooltipButton.default, {
      className: "mx_LegacyCallViewButtons_button mx_LegacyCallViewButtons_button_hangup",
      onClick: this.props.handlers.onHangupClick,
      title: (0, _languageHandler._t)("Hangup"),
      alignment: _Tooltip.Alignment.Top
    }));
  }

}

exports.default = LegacyCallViewButtons;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDT05URVhUX01FTlVfVlBBRERJTkciLCJDT05UUk9MU19ISURFX0RFTEFZIiwiTGVnYWN5Q2FsbFZpZXdUb2dnbGVCdXR0b24iLCJjaGlsZHJlbiIsInN0YXRlIiwiaXNPbiIsImNsYXNzTmFtZSIsIm9uTGFiZWwiLCJvZmZMYWJlbCIsInByb3BzIiwiY2xhc3NlcyIsImNsYXNzTmFtZXMiLCJteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfYnV0dG9uX29uIiwibXhfTGVnYWN5Q2FsbFZpZXdCdXR0b25zX2J1dHRvbl9vZmYiLCJBbGlnbm1lbnQiLCJUb3AiLCJMZWdhY3lDYWxsVmlld0Ryb3Bkb3duQnV0dG9uIiwiZGV2aWNlS2luZHMiLCJtZW51RGlzcGxheWVkIiwiYnV0dG9uUmVmIiwib3Blbk1lbnUiLCJjbG9zZU1lbnUiLCJ1c2VDb250ZXh0TWVudSIsImhvdmVyaW5nRHJvcGRvd24iLCJzZXRIb3ZlcmluZ0Ryb3Bkb3duIiwidXNlU3RhdGUiLCJteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfZHJvcGRvd25CdXR0b25fY29sbGFwc2VkIiwib25DbGljayIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwiaG92ZXJpbmciLCJhbHdheXNBYm92ZVJpZ2h0T2YiLCJjdXJyZW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiTGVnYWN5Q2FsbFZpZXdCdXR0b25zIiwiUmVhY3QiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsImNyZWF0ZVJlZiIsImhvdmVyaW5nQ29udHJvbHMiLCJzaG93RGlhbHBhZCIsInNob3dNb3JlTWVudSIsImNvbnRyb2xzSGlkZVRpbWVyIiwic2V0U3RhdGUiLCJ2aXNpYmxlIiwic2hvd0NvbnRyb2xzIiwiY29tcG9uZW50RGlkTW91bnQiLCJjbGVhclRpbWVvdXQiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0Iiwib25Db250cm9sc0hpZGVUaW1lciIsInJlbmRlciIsImNhbGxDb250cm9sc0NsYXNzZXMiLCJteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfaGlkZGVuIiwiZGlhbFBhZCIsImFsd2F5c0Fib3ZlTGVmdE9mIiwiZGlhbHBhZEJ1dHRvbiIsIkNoZXZyb25GYWNlIiwiTm9uZSIsInBpcE1vZGUiLCJjbG9zZURpYWxwYWQiLCJjYWxsIiwiY29udGV4dE1lbnUiLCJjb250ZXh0TWVudUJ1dHRvbiIsImNsb3NlQ29udGV4dE1lbnUiLCJvbk1vdXNlRW50ZXIiLCJvbk1vdXNlTGVhdmUiLCJidXR0b25zVmlzaWJpbGl0eSIsImRpYWxwYWQiLCJvbkRpYWxwYWRDbGljayIsIl90IiwiYnV0dG9uc1N0YXRlIiwibWljTXV0ZWQiLCJoYW5kbGVycyIsIm9uTWljTXV0ZUNsaWNrIiwiTWVkaWFEZXZpY2VLaW5kRW51bSIsIkF1ZGlvSW5wdXQiLCJBdWRpb091dHB1dCIsInZpZE11dGUiLCJ2aWRNdXRlZCIsIm9uVmlkTXV0ZUNsaWNrIiwiVmlkZW9JbnB1dCIsInNjcmVlbnNoYXJpbmciLCJvblNjcmVlbnNoYXJlQ2xpY2siLCJzaWRlYmFyIiwic2lkZWJhclNob3duIiwib25Ub2dnbGVTaWRlYmFyQ2xpY2siLCJvbk1vcmVDbGljayIsIm9uSGFuZ3VwQ2xpY2siXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy92aWV3cy92b2lwL0xlZ2FjeUNhbGxWaWV3L0xlZ2FjeUNhbGxWaWV3QnV0dG9ucy50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE1LCAyMDE2IE9wZW5NYXJrZXQgTHRkXG5Db3B5cmlnaHQgMjAxOSAtIDIwMjEgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cbkNvcHlyaWdodCAyMDIxIMWgaW1vbiBCcmFuZG5lciA8c2ltb24uYnJhLmFnQGdtYWlsLmNvbT5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHsgY3JlYXRlUmVmLCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSBcImNsYXNzbmFtZXNcIjtcbmltcG9ydCB7IE1hdHJpeENhbGwgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvd2VicnRjL2NhbGxcIjtcblxuaW1wb3J0IEFjY2Vzc2libGVUb29sdGlwQnV0dG9uIGZyb20gXCIuLi8uLi9lbGVtZW50cy9BY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvblwiO1xuaW1wb3J0IExlZ2FjeUNhbGxDb250ZXh0TWVudSBmcm9tIFwiLi4vLi4vY29udGV4dF9tZW51cy9MZWdhY3lDYWxsQ29udGV4dE1lbnVcIjtcbmltcG9ydCBEaWFscGFkQ29udGV4dE1lbnUgZnJvbSBcIi4uLy4uL2NvbnRleHRfbWVudXMvRGlhbHBhZENvbnRleHRNZW51XCI7XG5pbXBvcnQgeyBBbGlnbm1lbnQgfSBmcm9tIFwiLi4vLi4vZWxlbWVudHMvVG9vbHRpcFwiO1xuaW1wb3J0IHtcbiAgICBhbHdheXNBYm92ZUxlZnRPZixcbiAgICBhbHdheXNBYm92ZVJpZ2h0T2YsXG4gICAgQ2hldnJvbkZhY2UsXG4gICAgQ29udGV4dE1lbnVUb29sdGlwQnV0dG9uLFxuICAgIHVzZUNvbnRleHRNZW51LFxufSBmcm9tICcuLi8uLi8uLi9zdHJ1Y3R1cmVzL0NvbnRleHRNZW51JztcbmltcG9ydCB7IF90IH0gZnJvbSBcIi4uLy4uLy4uLy4uL2xhbmd1YWdlSGFuZGxlclwiO1xuaW1wb3J0IERldmljZUNvbnRleHRNZW51IGZyb20gXCIuLi8uLi9jb250ZXh0X21lbnVzL0RldmljZUNvbnRleHRNZW51XCI7XG5pbXBvcnQgeyBNZWRpYURldmljZUtpbmRFbnVtIH0gZnJvbSBcIi4uLy4uLy4uLy4uL01lZGlhRGV2aWNlSGFuZGxlclwiO1xuXG4vLyBIZWlnaHQgb2YgdGhlIGhlYWRlciBkdXBsaWNhdGVkIGZyb20gQ1NTIGJlY2F1c2Ugd2UgbmVlZCB0byBzdWJ0cmFjdCBpdCBmcm9tIG91ciBtYXhcbi8vIGhlaWdodCB0byBnZXQgdGhlIG1heCBoZWlnaHQgb2YgdGhlIHZpZGVvXG5jb25zdCBDT05URVhUX01FTlVfVlBBRERJTkcgPSA4OyAvLyBIb3cgZmFyIHRoZSBjb250ZXh0IG1lbnUgc2l0cyBhYm92ZSB0aGUgYnV0dG9uIChweClcblxuY29uc3QgQ09OVFJPTFNfSElERV9ERUxBWSA9IDIwMDA7XG5cbmludGVyZmFjZSBJQnV0dG9uUHJvcHMgZXh0ZW5kcyBPbWl0PFJlYWN0LkNvbXBvbmVudFByb3BzPHR5cGVvZiBBY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvbj4sIFwidGl0bGVcIj4ge1xuICAgIHN0YXRlOiBib29sZWFuO1xuICAgIGNsYXNzTmFtZTogc3RyaW5nO1xuICAgIG9uTGFiZWw/OiBzdHJpbmc7XG4gICAgb2ZmTGFiZWw/OiBzdHJpbmc7XG4gICAgb25DbGljazogKGV2ZW50OiBSZWFjdC5Nb3VzZUV2ZW50KSA9PiB2b2lkO1xufVxuXG5jb25zdCBMZWdhY3lDYWxsVmlld1RvZ2dsZUJ1dHRvbjogUmVhY3QuRkM8SUJ1dHRvblByb3BzPiA9ICh7XG4gICAgY2hpbGRyZW4sXG4gICAgc3RhdGU6IGlzT24sXG4gICAgY2xhc3NOYW1lLFxuICAgIG9uTGFiZWwsXG4gICAgb2ZmTGFiZWwsXG4gICAgLi4ucHJvcHNcbn0pID0+IHtcbiAgICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcyhcIm14X0xlZ2FjeUNhbGxWaWV3QnV0dG9uc19idXR0b25cIiwgY2xhc3NOYW1lLCB7XG4gICAgICAgIG14X0xlZ2FjeUNhbGxWaWV3QnV0dG9uc19idXR0b25fb246IGlzT24sXG4gICAgICAgIG14X0xlZ2FjeUNhbGxWaWV3QnV0dG9uc19idXR0b25fb2ZmOiAhaXNPbixcbiAgICB9KTtcblxuICAgIHJldHVybiAoXG4gICAgICAgIDxBY2Nlc3NpYmxlVG9vbHRpcEJ1dHRvblxuICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzfVxuICAgICAgICAgICAgdGl0bGU9e2lzT24gPyBvbkxhYmVsIDogb2ZmTGFiZWx9XG4gICAgICAgICAgICBhbGlnbm1lbnQ9e0FsaWdubWVudC5Ub3B9XG4gICAgICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgID5cbiAgICAgICAgICAgIHsgY2hpbGRyZW4gfVxuICAgICAgICA8L0FjY2Vzc2libGVUb29sdGlwQnV0dG9uPlxuICAgICk7XG59O1xuXG5pbnRlcmZhY2UgSURyb3Bkb3duQnV0dG9uUHJvcHMgZXh0ZW5kcyBJQnV0dG9uUHJvcHMge1xuICAgIGRldmljZUtpbmRzOiBNZWRpYURldmljZUtpbmRFbnVtW107XG59XG5cbmNvbnN0IExlZ2FjeUNhbGxWaWV3RHJvcGRvd25CdXR0b246IFJlYWN0LkZDPElEcm9wZG93bkJ1dHRvblByb3BzPiA9ICh7IHN0YXRlLCBkZXZpY2VLaW5kcywgLi4ucHJvcHMgfSkgPT4ge1xuICAgIGNvbnN0IFttZW51RGlzcGxheWVkLCBidXR0b25SZWYsIG9wZW5NZW51LCBjbG9zZU1lbnVdID0gdXNlQ29udGV4dE1lbnUoKTtcbiAgICBjb25zdCBbaG92ZXJpbmdEcm9wZG93biwgc2V0SG92ZXJpbmdEcm9wZG93bl0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcyhcIm14X0xlZ2FjeUNhbGxWaWV3QnV0dG9uc19idXR0b25cIiwgXCJteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfZHJvcGRvd25CdXR0b25cIiwge1xuICAgICAgICBteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfZHJvcGRvd25CdXR0b25fY29sbGFwc2VkOiAhbWVudURpc3BsYXllZCxcbiAgICB9KTtcblxuICAgIGNvbnN0IG9uQ2xpY2sgPSAoZXZlbnQ6IFJlYWN0Lk1vdXNlRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIG9wZW5NZW51KCk7XG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICAgIDxMZWdhY3lDYWxsVmlld1RvZ2dsZUJ1dHRvbiBpbnB1dFJlZj17YnV0dG9uUmVmfSBmb3JjZUhpZGU9e21lbnVEaXNwbGF5ZWQgfHwgaG92ZXJpbmdEcm9wZG93bn0gc3RhdGU9e3N0YXRlfSB7Li4ucHJvcHN9PlxuICAgICAgICAgICAgPExlZ2FjeUNhbGxWaWV3VG9nZ2xlQnV0dG9uXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e29uQ2xpY2t9XG4gICAgICAgICAgICAgICAgb25Ib3Zlcj17KGhvdmVyaW5nKSA9PiBzZXRIb3ZlcmluZ0Ryb3Bkb3duKGhvdmVyaW5nKX1cbiAgICAgICAgICAgICAgICBzdGF0ZT17c3RhdGV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgeyBtZW51RGlzcGxheWVkICYmIDxEZXZpY2VDb250ZXh0TWVudVxuICAgICAgICAgICAgICAgIHsuLi5hbHdheXNBYm92ZVJpZ2h0T2YoYnV0dG9uUmVmLmN1cnJlbnQ/LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKX1cblxuICAgICAgICAgICAgICAgIG9uRmluaXNoZWQ9e2Nsb3NlTWVudX1cbiAgICAgICAgICAgICAgICBkZXZpY2VLaW5kcz17ZGV2aWNlS2luZHN9XG4gICAgICAgICAgICAvPiB9XG4gICAgICAgIDwvTGVnYWN5Q2FsbFZpZXdUb2dnbGVCdXR0b24+XG4gICAgKTtcbn07XG5cbmludGVyZmFjZSBJUHJvcHMge1xuICAgIGNhbGw6IE1hdHJpeENhbGw7XG4gICAgcGlwTW9kZTogYm9vbGVhbjtcbiAgICBoYW5kbGVyczoge1xuICAgICAgICBvbkhhbmd1cENsaWNrOiAoKSA9PiB2b2lkO1xuICAgICAgICBvblNjcmVlbnNoYXJlQ2xpY2s6ICgpID0+IHZvaWQ7XG4gICAgICAgIG9uVG9nZ2xlU2lkZWJhckNsaWNrOiAoKSA9PiB2b2lkO1xuICAgICAgICBvbk1pY011dGVDbGljazogKCkgPT4gdm9pZDtcbiAgICAgICAgb25WaWRNdXRlQ2xpY2s6ICgpID0+IHZvaWQ7XG4gICAgfTtcbiAgICBidXR0b25zU3RhdGU6IHtcbiAgICAgICAgbWljTXV0ZWQ6IGJvb2xlYW47XG4gICAgICAgIHZpZE11dGVkOiBib29sZWFuO1xuICAgICAgICBzaWRlYmFyU2hvd246IGJvb2xlYW47XG4gICAgICAgIHNjcmVlbnNoYXJpbmc6IGJvb2xlYW47XG4gICAgfTtcbiAgICBidXR0b25zVmlzaWJpbGl0eToge1xuICAgICAgICBzY3JlZW5zaGFyaW5nOiBib29sZWFuO1xuICAgICAgICB2aWRNdXRlOiBib29sZWFuO1xuICAgICAgICBzaWRlYmFyOiBib29sZWFuO1xuICAgICAgICBkaWFscGFkOiBib29sZWFuO1xuICAgICAgICBjb250ZXh0TWVudTogYm9vbGVhbjtcbiAgICB9O1xufVxuXG5pbnRlcmZhY2UgSVN0YXRlIHtcbiAgICB2aXNpYmxlOiBib29sZWFuO1xuICAgIHNob3dEaWFscGFkOiBib29sZWFuO1xuICAgIGhvdmVyaW5nQ29udHJvbHM6IGJvb2xlYW47XG4gICAgc2hvd01vcmVNZW51OiBib29sZWFuO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMZWdhY3lDYWxsVmlld0J1dHRvbnMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SVByb3BzLCBJU3RhdGU+IHtcbiAgICBwcml2YXRlIGRpYWxwYWRCdXR0b24gPSBjcmVhdGVSZWY8SFRNTERpdkVsZW1lbnQ+KCk7XG4gICAgcHJpdmF0ZSBjb250ZXh0TWVudUJ1dHRvbiA9IGNyZWF0ZVJlZjxIVE1MRGl2RWxlbWVudD4oKTtcbiAgICBwcml2YXRlIGNvbnRyb2xzSGlkZVRpbWVyOiBudW1iZXIgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHM6IElQcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHNob3dEaWFscGFkOiBmYWxzZSxcbiAgICAgICAgICAgIGhvdmVyaW5nQ29udHJvbHM6IGZhbHNlLFxuICAgICAgICAgICAgc2hvd01vcmVNZW51OiBmYWxzZSxcbiAgICAgICAgICAgIHZpc2libGU6IHRydWUsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGNvbXBvbmVudERpZE1vdW50KCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNob3dDb250cm9scygpO1xuICAgIH1cblxuICAgIHB1YmxpYyBzaG93Q29udHJvbHMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLnNob3dNb3JlTWVudSB8fCB0aGlzLnN0YXRlLnNob3dEaWFscGFkKSByZXR1cm47XG5cbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHZpc2libGU6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jb250cm9sc0hpZGVUaW1lciAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuY29udHJvbHNIaWRlVGltZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udHJvbHNIaWRlVGltZXIgPSB3aW5kb3cuc2V0VGltZW91dCh0aGlzLm9uQ29udHJvbHNIaWRlVGltZXIsIENPTlRST0xTX0hJREVfREVMQVkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25Db250cm9sc0hpZGVUaW1lciA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaG92ZXJpbmdDb250cm9scyB8fCB0aGlzLnN0YXRlLnNob3dEaWFscGFkIHx8IHRoaXMuc3RhdGUuc2hvd01vcmVNZW51KSByZXR1cm47XG4gICAgICAgIHRoaXMuY29udHJvbHNIaWRlVGltZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdmlzaWJsZTogZmFsc2UgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25Nb3VzZUVudGVyID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgaG92ZXJpbmdDb250cm9sczogdHJ1ZSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbk1vdXNlTGVhdmUgPSAoKTogdm9pZCA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBob3ZlcmluZ0NvbnRyb2xzOiBmYWxzZSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkRpYWxwYWRDbGljayA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnNob3dEaWFscGFkKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2hvd0RpYWxwYWQ6IHRydWUgfSk7XG4gICAgICAgICAgICB0aGlzLnNob3dDb250cm9scygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dEaWFscGFkOiBmYWxzZSB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcml2YXRlIG9uTW9yZUNsaWNrID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2hvd01vcmVNZW51OiB0cnVlIH0pO1xuICAgICAgICB0aGlzLnNob3dDb250cm9scygpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNsb3NlRGlhbHBhZCA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNob3dEaWFscGFkOiBmYWxzZSB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjbG9zZUNvbnRleHRNZW51ID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2hvd01vcmVNZW51OiBmYWxzZSB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIHJlbmRlcigpOiBKU1guRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGNhbGxDb250cm9sc0NsYXNzZXMgPSBjbGFzc05hbWVzKFwibXhfTGVnYWN5Q2FsbFZpZXdCdXR0b25zXCIsIHtcbiAgICAgICAgICAgIG14X0xlZ2FjeUNhbGxWaWV3QnV0dG9uc19oaWRkZW46ICF0aGlzLnN0YXRlLnZpc2libGUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBkaWFsUGFkO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5zaG93RGlhbHBhZCkge1xuICAgICAgICAgICAgZGlhbFBhZCA9IDxEaWFscGFkQ29udGV4dE1lbnVcbiAgICAgICAgICAgICAgICB7Li4uYWx3YXlzQWJvdmVMZWZ0T2YoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlhbHBhZEJ1dHRvbi5jdXJyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICAgICAgICBDaGV2cm9uRmFjZS5Ob25lLFxuICAgICAgICAgICAgICAgICAgICBDT05URVhUX01FTlVfVlBBRERJTkcsXG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAvLyBXZSBtb3VudCB0aGUgY29udGV4dCBtZW51cyBhcyBhIGFzIGEgY2hpbGQgdHlwaWNhbGx5IGluIG9yZGVyIHRvIGluY2x1ZGUgdGhlXG4gICAgICAgICAgICAgICAgLy8gY29udGV4dCBtZW51cyB3aGVuIGZ1bGxzY3JlZW5pbmcgdGhlIGNhbGwgY29udGVudC5cbiAgICAgICAgICAgICAgICAvLyBIb3dldmVyLCB0aGlzIGRvZXMgbm90IHdvcmsgYXMgd2VsbCB3aGVuIHRoZSBjYWxsIGlzIGVtYmVkZGVkIGluIGFcbiAgICAgICAgICAgICAgICAvLyBwaWN0dXJlLWluLXBpY3R1cmUgZnJhbWUuIFRodXMsIG9ubHkgbW91bnQgYXMgY2hpbGQgd2hlbiB3ZSBhcmUgKm5vdCogaW4gUGlQLlxuICAgICAgICAgICAgICAgIG1vdW50QXNDaGlsZD17IXRoaXMucHJvcHMucGlwTW9kZX1cbiAgICAgICAgICAgICAgICBvbkZpbmlzaGVkPXt0aGlzLmNsb3NlRGlhbHBhZH1cbiAgICAgICAgICAgICAgICBjYWxsPXt0aGlzLnByb3BzLmNhbGx9XG4gICAgICAgICAgICAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjb250ZXh0TWVudTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2hvd01vcmVNZW51KSB7XG4gICAgICAgICAgICBjb250ZXh0TWVudSA9IDxMZWdhY3lDYWxsQ29udGV4dE1lbnVcbiAgICAgICAgICAgICAgICB7Li4uYWx3YXlzQWJvdmVMZWZ0T2YoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dE1lbnVCdXR0b24uY3VycmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICAgICAgICAgICAgQ2hldnJvbkZhY2UuTm9uZSxcbiAgICAgICAgICAgICAgICAgICAgQ09OVEVYVF9NRU5VX1ZQQURESU5HLFxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgbW91bnRBc0NoaWxkPXshdGhpcy5wcm9wcy5waXBNb2RlfVxuICAgICAgICAgICAgICAgIG9uRmluaXNoZWQ9e3RoaXMuY2xvc2VDb250ZXh0TWVudX1cbiAgICAgICAgICAgICAgICBjYWxsPXt0aGlzLnByb3BzLmNhbGx9XG4gICAgICAgICAgICAvPjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjYWxsQ29udHJvbHNDbGFzc2VzfVxuICAgICAgICAgICAgICAgIG9uTW91c2VFbnRlcj17dGhpcy5vbk1vdXNlRW50ZXJ9XG4gICAgICAgICAgICAgICAgb25Nb3VzZUxlYXZlPXt0aGlzLm9uTW91c2VMZWF2ZX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7IGRpYWxQYWQgfVxuICAgICAgICAgICAgICAgIHsgY29udGV4dE1lbnUgfVxuXG4gICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLmJ1dHRvbnNWaXNpYmlsaXR5LmRpYWxwYWQgJiYgPENvbnRleHRNZW51VG9vbHRpcEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfYnV0dG9uIG14X0xlZ2FjeUNhbGxWaWV3QnV0dG9uc19kaWFscGFkXCJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRSZWY9e3RoaXMuZGlhbHBhZEJ1dHRvbn1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbkRpYWxwYWRDbGlja31cbiAgICAgICAgICAgICAgICAgICAgaXNFeHBhbmRlZD17dGhpcy5zdGF0ZS5zaG93RGlhbHBhZH1cbiAgICAgICAgICAgICAgICAgICAgdGl0bGU9e190KFwiRGlhbHBhZFwiKX1cbiAgICAgICAgICAgICAgICAgICAgYWxpZ25tZW50PXtBbGlnbm1lbnQuVG9wfVxuICAgICAgICAgICAgICAgIC8+IH1cbiAgICAgICAgICAgICAgICA8TGVnYWN5Q2FsbFZpZXdEcm9wZG93bkJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZT17IXRoaXMucHJvcHMuYnV0dG9uc1N0YXRlLm1pY011dGVkfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfYnV0dG9uX21pY1wiXG4gICAgICAgICAgICAgICAgICAgIG9uTGFiZWw9e190KFwiTXV0ZSB0aGUgbWljcm9waG9uZVwiKX1cbiAgICAgICAgICAgICAgICAgICAgb2ZmTGFiZWw9e190KFwiVW5tdXRlIHRoZSBtaWNyb3Bob25lXCIpfVxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLmhhbmRsZXJzLm9uTWljTXV0ZUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICBkZXZpY2VLaW5kcz17W01lZGlhRGV2aWNlS2luZEVudW0uQXVkaW9JbnB1dCwgTWVkaWFEZXZpY2VLaW5kRW51bS5BdWRpb091dHB1dF19XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICB7IHRoaXMucHJvcHMuYnV0dG9uc1Zpc2liaWxpdHkudmlkTXV0ZSAmJiA8TGVnYWN5Q2FsbFZpZXdEcm9wZG93bkJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZT17IXRoaXMucHJvcHMuYnV0dG9uc1N0YXRlLnZpZE11dGVkfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfYnV0dG9uX3ZpZFwiXG4gICAgICAgICAgICAgICAgICAgIG9uTGFiZWw9e190KFwiU3RvcCB0aGUgY2FtZXJhXCIpfVxuICAgICAgICAgICAgICAgICAgICBvZmZMYWJlbD17X3QoXCJTdGFydCB0aGUgY2FtZXJhXCIpfVxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLmhhbmRsZXJzLm9uVmlkTXV0ZUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICBkZXZpY2VLaW5kcz17W01lZGlhRGV2aWNlS2luZEVudW0uVmlkZW9JbnB1dF19XG4gICAgICAgICAgICAgICAgLz4gfVxuICAgICAgICAgICAgICAgIHsgdGhpcy5wcm9wcy5idXR0b25zVmlzaWJpbGl0eS5zY3JlZW5zaGFyaW5nICYmIDxMZWdhY3lDYWxsVmlld1RvZ2dsZUJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBzdGF0ZT17dGhpcy5wcm9wcy5idXR0b25zU3RhdGUuc2NyZWVuc2hhcmluZ31cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTGVnYWN5Q2FsbFZpZXdCdXR0b25zX2J1dHRvbl9zY3JlZW5zaGFyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgb25MYWJlbD17X3QoXCJTdG9wIHNoYXJpbmcgeW91ciBzY3JlZW5cIil9XG4gICAgICAgICAgICAgICAgICAgIG9mZkxhYmVsPXtfdChcIlN0YXJ0IHNoYXJpbmcgeW91ciBzY3JlZW5cIil9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMucHJvcHMuaGFuZGxlcnMub25TY3JlZW5zaGFyZUNsaWNrfVxuICAgICAgICAgICAgICAgIC8+IH1cbiAgICAgICAgICAgICAgICB7IHRoaXMucHJvcHMuYnV0dG9uc1Zpc2liaWxpdHkuc2lkZWJhciAmJiA8TGVnYWN5Q2FsbFZpZXdUb2dnbGVCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgc3RhdGU9e3RoaXMucHJvcHMuYnV0dG9uc1N0YXRlLnNpZGViYXJTaG93bn1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTGVnYWN5Q2FsbFZpZXdCdXR0b25zX2J1dHRvbl9zaWRlYmFyXCJcbiAgICAgICAgICAgICAgICAgICAgb25MYWJlbD17X3QoXCJIaWRlIHNpZGViYXJcIil9XG4gICAgICAgICAgICAgICAgICAgIG9mZkxhYmVsPXtfdChcIlNob3cgc2lkZWJhclwiKX1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5oYW5kbGVycy5vblRvZ2dsZVNpZGViYXJDbGlja31cbiAgICAgICAgICAgICAgICAvPiB9XG4gICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLmJ1dHRvbnNWaXNpYmlsaXR5LmNvbnRleHRNZW51ICYmIDxDb250ZXh0TWVudVRvb2x0aXBCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTGVnYWN5Q2FsbFZpZXdCdXR0b25zX2J1dHRvbiBteF9MZWdhY3lDYWxsVmlld0J1dHRvbnNfYnV0dG9uX21vcmVcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLm9uTW9yZUNsaWNrfVxuICAgICAgICAgICAgICAgICAgICBpbnB1dFJlZj17dGhpcy5jb250ZXh0TWVudUJ1dHRvbn1cbiAgICAgICAgICAgICAgICAgICAgaXNFeHBhbmRlZD17dGhpcy5zdGF0ZS5zaG93TW9yZU1lbnV9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtfdChcIk1vcmVcIil9XG4gICAgICAgICAgICAgICAgICAgIGFsaWdubWVudD17QWxpZ25tZW50LlRvcH1cbiAgICAgICAgICAgICAgICAvPiB9XG4gICAgICAgICAgICAgICAgPEFjY2Vzc2libGVUb29sdGlwQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm14X0xlZ2FjeUNhbGxWaWV3QnV0dG9uc19idXR0b24gbXhfTGVnYWN5Q2FsbFZpZXdCdXR0b25zX2J1dHRvbl9oYW5ndXBcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLmhhbmRsZXJzLm9uSGFuZ3VwQ2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXtfdChcIkhhbmd1cFwiKX1cbiAgICAgICAgICAgICAgICAgICAgYWxpZ25tZW50PXtBbGlnbm1lbnQuVG9wfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQWtCQTs7QUFDQTs7QUFHQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFPQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7O0FBRUE7QUFDQTtBQUNBLE1BQU1BLHFCQUFxQixH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