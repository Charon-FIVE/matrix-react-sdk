"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _VerificationRequest = require("matrix-js-sdk/src/crypto/verification/request/VerificationRequest");

var _event = require("matrix-js-sdk/src/@types/event");

var _crypto = require("matrix-js-sdk/src/crypto");

var _MatrixClientPeg = require("../../../MatrixClientPeg");

var _languageHandler = require("../../../languageHandler");

var _KeyVerificationStateObserver = require("../../../utils/KeyVerificationStateObserver");

var _EventTileBubble = _interopRequireDefault(require("./EventTileBubble"));

/*
Copyright 2019, 2020 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class MKeyVerificationConclusion extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "onRequestChanged", () => {
      this.forceUpdate();
    });
    (0, _defineProperty2.default)(this, "onTrustChanged", userId => {
      const {
        mxEvent
      } = this.props;
      const request = mxEvent.verificationRequest;

      if (!request || request.otherUserId !== userId) {
        return;
      }

      this.forceUpdate();
    });
  }

  componentDidMount() {
    const request = this.props.mxEvent.verificationRequest;

    if (request) {
      request.on(_VerificationRequest.VerificationRequestEvent.Change, this.onRequestChanged);
    }

    _MatrixClientPeg.MatrixClientPeg.get().on(_crypto.CryptoEvent.UserTrustStatusChanged, this.onTrustChanged);
  }

  componentWillUnmount() {
    const request = this.props.mxEvent.verificationRequest;

    if (request) {
      request.off(_VerificationRequest.VerificationRequestEvent.Change, this.onRequestChanged);
    }

    const cli = _MatrixClientPeg.MatrixClientPeg.get();

    if (cli) {
      cli.removeListener(_crypto.CryptoEvent.UserTrustStatusChanged, this.onTrustChanged);
    }
  }

  static shouldRender(mxEvent, request) {
    // normally should not happen
    if (!request) {
      return false;
    } // .cancel event that was sent after the verification finished, ignore


    if (mxEvent.getType() === _event.EventType.KeyVerificationCancel && !request.cancelled) {
      return false;
    } // .done event that was sent after the verification cancelled, ignore


    if (mxEvent.getType() === _event.EventType.KeyVerificationDone && !request.done) {
      return false;
    } // request hasn't concluded yet


    if (request.pending) {
      return false;
    } // User isn't actually verified


    if (!_MatrixClientPeg.MatrixClientPeg.get().checkUserTrust(request.otherUserId).isCrossSigningVerified()) {
      return false;
    }

    return true;
  }

  render() {
    const {
      mxEvent
    } = this.props;
    const request = mxEvent.verificationRequest;

    if (!MKeyVerificationConclusion.shouldRender(mxEvent, request)) {
      return null;
    }

    const client = _MatrixClientPeg.MatrixClientPeg.get();

    const myUserId = client.getUserId();
    let title;

    if (request.done) {
      title = (0, _languageHandler._t)("You verified %(name)s", {
        name: (0, _KeyVerificationStateObserver.getNameForEventRoom)(request.otherUserId, mxEvent.getRoomId())
      });
    } else if (request.cancelled) {
      const userId = request.cancellingUserId;

      if (userId === myUserId) {
        title = (0, _languageHandler._t)("You cancelled verifying %(name)s", {
          name: (0, _KeyVerificationStateObserver.getNameForEventRoom)(request.otherUserId, mxEvent.getRoomId())
        });
      } else {
        title = (0, _languageHandler._t)("%(name)s cancelled verifying", {
          name: (0, _KeyVerificationStateObserver.getNameForEventRoom)(userId, mxEvent.getRoomId())
        });
      }
    }

    if (title) {
      const classes = (0, _classnames.default)("mx_cryptoEvent mx_cryptoEvent_icon", {
        mx_cryptoEvent_icon_verified: request.done
      });
      return /*#__PURE__*/_react.default.createElement(_EventTileBubble.default, {
        className: classes,
        title: title,
        subtitle: (0, _KeyVerificationStateObserver.userLabelForEventRoom)(request.otherUserId, mxEvent.getRoomId()),
        timestamp: this.props.timestamp
      });
    }

    return null;
  }

}

exports.default = MKeyVerificationConclusion;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNS2V5VmVyaWZpY2F0aW9uQ29uY2x1c2lvbiIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsImZvcmNlVXBkYXRlIiwidXNlcklkIiwibXhFdmVudCIsInJlcXVlc3QiLCJ2ZXJpZmljYXRpb25SZXF1ZXN0Iiwib3RoZXJVc2VySWQiLCJjb21wb25lbnREaWRNb3VudCIsIm9uIiwiVmVyaWZpY2F0aW9uUmVxdWVzdEV2ZW50IiwiQ2hhbmdlIiwib25SZXF1ZXN0Q2hhbmdlZCIsIk1hdHJpeENsaWVudFBlZyIsImdldCIsIkNyeXB0b0V2ZW50IiwiVXNlclRydXN0U3RhdHVzQ2hhbmdlZCIsIm9uVHJ1c3RDaGFuZ2VkIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJvZmYiLCJjbGkiLCJyZW1vdmVMaXN0ZW5lciIsInNob3VsZFJlbmRlciIsImdldFR5cGUiLCJFdmVudFR5cGUiLCJLZXlWZXJpZmljYXRpb25DYW5jZWwiLCJjYW5jZWxsZWQiLCJLZXlWZXJpZmljYXRpb25Eb25lIiwiZG9uZSIsInBlbmRpbmciLCJjaGVja1VzZXJUcnVzdCIsImlzQ3Jvc3NTaWduaW5nVmVyaWZpZWQiLCJyZW5kZXIiLCJjbGllbnQiLCJteVVzZXJJZCIsImdldFVzZXJJZCIsInRpdGxlIiwiX3QiLCJuYW1lIiwiZ2V0TmFtZUZvckV2ZW50Um9vbSIsImdldFJvb21JZCIsImNhbmNlbGxpbmdVc2VySWQiLCJjbGFzc2VzIiwiY2xhc3NOYW1lcyIsIm14X2NyeXB0b0V2ZW50X2ljb25fdmVyaWZpZWQiLCJ1c2VyTGFiZWxGb3JFdmVudFJvb20iLCJ0aW1lc3RhbXAiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy92aWV3cy9tZXNzYWdlcy9NS2V5VmVyaWZpY2F0aW9uQ29uY2x1c2lvbi50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE5LCAyMDIwIFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHsgTWF0cml4RXZlbnQgfSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvbW9kZWxzL2V2ZW50XCI7XG5pbXBvcnQge1xuICAgIFZlcmlmaWNhdGlvblJlcXVlc3QsXG4gICAgVmVyaWZpY2F0aW9uUmVxdWVzdEV2ZW50LFxufSBmcm9tIFwibWF0cml4LWpzLXNkay9zcmMvY3J5cHRvL3ZlcmlmaWNhdGlvbi9yZXF1ZXN0L1ZlcmlmaWNhdGlvblJlcXVlc3RcIjtcbmltcG9ydCB7IEV2ZW50VHlwZSB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9AdHlwZXMvZXZlbnRcIjtcbmltcG9ydCB7IENyeXB0b0V2ZW50IH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL2NyeXB0b1wiO1xuXG5pbXBvcnQgeyBNYXRyaXhDbGllbnRQZWcgfSBmcm9tICcuLi8uLi8uLi9NYXRyaXhDbGllbnRQZWcnO1xuaW1wb3J0IHsgX3QgfSBmcm9tICcuLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXInO1xuaW1wb3J0IHsgZ2V0TmFtZUZvckV2ZW50Um9vbSwgdXNlckxhYmVsRm9yRXZlbnRSb29tIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvS2V5VmVyaWZpY2F0aW9uU3RhdGVPYnNlcnZlcic7XG5pbXBvcnQgRXZlbnRUaWxlQnViYmxlIGZyb20gXCIuL0V2ZW50VGlsZUJ1YmJsZVwiO1xuXG5pbnRlcmZhY2UgSVByb3BzIHtcbiAgICAvKiB0aGUgTWF0cml4RXZlbnQgdG8gc2hvdyAqL1xuICAgIG14RXZlbnQ6IE1hdHJpeEV2ZW50O1xuICAgIHRpbWVzdGFtcD86IEpTWC5FbGVtZW50O1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNS2V5VmVyaWZpY2F0aW9uQ29uY2x1c2lvbiBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHM+IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogSVByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29tcG9uZW50RGlkTW91bnQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLnByb3BzLm14RXZlbnQudmVyaWZpY2F0aW9uUmVxdWVzdDtcbiAgICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgICAgIHJlcXVlc3Qub24oVmVyaWZpY2F0aW9uUmVxdWVzdEV2ZW50LkNoYW5nZSwgdGhpcy5vblJlcXVlc3RDaGFuZ2VkKTtcbiAgICAgICAgfVxuICAgICAgICBNYXRyaXhDbGllbnRQZWcuZ2V0KCkub24oQ3J5cHRvRXZlbnQuVXNlclRydXN0U3RhdHVzQ2hhbmdlZCwgdGhpcy5vblRydXN0Q2hhbmdlZCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNvbXBvbmVudFdpbGxVbm1vdW50KCk6IHZvaWQge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5wcm9wcy5teEV2ZW50LnZlcmlmaWNhdGlvblJlcXVlc3Q7XG4gICAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgICAgICByZXF1ZXN0Lm9mZihWZXJpZmljYXRpb25SZXF1ZXN0RXZlbnQuQ2hhbmdlLCB0aGlzLm9uUmVxdWVzdENoYW5nZWQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNsaSA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgaWYgKGNsaSkge1xuICAgICAgICAgICAgY2xpLnJlbW92ZUxpc3RlbmVyKENyeXB0b0V2ZW50LlVzZXJUcnVzdFN0YXR1c0NoYW5nZWQsIHRoaXMub25UcnVzdENoYW5nZWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblJlcXVlc3RDaGFuZ2VkID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgb25UcnVzdENoYW5nZWQgPSAodXNlcklkOiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgICAgICAgY29uc3QgeyBteEV2ZW50IH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbXhFdmVudC52ZXJpZmljYXRpb25SZXF1ZXN0O1xuICAgICAgICBpZiAoIXJlcXVlc3QgfHwgcmVxdWVzdC5vdGhlclVzZXJJZCAhPT0gdXNlcklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIHNob3VsZFJlbmRlcihteEV2ZW50OiBNYXRyaXhFdmVudCwgcmVxdWVzdDogVmVyaWZpY2F0aW9uUmVxdWVzdCk6IGJvb2xlYW4ge1xuICAgICAgICAvLyBub3JtYWxseSBzaG91bGQgbm90IGhhcHBlblxuICAgICAgICBpZiAoIXJlcXVlc3QpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyAuY2FuY2VsIGV2ZW50IHRoYXQgd2FzIHNlbnQgYWZ0ZXIgdGhlIHZlcmlmaWNhdGlvbiBmaW5pc2hlZCwgaWdub3JlXG4gICAgICAgIGlmIChteEV2ZW50LmdldFR5cGUoKSA9PT0gRXZlbnRUeXBlLktleVZlcmlmaWNhdGlvbkNhbmNlbCAmJiAhcmVxdWVzdC5jYW5jZWxsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyAuZG9uZSBldmVudCB0aGF0IHdhcyBzZW50IGFmdGVyIHRoZSB2ZXJpZmljYXRpb24gY2FuY2VsbGVkLCBpZ25vcmVcbiAgICAgICAgaWYgKG14RXZlbnQuZ2V0VHlwZSgpID09PSBFdmVudFR5cGUuS2V5VmVyaWZpY2F0aW9uRG9uZSAmJiAhcmVxdWVzdC5kb25lKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZXF1ZXN0IGhhc24ndCBjb25jbHVkZWQgeWV0XG4gICAgICAgIGlmIChyZXF1ZXN0LnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVzZXIgaXNuJ3QgYWN0dWFsbHkgdmVyaWZpZWRcbiAgICAgICAgaWYgKCFNYXRyaXhDbGllbnRQZWcuZ2V0KCkuY2hlY2tVc2VyVHJ1c3QocmVxdWVzdC5vdGhlclVzZXJJZCkuaXNDcm9zc1NpZ25pbmdWZXJpZmllZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyKCk6IEpTWC5FbGVtZW50IHtcbiAgICAgICAgY29uc3QgeyBteEV2ZW50IH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbXhFdmVudC52ZXJpZmljYXRpb25SZXF1ZXN0O1xuXG4gICAgICAgIGlmICghTUtleVZlcmlmaWNhdGlvbkNvbmNsdXNpb24uc2hvdWxkUmVuZGVyKG14RXZlbnQsIHJlcXVlc3QpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNsaWVudCA9IE1hdHJpeENsaWVudFBlZy5nZXQoKTtcbiAgICAgICAgY29uc3QgbXlVc2VySWQgPSBjbGllbnQuZ2V0VXNlcklkKCk7XG5cbiAgICAgICAgbGV0IHRpdGxlO1xuXG4gICAgICAgIGlmIChyZXF1ZXN0LmRvbmUpIHtcbiAgICAgICAgICAgIHRpdGxlID0gX3QoXG4gICAgICAgICAgICAgICAgXCJZb3UgdmVyaWZpZWQgJShuYW1lKXNcIixcbiAgICAgICAgICAgICAgICB7IG5hbWU6IGdldE5hbWVGb3JFdmVudFJvb20ocmVxdWVzdC5vdGhlclVzZXJJZCwgbXhFdmVudC5nZXRSb29tSWQoKSkgfSxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAocmVxdWVzdC5jYW5jZWxsZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcXVlc3QuY2FuY2VsbGluZ1VzZXJJZDtcbiAgICAgICAgICAgIGlmICh1c2VySWQgPT09IG15VXNlcklkKSB7XG4gICAgICAgICAgICAgICAgdGl0bGUgPSBfdChcIllvdSBjYW5jZWxsZWQgdmVyaWZ5aW5nICUobmFtZSlzXCIsXG4gICAgICAgICAgICAgICAgICAgIHsgbmFtZTogZ2V0TmFtZUZvckV2ZW50Um9vbShyZXF1ZXN0Lm90aGVyVXNlcklkLCBteEV2ZW50LmdldFJvb21JZCgpKSB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGl0bGUgPSBfdChcIiUobmFtZSlzIGNhbmNlbGxlZCB2ZXJpZnlpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgeyBuYW1lOiBnZXROYW1lRm9yRXZlbnRSb29tKHVzZXJJZCwgbXhFdmVudC5nZXRSb29tSWQoKSkgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzZXMgPSBjbGFzc05hbWVzKFwibXhfY3J5cHRvRXZlbnQgbXhfY3J5cHRvRXZlbnRfaWNvblwiLCB7XG4gICAgICAgICAgICAgICAgbXhfY3J5cHRvRXZlbnRfaWNvbl92ZXJpZmllZDogcmVxdWVzdC5kb25lLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gPEV2ZW50VGlsZUJ1YmJsZVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlc31cbiAgICAgICAgICAgICAgICB0aXRsZT17dGl0bGV9XG4gICAgICAgICAgICAgICAgc3VidGl0bGU9e3VzZXJMYWJlbEZvckV2ZW50Um9vbShyZXF1ZXN0Lm90aGVyVXNlcklkLCBteEV2ZW50LmdldFJvb21JZCgpKX1cbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA9e3RoaXMucHJvcHMudGltZXN0YW1wfVxuICAgICAgICAgICAgLz47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBZ0JBOztBQUNBOztBQUVBOztBQUlBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQTdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1QmUsTUFBTUEsMEJBQU4sU0FBeUNDLGNBQUEsQ0FBTUMsU0FBL0MsQ0FBaUU7RUFDNUVDLFdBQVcsQ0FBQ0MsS0FBRCxFQUFnQjtJQUN2QixNQUFNQSxLQUFOO0lBRHVCLHdEQXVCQSxNQUFZO01BQ25DLEtBQUtDLFdBQUw7SUFDSCxDQXpCMEI7SUFBQSxzREEyQkRDLE1BQUQsSUFBMEI7TUFDL0MsTUFBTTtR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