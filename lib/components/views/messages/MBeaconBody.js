"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireWildcard(require("react"));

var _matrix = require("matrix-js-sdk/src/matrix");

var _randomstring = require("matrix-js-sdk/src/randomstring");

var _beacon = require("matrix-js-sdk/src/@types/beacon");

var _classnames = _interopRequireDefault(require("classnames"));

var _MatrixClientContext = _interopRequireDefault(require("../../../contexts/MatrixClientContext"));

var _useEventEmitter = require("../../../hooks/useEventEmitter");

var _languageHandler = require("../../../languageHandler");

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _beacon2 = require("../../../utils/beacon");

var _location = require("../../../utils/location");

var _displayStatus = require("../beacon/displayStatus");

var _BeaconStatus = _interopRequireDefault(require("../beacon/BeaconStatus"));

var _OwnBeaconStatus = _interopRequireDefault(require("../beacon/OwnBeaconStatus"));

var _Map = _interopRequireDefault(require("../location/Map"));

var _MapError = require("../location/MapError");

var _MapFallback = _interopRequireDefault(require("../location/MapFallback"));

var _SmartMarker = _interopRequireDefault(require("../location/SmartMarker"));

var _BeaconViewDialog = _interopRequireDefault(require("../beacon/BeaconViewDialog"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/*
Copyright 2022 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const useBeaconState = beaconInfoEvent => {
  const beacon = (0, _beacon2.useBeacon)(beaconInfoEvent);
  const isLive = (0, _useEventEmitter.useEventEmitterState)(beacon, _matrix.BeaconEvent.LivenessChange, () => beacon?.isLive);
  const latestLocationState = (0, _useEventEmitter.useEventEmitterState)(beacon, _matrix.BeaconEvent.LocationUpdate, () => beacon?.latestLocationState);

  if (!beacon) {
    return {};
  } // a beacon's starting timestamp can be in the future
  // (either from small deviations in system clock times, or on purpose from another client)
  // a beacon is only live between its start timestamp and expiry
  // detect when a beacon is waiting to become live
  // and display a loading state


  const waitingToStart = !!beacon && (0, _beacon2.isBeaconWaitingToStart)(beacon);
  const {
    description
  } = beacon.beaconInfo;
  return {
    beacon,
    description,
    isLive,
    waitingToStart,
    latestLocationState
  };
}; // multiple instances of same map might be in document
// eg thread and main timeline, reply
// maplibregl needs a unique id to attach the map instance to


const useUniqueId = eventId => {
  const [id, setId] = (0, _react.useState)(`${eventId}_${(0, _randomstring.randomString)(8)}`);
  (0, _react.useEffect)(() => {
    setId(`${eventId}_${(0, _randomstring.randomString)(8)}`);
  }, [eventId]);
  return id;
}; // remove related beacon locations on beacon redaction


const useHandleBeaconRedaction = (event, getRelationsForEvent, cli) => {
  const onBeforeBeaconInfoRedaction = (0, _react.useCallback)((_event, redactionEvent) => {
    const relations = getRelationsForEvent ? getRelationsForEvent(event.getId(), _matrix.RelationType.Reference, _beacon.M_BEACON.name) : undefined;
    relations?.getRelations()?.forEach(locationEvent => {
      cli.redactEvent(locationEvent.getRoomId(), locationEvent.getId(), undefined, redactionEvent.getContent());
    });
  }, [event, getRelationsForEvent, cli]);
  (0, _react.useEffect)(() => {
    event.addListener(_matrix.MatrixEventEvent.BeforeRedaction, onBeforeBeaconInfoRedaction);
    return () => {
      event.removeListener(_matrix.MatrixEventEvent.BeforeRedaction, onBeforeBeaconInfoRedaction);
    };
  }, [event, onBeforeBeaconInfoRedaction]);
};

const MBeaconBody = /*#__PURE__*/_react.default.forwardRef((_ref, ref) => {
  let {
    mxEvent,
    getRelationsForEvent
  } = _ref;
  const {
    beacon,
    isLive,
    latestLocationState,
    waitingToStart
  } = useBeaconState(mxEvent);
  const mapId = useUniqueId(mxEvent.getId());
  const matrixClient = (0, _react.useContext)(_MatrixClientContext.default);
  const [error, setError] = (0, _react.useState)();
  const isMapDisplayError = error?.message === _location.LocationShareError.MapStyleUrlNotConfigured || error?.message === _location.LocationShareError.MapStyleUrlNotReachable;
  const displayStatus = (0, _displayStatus.getBeaconDisplayStatus)(isLive, latestLocationState, // if we are unable to display maps because it is not configured for the server
  // don't display an error
  isMapDisplayError ? undefined : error, waitingToStart);
  const markerRoomMember = (0, _location.isSelfLocation)(mxEvent.getContent()) ? mxEvent.sender : undefined;
  const isOwnBeacon = beacon?.beaconInfoOwner === matrixClient.getUserId();
  useHandleBeaconRedaction(mxEvent, getRelationsForEvent, matrixClient);

  const onClick = () => {
    if (displayStatus !== _displayStatus.BeaconDisplayStatus.Active) {
      return;
    }

    _Modal.default.createDialog(_BeaconViewDialog.default, {
      roomId: mxEvent.getRoomId(),
      matrixClient,
      initialFocusedBeacon: beacon,
      isMapDisplayError
    }, "mx_BeaconViewDialog_wrapper", false, // isPriority
    true // isStatic
    );
  };

  return /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_MBeaconBody",
    ref: ref
  }, displayStatus === _displayStatus.BeaconDisplayStatus.Active && !isMapDisplayError ? /*#__PURE__*/_react.default.createElement(_Map.default, {
    id: mapId,
    centerGeoUri: latestLocationState.uri,
    onError: setError,
    onClick: onClick,
    className: "mx_MBeaconBody_map"
  }, _ref2 => {
    let {
      map
    } = _ref2;
    return /*#__PURE__*/_react.default.createElement(_SmartMarker.default, {
      map: map,
      id: `${mapId}-marker`,
      geoUri: latestLocationState.uri,
      roomMember: markerRoomMember,
      useMemberColor: true
    });
  }) : isMapDisplayError ? /*#__PURE__*/_react.default.createElement(_MapError.MapError, {
    error: error.message,
    onClick: onClick,
    className: (0, _classnames.default)('mx_MBeaconBody_mapError', // set interactive class when maximised map can be opened
    {
      'mx_MBeaconBody_mapErrorInteractive': displayStatus === _displayStatus.BeaconDisplayStatus.Active
    }),
    isMinimised: true
  }) : /*#__PURE__*/_react.default.createElement(_MapFallback.default, {
    isLoading: displayStatus === _displayStatus.BeaconDisplayStatus.Loading,
    className: "mx_MBeaconBody_map mx_MBeaconBody_mapFallback"
  }), isOwnBeacon ? /*#__PURE__*/_react.default.createElement(_OwnBeaconStatus.default, {
    className: "mx_MBeaconBody_chin",
    beacon: beacon,
    displayStatus: displayStatus,
    withIcon: true
  }) : /*#__PURE__*/_react.default.createElement(_BeaconStatus.default, {
    className: "mx_MBeaconBody_chin",
    beacon: beacon,
    displayStatus: displayStatus,
    label: (0, _languageHandler._t)('View live location'),
    withIcon: true
  }));
});

var _default = MBeaconBody;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ1c2VCZWFjb25TdGF0ZSIsImJlYWNvbkluZm9FdmVudCIsImJlYWNvbiIsInVzZUJlYWNvbiIsImlzTGl2ZSIsInVzZUV2ZW50RW1pdHRlclN0YXRlIiwiQmVhY29uRXZlbnQiLCJMaXZlbmVzc0NoYW5nZSIsImxhdGVzdExvY2F0aW9uU3RhdGUiLCJMb2NhdGlvblVwZGF0ZSIsIndhaXRpbmdUb1N0YXJ0IiwiaXNCZWFjb25XYWl0aW5nVG9TdGFydCIsImRlc2NyaXB0aW9uIiwiYmVhY29uSW5mbyIsInVzZVVuaXF1ZUlkIiwiZXZlbnRJZCIsImlkIiwic2V0SWQiLCJ1c2VTdGF0ZSIsInJhbmRvbVN0cmluZyIsInVzZUVmZmVjdCIsInVzZUhhbmRsZUJlYWNvblJlZGFjdGlvbiIsImV2ZW50IiwiZ2V0UmVsYXRpb25zRm9yRXZlbnQiLCJjbGkiLCJvbkJlZm9yZUJlYWNvbkluZm9SZWRhY3Rpb24iLCJ1c2VDYWxsYmFjayIsIl9ldmVudCIsInJlZGFjdGlvbkV2ZW50IiwicmVsYXRpb25zIiwiZ2V0SWQiLCJSZWxhdGlvblR5cGUiLCJSZWZlcmVuY2UiLCJNX0JFQUNPTiIsIm5hbWUiLCJ1bmRlZmluZWQiLCJnZXRSZWxhdGlvbnMiLCJmb3JFYWNoIiwibG9jYXRpb25FdmVudCIsInJlZGFjdEV2ZW50IiwiZ2V0Um9vbUlkIiwiZ2V0Q29udGVudCIsImFkZExpc3RlbmVyIiwiTWF0cml4RXZlbnRFdmVudCIsIkJlZm9yZVJlZGFjdGlvbiIsInJlbW92ZUxpc3RlbmVyIiwiTUJlYWNvbkJvZHkiLCJSZWFjdCIsImZvcndhcmRSZWYiLCJyZWYiLCJteEV2ZW50IiwibWFwSWQiLCJtYXRyaXhDbGllbnQiLCJ1c2VDb250ZXh0IiwiTWF0cml4Q2xpZW50Q29udGV4dCIsImVycm9yIiwic2V0RXJyb3IiLCJpc01hcERpc3BsYXlFcnJvciIsIm1lc3NhZ2UiLCJMb2NhdGlvblNoYXJlRXJyb3IiLCJNYXBTdHlsZVVybE5vdENvbmZpZ3VyZWQiLCJNYXBTdHlsZVVybE5vdFJlYWNoYWJsZSIsImRpc3BsYXlTdGF0dXMiLCJnZXRCZWFjb25EaXNwbGF5U3RhdHVzIiwibWFya2VyUm9vbU1lbWJlciIsImlzU2VsZkxvY2F0aW9uIiwic2VuZGVyIiwiaXNPd25CZWFjb24iLCJiZWFjb25JbmZvT3duZXIiLCJnZXRVc2VySWQiLCJvbkNsaWNrIiwiQmVhY29uRGlzcGxheVN0YXR1cyIsIkFjdGl2ZSIsIk1vZGFsIiwiY3JlYXRlRGlhbG9nIiwiQmVhY29uVmlld0RpYWxvZyIsInJvb21JZCIsImluaXRpYWxGb2N1c2VkQmVhY29uIiwidXJpIiwibWFwIiwiY2xhc3NOYW1lcyIsIkxvYWRpbmciLCJfdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL21lc3NhZ2VzL01CZWFjb25Cb2R5LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMjIgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2ssIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICAgIEJlYWNvbixcbiAgICBCZWFjb25FdmVudCxcbiAgICBNYXRyaXhFdmVudCxcbiAgICBNYXRyaXhFdmVudEV2ZW50LFxuICAgIE1hdHJpeENsaWVudCxcbiAgICBSZWxhdGlvblR5cGUsXG59IGZyb20gJ21hdHJpeC1qcy1zZGsvc3JjL21hdHJpeCc7XG5pbXBvcnQgeyBCZWFjb25Mb2NhdGlvblN0YXRlIH0gZnJvbSAnbWF0cml4LWpzLXNkay9zcmMvY29udGVudC1oZWxwZXJzJztcbmltcG9ydCB7IHJhbmRvbVN0cmluZyB9IGZyb20gJ21hdHJpeC1qcy1zZGsvc3JjL3JhbmRvbXN0cmluZyc7XG5pbXBvcnQgeyBNX0JFQUNPTiB9IGZyb20gJ21hdHJpeC1qcy1zZGsvc3JjL0B0eXBlcy9iZWFjb24nO1xuaW1wb3J0IGNsYXNzTmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5cbmltcG9ydCBNYXRyaXhDbGllbnRDb250ZXh0IGZyb20gJy4uLy4uLy4uL2NvbnRleHRzL01hdHJpeENsaWVudENvbnRleHQnO1xuaW1wb3J0IHsgdXNlRXZlbnRFbWl0dGVyU3RhdGUgfSBmcm9tICcuLi8uLi8uLi9ob29rcy91c2VFdmVudEVtaXR0ZXInO1xuaW1wb3J0IHsgX3QgfSBmcm9tICcuLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXInO1xuaW1wb3J0IE1vZGFsIGZyb20gJy4uLy4uLy4uL01vZGFsJztcbmltcG9ydCB7IGlzQmVhY29uV2FpdGluZ1RvU3RhcnQsIHVzZUJlYWNvbiB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2JlYWNvbic7XG5pbXBvcnQgeyBpc1NlbGZMb2NhdGlvbiwgTG9jYXRpb25TaGFyZUVycm9yIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvbG9jYXRpb24nO1xuaW1wb3J0IHsgQmVhY29uRGlzcGxheVN0YXR1cywgZ2V0QmVhY29uRGlzcGxheVN0YXR1cyB9IGZyb20gJy4uL2JlYWNvbi9kaXNwbGF5U3RhdHVzJztcbmltcG9ydCBCZWFjb25TdGF0dXMgZnJvbSAnLi4vYmVhY29uL0JlYWNvblN0YXR1cyc7XG5pbXBvcnQgT3duQmVhY29uU3RhdHVzIGZyb20gJy4uL2JlYWNvbi9Pd25CZWFjb25TdGF0dXMnO1xuaW1wb3J0IE1hcCBmcm9tICcuLi9sb2NhdGlvbi9NYXAnO1xuaW1wb3J0IHsgTWFwRXJyb3IgfSBmcm9tICcuLi9sb2NhdGlvbi9NYXBFcnJvcic7XG5pbXBvcnQgTWFwRmFsbGJhY2sgZnJvbSAnLi4vbG9jYXRpb24vTWFwRmFsbGJhY2snO1xuaW1wb3J0IFNtYXJ0TWFya2VyIGZyb20gJy4uL2xvY2F0aW9uL1NtYXJ0TWFya2VyJztcbmltcG9ydCB7IEdldFJlbGF0aW9uc0ZvckV2ZW50IH0gZnJvbSAnLi4vcm9vbXMvRXZlbnRUaWxlJztcbmltcG9ydCBCZWFjb25WaWV3RGlhbG9nIGZyb20gJy4uL2JlYWNvbi9CZWFjb25WaWV3RGlhbG9nJztcbmltcG9ydCB7IElCb2R5UHJvcHMgfSBmcm9tIFwiLi9JQm9keVByb3BzXCI7XG5cbmNvbnN0IHVzZUJlYWNvblN0YXRlID0gKGJlYWNvbkluZm9FdmVudDogTWF0cml4RXZlbnQpOiB7XG4gICAgYmVhY29uPzogQmVhY29uO1xuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICAgIGxhdGVzdExvY2F0aW9uU3RhdGU/OiBCZWFjb25Mb2NhdGlvblN0YXRlO1xuICAgIGlzTGl2ZT86IGJvb2xlYW47XG4gICAgd2FpdGluZ1RvU3RhcnQ/OiBib29sZWFuO1xufSA9PiB7XG4gICAgY29uc3QgYmVhY29uID0gdXNlQmVhY29uKGJlYWNvbkluZm9FdmVudCk7XG5cbiAgICBjb25zdCBpc0xpdmUgPSB1c2VFdmVudEVtaXR0ZXJTdGF0ZShcbiAgICAgICAgYmVhY29uLFxuICAgICAgICBCZWFjb25FdmVudC5MaXZlbmVzc0NoYW5nZSxcbiAgICAgICAgKCkgPT4gYmVhY29uPy5pc0xpdmUpO1xuXG4gICAgY29uc3QgbGF0ZXN0TG9jYXRpb25TdGF0ZSA9IHVzZUV2ZW50RW1pdHRlclN0YXRlKFxuICAgICAgICBiZWFjb24sXG4gICAgICAgIEJlYWNvbkV2ZW50LkxvY2F0aW9uVXBkYXRlLFxuICAgICAgICAoKSA9PiBiZWFjb24/LmxhdGVzdExvY2F0aW9uU3RhdGUpO1xuXG4gICAgaWYgKCFiZWFjb24pIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIC8vIGEgYmVhY29uJ3Mgc3RhcnRpbmcgdGltZXN0YW1wIGNhbiBiZSBpbiB0aGUgZnV0dXJlXG4gICAgLy8gKGVpdGhlciBmcm9tIHNtYWxsIGRldmlhdGlvbnMgaW4gc3lzdGVtIGNsb2NrIHRpbWVzLCBvciBvbiBwdXJwb3NlIGZyb20gYW5vdGhlciBjbGllbnQpXG4gICAgLy8gYSBiZWFjb24gaXMgb25seSBsaXZlIGJldHdlZW4gaXRzIHN0YXJ0IHRpbWVzdGFtcCBhbmQgZXhwaXJ5XG4gICAgLy8gZGV0ZWN0IHdoZW4gYSBiZWFjb24gaXMgd2FpdGluZyB0byBiZWNvbWUgbGl2ZVxuICAgIC8vIGFuZCBkaXNwbGF5IGEgbG9hZGluZyBzdGF0ZVxuICAgIGNvbnN0IHdhaXRpbmdUb1N0YXJ0ID0gISFiZWFjb24gJiYgaXNCZWFjb25XYWl0aW5nVG9TdGFydChiZWFjb24pO1xuICAgIGNvbnN0IHsgZGVzY3JpcHRpb24gfSA9IGJlYWNvbi5iZWFjb25JbmZvO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYmVhY29uLFxuICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgaXNMaXZlLFxuICAgICAgICB3YWl0aW5nVG9TdGFydCxcbiAgICAgICAgbGF0ZXN0TG9jYXRpb25TdGF0ZSxcbiAgICB9O1xufTtcblxuLy8gbXVsdGlwbGUgaW5zdGFuY2VzIG9mIHNhbWUgbWFwIG1pZ2h0IGJlIGluIGRvY3VtZW50XG4vLyBlZyB0aHJlYWQgYW5kIG1haW4gdGltZWxpbmUsIHJlcGx5XG4vLyBtYXBsaWJyZWdsIG5lZWRzIGEgdW5pcXVlIGlkIHRvIGF0dGFjaCB0aGUgbWFwIGluc3RhbmNlIHRvXG5jb25zdCB1c2VVbmlxdWVJZCA9IChldmVudElkOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIGNvbnN0IFtpZCwgc2V0SWRdID0gdXNlU3RhdGUoYCR7ZXZlbnRJZH1fJHtyYW5kb21TdHJpbmcoOCl9YCk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBzZXRJZChgJHtldmVudElkfV8ke3JhbmRvbVN0cmluZyg4KX1gKTtcbiAgICB9LCBbZXZlbnRJZF0pO1xuXG4gICAgcmV0dXJuIGlkO1xufTtcblxuLy8gcmVtb3ZlIHJlbGF0ZWQgYmVhY29uIGxvY2F0aW9ucyBvbiBiZWFjb24gcmVkYWN0aW9uXG5jb25zdCB1c2VIYW5kbGVCZWFjb25SZWRhY3Rpb24gPSAoXG4gICAgZXZlbnQ6IE1hdHJpeEV2ZW50LFxuICAgIGdldFJlbGF0aW9uc0ZvckV2ZW50OiBHZXRSZWxhdGlvbnNGb3JFdmVudCxcbiAgICBjbGk6IE1hdHJpeENsaWVudCxcbik6IHZvaWQgPT4ge1xuICAgIGNvbnN0IG9uQmVmb3JlQmVhY29uSW5mb1JlZGFjdGlvbiA9IHVzZUNhbGxiYWNrKChfZXZlbnQ6IE1hdHJpeEV2ZW50LCByZWRhY3Rpb25FdmVudDogTWF0cml4RXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgcmVsYXRpb25zID0gZ2V0UmVsYXRpb25zRm9yRXZlbnQgP1xuICAgICAgICAgICAgZ2V0UmVsYXRpb25zRm9yRXZlbnQoZXZlbnQuZ2V0SWQoKSwgUmVsYXRpb25UeXBlLlJlZmVyZW5jZSwgTV9CRUFDT04ubmFtZSkgOlxuICAgICAgICAgICAgdW5kZWZpbmVkO1xuXG4gICAgICAgIHJlbGF0aW9ucz8uZ2V0UmVsYXRpb25zKCk/LmZvckVhY2gobG9jYXRpb25FdmVudCA9PiB7XG4gICAgICAgICAgICBjbGkucmVkYWN0RXZlbnQoXG4gICAgICAgICAgICAgICAgbG9jYXRpb25FdmVudC5nZXRSb29tSWQoKSxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbkV2ZW50LmdldElkKCksXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHJlZGFjdGlvbkV2ZW50LmdldENvbnRlbnQoKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgIH0sIFtldmVudCwgZ2V0UmVsYXRpb25zRm9yRXZlbnQsIGNsaV0pO1xuXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgZXZlbnQuYWRkTGlzdGVuZXIoTWF0cml4RXZlbnRFdmVudC5CZWZvcmVSZWRhY3Rpb24sIG9uQmVmb3JlQmVhY29uSW5mb1JlZGFjdGlvbik7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBldmVudC5yZW1vdmVMaXN0ZW5lcihNYXRyaXhFdmVudEV2ZW50LkJlZm9yZVJlZGFjdGlvbiwgb25CZWZvcmVCZWFjb25JbmZvUmVkYWN0aW9uKTtcbiAgICAgICAgfTtcbiAgICB9LCBbZXZlbnQsIG9uQmVmb3JlQmVhY29uSW5mb1JlZGFjdGlvbl0pO1xufTtcblxuY29uc3QgTUJlYWNvbkJvZHk6IFJlYWN0LkZDPElCb2R5UHJvcHM+ID0gUmVhY3QuZm9yd2FyZFJlZigoeyBteEV2ZW50LCBnZXRSZWxhdGlvbnNGb3JFdmVudCB9LCByZWYpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICAgIGJlYWNvbixcbiAgICAgICAgaXNMaXZlLFxuICAgICAgICBsYXRlc3RMb2NhdGlvblN0YXRlLFxuICAgICAgICB3YWl0aW5nVG9TdGFydCxcbiAgICB9ID0gdXNlQmVhY29uU3RhdGUobXhFdmVudCk7XG4gICAgY29uc3QgbWFwSWQgPSB1c2VVbmlxdWVJZChteEV2ZW50LmdldElkKCkpO1xuXG4gICAgY29uc3QgbWF0cml4Q2xpZW50ID0gdXNlQ29udGV4dChNYXRyaXhDbGllbnRDb250ZXh0KTtcbiAgICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPEVycm9yPigpO1xuICAgIGNvbnN0IGlzTWFwRGlzcGxheUVycm9yID0gZXJyb3I/Lm1lc3NhZ2UgPT09IExvY2F0aW9uU2hhcmVFcnJvci5NYXBTdHlsZVVybE5vdENvbmZpZ3VyZWQgfHxcbiAgICAgICAgZXJyb3I/Lm1lc3NhZ2UgPT09IExvY2F0aW9uU2hhcmVFcnJvci5NYXBTdHlsZVVybE5vdFJlYWNoYWJsZTtcbiAgICBjb25zdCBkaXNwbGF5U3RhdHVzID0gZ2V0QmVhY29uRGlzcGxheVN0YXR1cyhcbiAgICAgICAgaXNMaXZlLFxuICAgICAgICBsYXRlc3RMb2NhdGlvblN0YXRlLFxuICAgICAgICAvLyBpZiB3ZSBhcmUgdW5hYmxlIHRvIGRpc3BsYXkgbWFwcyBiZWNhdXNlIGl0IGlzIG5vdCBjb25maWd1cmVkIGZvciB0aGUgc2VydmVyXG4gICAgICAgIC8vIGRvbid0IGRpc3BsYXkgYW4gZXJyb3JcbiAgICAgICAgaXNNYXBEaXNwbGF5RXJyb3IgPyB1bmRlZmluZWQgOiBlcnJvcixcbiAgICAgICAgd2FpdGluZ1RvU3RhcnQsXG4gICAgKTtcbiAgICBjb25zdCBtYXJrZXJSb29tTWVtYmVyID0gaXNTZWxmTG9jYXRpb24obXhFdmVudC5nZXRDb250ZW50KCkpID8gbXhFdmVudC5zZW5kZXIgOiB1bmRlZmluZWQ7XG4gICAgY29uc3QgaXNPd25CZWFjb24gPSBiZWFjb24/LmJlYWNvbkluZm9Pd25lciA9PT0gbWF0cml4Q2xpZW50LmdldFVzZXJJZCgpO1xuXG4gICAgdXNlSGFuZGxlQmVhY29uUmVkYWN0aW9uKG14RXZlbnQsIGdldFJlbGF0aW9uc0ZvckV2ZW50LCBtYXRyaXhDbGllbnQpO1xuXG4gICAgY29uc3Qgb25DbGljayA9ICgpID0+IHtcbiAgICAgICAgaWYgKGRpc3BsYXlTdGF0dXMgIT09IEJlYWNvbkRpc3BsYXlTdGF0dXMuQWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgTW9kYWwuY3JlYXRlRGlhbG9nKFxuICAgICAgICAgICAgQmVhY29uVmlld0RpYWxvZyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByb29tSWQ6IG14RXZlbnQuZ2V0Um9vbUlkKCksXG4gICAgICAgICAgICAgICAgbWF0cml4Q2xpZW50LFxuICAgICAgICAgICAgICAgIGluaXRpYWxGb2N1c2VkQmVhY29uOiBiZWFjb24sXG4gICAgICAgICAgICAgICAgaXNNYXBEaXNwbGF5RXJyb3IsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJteF9CZWFjb25WaWV3RGlhbG9nX3dyYXBwZXJcIixcbiAgICAgICAgICAgIGZhbHNlLCAvLyBpc1ByaW9yaXR5XG4gICAgICAgICAgICB0cnVlLCAvLyBpc1N0YXRpY1xuICAgICAgICApO1xuICAgIH07XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8ZGl2XG4gICAgICAgICAgICBjbGFzc05hbWU9J214X01CZWFjb25Cb2R5J1xuICAgICAgICAgICAgcmVmPXtyZWZ9XG4gICAgICAgID5cbiAgICAgICAgICAgIHsgKGRpc3BsYXlTdGF0dXMgPT09IEJlYWNvbkRpc3BsYXlTdGF0dXMuQWN0aXZlICYmICFpc01hcERpc3BsYXlFcnJvcikgP1xuICAgICAgICAgICAgICAgIDxNYXBcbiAgICAgICAgICAgICAgICAgICAgaWQ9e21hcElkfVxuICAgICAgICAgICAgICAgICAgICBjZW50ZXJHZW9Vcmk9e2xhdGVzdExvY2F0aW9uU3RhdGUudXJpfVxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yPXtzZXRFcnJvcn1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17b25DbGlja31cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfTUJlYWNvbkJvZHlfbWFwXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICh7IG1hcCB9KSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTbWFydE1hcmtlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXA9e21hcH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9e2Ake21hcElkfS1tYXJrZXJgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZW9Vcmk9e2xhdGVzdExvY2F0aW9uU3RhdGUudXJpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb29tTWVtYmVyPXttYXJrZXJSb29tTWVtYmVyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VNZW1iZXJDb2xvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA8L01hcD5cbiAgICAgICAgICAgICAgICA6IGlzTWFwRGlzcGxheUVycm9yID9cbiAgICAgICAgICAgICAgICAgICAgPE1hcEVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcj17ZXJyb3IubWVzc2FnZSBhcyBMb2NhdGlvblNoYXJlRXJyb3J9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtvbkNsaWNrfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc05hbWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdteF9NQmVhY29uQm9keV9tYXBFcnJvcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGludGVyYWN0aXZlIGNsYXNzIHdoZW4gbWF4aW1pc2VkIG1hcCBjYW4gYmUgb3BlbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAnbXhfTUJlYWNvbkJvZHlfbWFwRXJyb3JJbnRlcmFjdGl2ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlTdGF0dXMgPT09IEJlYWNvbkRpc3BsYXlTdGF0dXMuQWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgaXNNaW5pbWlzZWRcbiAgICAgICAgICAgICAgICAgICAgLz4gOlxuICAgICAgICAgICAgICAgICAgICA8TWFwRmFsbGJhY2tcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTG9hZGluZz17ZGlzcGxheVN0YXR1cyA9PT0gQmVhY29uRGlzcGxheVN0YXR1cy5Mb2FkaW5nfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdteF9NQmVhY29uQm9keV9tYXAgbXhfTUJlYWNvbkJvZHlfbWFwRmFsbGJhY2snXG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB7IGlzT3duQmVhY29uID9cbiAgICAgICAgICAgICAgICA8T3duQmVhY29uU3RhdHVzXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0nbXhfTUJlYWNvbkJvZHlfY2hpbidcbiAgICAgICAgICAgICAgICAgICAgYmVhY29uPXtiZWFjb259XG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlTdGF0dXM9e2Rpc3BsYXlTdGF0dXN9XG4gICAgICAgICAgICAgICAgICAgIHdpdGhJY29uXG4gICAgICAgICAgICAgICAgLz4gOlxuICAgICAgICAgICAgICAgIDxCZWFjb25TdGF0dXNcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSdteF9NQmVhY29uQm9keV9jaGluJ1xuICAgICAgICAgICAgICAgICAgICBiZWFjb249e2JlYWNvbn1cbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVN0YXR1cz17ZGlzcGxheVN0YXR1c31cbiAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KCdWaWV3IGxpdmUgbG9jYXRpb24nKX1cbiAgICAgICAgICAgICAgICAgICAgd2l0aEljb25cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgfVxuICAgICAgICA8L2Rpdj5cbiAgICApO1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IE1CZWFjb25Cb2R5O1xuXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQWdCQTs7QUFDQTs7QUFTQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7Ozs7O0FBNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWlDQSxNQUFNQSxjQUFjLEdBQUlDLGVBQUQsSUFNbEI7RUFDRCxNQUFNQyxNQUFNLEdBQUcsSUFBQUMsa0JBQUEsRUFBVUYsZUFBVixDQUFmO0VBRUEsTUFBTUcsTUFBTSxHQUFHLElBQUFDLHFDQUFBLEVBQ1hILE1BRFcsRUFFWEksbUJBQUEsQ0FBWUMsY0FGRCxFQUdYLE1BQU1MLE1BQU0sRUFBRUUsTUFISCxDQUFmO0VBS0EsTUFBTUksbUJBQW1CLEdBQUcsSUFBQUgscUNBQUEsRUFDeEJILE1BRHdCLEVBRXhCSSxtQkFBQSxDQUFZRyxjQUZZLEVBR3hCLE1BQU1QLE1BQU0sRUFBRU0sbUJBSFUsQ0FBNUI7O0VBS0EsSUFBSSxDQUFDTixNQUFMLEVBQWE7SUFDVCxPQUFPLEVBQVA7RUFDSCxDQWZBLENBaUJEO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7OztFQUNBLE1BQU1RLGNBQWMsR0FBRyxDQUFDLENBQUNSLE1BQUYsSUFBWSxJQUFBUywrQkFBQSxFQUF1QlQsTUFBdkIsQ0FBbkM7RUFDQSxNQUFNO0lBQUVVO0VBQUYsSUFBa0JWLE1BQU0sQ0FBQ1csVUFBL0I7RUFFQSxPQUFPO0lBQ0hYLE1BREc7SUFFSFUsV0FGRztJQUdIUixNQUhHO0lBSUhNLGNBSkc7SUFLSEY7RUFMRyxDQUFQO0FBT0gsQ0F0Q0QsQyxDQXdDQTtBQUNBO0FBQ0E7OztBQUNBLE1BQU1NLFdBQVcsR0FBSUMsT0FBRCxJQUE2QjtFQUM3QyxNQUFNLENBQUNDLEVBQUQsRUFBS0MsS0FBTCxJQUFjLElBQUFDLGVBQUEsRUFBVSxHQUFFSCxPQUFRLElBQUcsSUFBQUksMEJBQUEsRUFBYSxDQUFiLENBQWdCLEVBQXZDLENBQXBCO0VBRUEsSUFBQUMsZ0JBQUEsRUFBVSxNQUFNO0lBQ1pILEtBQUssQ0FBRSxHQUFFRixPQUFRLElBQUcsSUFBQUksMEJBQUEsRUFBYSxDQUFiLENBQWdCLEVBQS9CLENBQUw7RUFDSCxDQUZELEVBRUcsQ0FBQ0osT0FBRCxDQUZIO0VBSUEsT0FBT0MsRUFBUDtBQUNILENBUkQsQyxDQVVBOzs7QUFDQSxNQUFNSyx3QkFBd0IsR0FBRyxDQUM3QkMsS0FENkIsRUFFN0JDLG9CQUY2QixFQUc3QkMsR0FINkIsS0FJdEI7RUFDUCxNQUFNQywyQkFBMkIsR0FBRyxJQUFBQyxrQkFBQSxFQUFZLENBQUNDLE1BQUQsRUFBc0JDLGNBQXRCLEtBQXNEO0lBQ2xHLE1BQU1DLFNBQVMsR0FBR04sb0JBQW9CLEdBQ2xDQSxvQkFBb0IsQ0FBQ0QsS0FBSyxDQUFDUSxLQUFOLEVBQUQsRUFBZ0JDLG9CQUFBLENBQWFDLFNBQTdCLEVBQXdDQyxnQkFBQSxDQUFTQyxJQUFqRCxDQURjLEdBRWxDQyxTQUZKO0lBSUFOLFNBQVMsRUFBRU8sWUFBWCxJQUEyQkMsT0FBM0IsQ0FBbUNDLGFBQWEsSUFBSTtNQUNoRGQsR0FBRyxDQUFDZSxXQUFKLENBQ0lELGFBQWEsQ0FBQ0UsU0FBZCxFQURKLEVBRUlGLGFBQWEsQ0FBQ1IsS0FBZCxFQUZKLEVBR0lLLFNBSEosRUFJSVAsY0FBYyxDQUFDYSxVQUFmLEVBSko7SUFNSCxDQVBEO0VBUUgsQ0FibUMsRUFhakMsQ0FBQ25CLEtBQUQsRUFBUUMsb0JBQVIsRUFBOEJDLEdBQTlCLENBYmlDLENBQXBDO0VBZUEsSUFBQUosZ0JBQUEsRUFBVSxNQUFNO0lBQ1pFLEtBQUssQ0FBQ29CLFdBQU4sQ0FBa0JDLHdCQUFBLENBQWlCQyxlQUFuQyxFQUFvRG5CLDJCQUFwRDtJQUNBLE9BQU8sTUFBTTtNQUNUSCxLQUFLLENBQUN1QixjQUFOLENBQXFCRix3QkFBQSxDQUFpQkMsZUFBdEMsRUFBdURuQiwyQkFBdkQ7SUFDSCxDQUZEO0VBR0gsQ0FMRCxFQUtHLENBQUNILEtBQUQsRUFBUUcsMkJBQVIsQ0FMSDtBQU1ILENBMUJEOztBQTRCQSxNQUFNcUIsV0FBaUMsZ0JBQUdDLGNBQUEsQ0FBTUMsVUFBTixDQUFpQixPQUFvQ0MsR0FBcEMsS0FBNEM7RUFBQSxJQUEzQztJQUFFQyxPQUFGO0lBQVczQjtFQUFYLENBQTJDO0VBQ25HLE1BQU07SUFDRnJCLE1BREU7SUFFRkUsTUFGRTtJQUdGSSxtQkFIRTtJQUlGRTtFQUpFLElBS0ZWLGNBQWMsQ0FBQ2tELE9BQUQsQ0FMbEI7RUFNQSxNQUFNQyxLQUFLLEdBQUdyQyxXQUFXLENBQUNvQyxPQUFPLENBQUNwQixLQUFSLEVBQUQsQ0FBekI7RUFFQSxNQUFNc0IsWUFBWSxHQUFHLElBQUFDLGlCQUFBLEVBQVdDLDRCQUFYLENBQXJCO0VBQ0EsTUFBTSxDQUFDQyxLQUFELEVBQVFDLFFBQVIsSUFBb0IsSUFBQXRDLGVBQUEsR0FBMUI7RUFDQSxNQUFNdUMsaUJBQWlCLEdBQUdGLEtBQUssRUFBRUcsT0FBUCxLQUFtQkMsNEJBQUEsQ0FBbUJDLHdCQUF0QyxJQUN0QkwsS0FBSyxFQUFFRyxPQUFQLEtBQW1CQyw0QkFBQSxDQUFtQkUsdUJBRDFDO0VBRUEsTUFBTUMsYUFBYSxHQUFHLElBQUFDLHFDQUFBLEVBQ2xCM0QsTUFEa0IsRUFFbEJJLG1CQUZrQixFQUdsQjtFQUNBO0VBQ0FpRCxpQkFBaUIsR0FBR3RCLFNBQUgsR0FBZW9CLEtBTGQsRUFNbEI3QyxjQU5rQixDQUF0QjtFQVFBLE1BQU1zRCxnQkFBZ0IsR0FBRyxJQUFBQyx3QkFBQSxFQUFlZixPQUFPLENBQUNULFVBQVIsRUFBZixJQUF1Q1MsT0FBTyxDQUFDZ0IsTUFBL0MsR0FBd0QvQixTQUFqRjtFQUNBLE1BQU1nQyxXQUFXLEdBQUdqRSxNQUFNLEVBQUVrRSxlQUFSLEtBQTRCaEIsWUFBWSxDQUFDaUIsU0FBYixFQUFoRDtFQUVBaEQsd0JBQXdCLENBQUM2QixPQUFELEVBQVUzQixvQkFBVixFQUFnQzZCLFlBQWhDLENBQXhCOztFQUVBLE1BQU1rQixPQUFPLEdBQUcsTUFBTTtJQUNsQixJQUFJUixhQUFhLEtBQUtTLGtDQUFBLENBQW9CQyxNQUExQyxFQUFrRDtNQUM5QztJQUNIOztJQUNEQyxjQUFBLENBQU1DLFlBQU4sQ0FDSUMseUJBREosRUFFSTtNQUNJQyxNQUFNLEVBQUUxQixPQUFPLENBQUNWLFNBQVIsRUFEWjtNQUVJWSxZQUZKO01BR0l5QixvQkFBb0IsRUFBRTNFLE1BSDFCO01BSUl1RDtJQUpKLENBRkosRUFRSSw2QkFSSixFQVNJLEtBVEosRUFTVztJQUNQLElBVkosQ0FVVTtJQVZWO0VBWUgsQ0FoQkQ7O0VBa0JBLG9CQUNJO0lBQ0ksU0FBUyxFQUFDLGdCQURkO0lBRUksR0FBRyxFQUFFUjtFQUZULEdBSU9hLGFBQWEsS0FBS1Msa0NBQUEsQ0FBb0JDLE1BQXRDLElBQWdELENBQUNmLGlCQUFsRCxnQkFDRSw2QkFBQyxZQUFEO0lBQ0ksRUFBRSxFQUFFTixLQURSO0lBRUksWUFBWSxFQUFFM0MsbUJBQW1CLENBQUNzRSxHQUZ0QztJQUdJLE9BQU8sRUFBRXRCLFFBSGI7SUFJSSxPQUFPLEVBQUVjLE9BSmI7SUFLSSxTQUFTLEVBQUM7RUFMZCxHQVFRO0lBQUEsSUFBQztNQUFFUztJQUFGLENBQUQ7SUFBQSxvQkFDSSw2QkFBQyxvQkFBRDtNQUNJLEdBQUcsRUFBRUEsR0FEVDtNQUVJLEVBQUUsRUFBRyxHQUFFNUIsS0FBTSxTQUZqQjtNQUdJLE1BQU0sRUFBRTNDLG1CQUFtQixDQUFDc0UsR0FIaEM7TUFJSSxVQUFVLEVBQUVkLGdCQUpoQjtNQUtJLGNBQWM7SUFMbEIsRUFESjtFQUFBLENBUlIsQ0FERixHQW1CSVAsaUJBQWlCLGdCQUNmLDZCQUFDLGtCQUFEO0lBQ0ksS0FBSyxFQUFFRixLQUFLLENBQUNHLE9BRGpCO0lBRUksT0FBTyxFQUFFWSxPQUZiO0lBR0ksU0FBUyxFQUFFLElBQUFVLG1CQUFBLEVBQ1AseUJBRE8sRUFFUDtJQUNBO01BQUUsc0NBQ0VsQixhQUFhLEtBQUtTLGtDQUFBLENBQW9CQztJQUQxQyxDQUhPLENBSGY7SUFVSSxXQUFXO0VBVmYsRUFEZSxnQkFhZiw2QkFBQyxvQkFBRDtJQUNJLFNBQVMsRUFBRVYsYUFBYSxLQUFLUyxrQ0FBQSxDQUFvQlUsT0FEckQ7SUFFSSxTQUFTLEVBQUM7RUFGZCxFQXBDWixFQXlDTWQsV0FBVyxnQkFDVCw2QkFBQyx3QkFBRDtJQUNJLFNBQVMsRUFBQyxxQkFEZDtJQUVJLE1BQU0sRUFBRWpFLE1BRlo7SUFHSSxhQUFhLEVBQUU0RCxhQUhuQjtJQUlJLFFBQVE7RUFKWixFQURTLGdCQU9ULDZCQUFDLHFCQUFEO0lBQ0ksU0FBUyxFQUFDLHFCQURkO0lBRUksTUFBTSxFQUFFNUQsTUFGWjtJQUdJLGFBQWEsRUFBRTRELGFBSG5CO0lBSUksS0FBSyxFQUFFLElBQUFvQixtQkFBQSxFQUFHLG9CQUFILENBSlg7SUFLSSxRQUFRO0VBTFosRUFoRFIsQ0FESjtBQTJESCxDQXZHeUMsQ0FBMUM7O2VBeUdlcEMsVyJ9