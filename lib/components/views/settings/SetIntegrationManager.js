"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _logger = require("matrix-js-sdk/src/logger");

var _languageHandler = require("../../../languageHandler");

var _IntegrationManagers = require("../../../integrations/IntegrationManagers");

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _SettingLevel = require("../../../settings/SettingLevel");

var _ToggleSwitch = _interopRequireDefault(require("../elements/ToggleSwitch"));

/*
Copyright 2019 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
class SetIntegrationManager extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "onProvisioningToggled", () => {
      const current = this.state.provisioningEnabled;

      _SettingsStore.default.setValue("integrationProvisioning", null, _SettingLevel.SettingLevel.ACCOUNT, !current).catch(err => {
        _logger.logger.error("Error changing integration manager provisioning");

        _logger.logger.error(err);

        this.setState({
          provisioningEnabled: current
        });
      });

      this.setState({
        provisioningEnabled: !current
      });
    });

    const currentManager = _IntegrationManagers.IntegrationManagers.sharedInstance().getPrimaryManager();

    this.state = {
      currentManager,
      provisioningEnabled: _SettingsStore.default.getValue("integrationProvisioning")
    };
  }

  render() {
    const currentManager = this.state.currentManager;
    let managerName;
    let bodyText;

    if (currentManager) {
      managerName = `(${currentManager.name})`;
      bodyText = (0, _languageHandler._t)("Use an integration manager <b>(%(serverName)s)</b> to manage bots, widgets, " + "and sticker packs.", {
        serverName: currentManager.name
      }, {
        b: sub => /*#__PURE__*/_react.default.createElement("b", null, sub)
      });
    } else {
      bodyText = (0, _languageHandler._t)("Use an integration manager to manage bots, widgets, and sticker packs.");
    }

    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SetIntegrationManager"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SettingsFlag"
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SetIntegrationManager_heading_manager"
    }, /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_SettingsTab_heading"
    }, (0, _languageHandler._t)("Manage integrations")), /*#__PURE__*/_react.default.createElement("span", {
      className: "mx_SettingsTab_subheading"
    }, managerName)), /*#__PURE__*/_react.default.createElement(_ToggleSwitch.default, {
      checked: this.state.provisioningEnabled,
      disabled: false,
      onChange: this.onProvisioningToggled
    })), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SettingsTab_subsectionText"
    }, bodyText), /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_SettingsTab_subsectionText"
    }, (0, _languageHandler._t)("Integration managers receive configuration data, and can modify widgets, " + "send room invites, and set power levels on your behalf.")));
  }

}

exports.default = SetIntegrationManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTZXRJbnRlZ3JhdGlvbk1hbmFnZXIiLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJjdXJyZW50Iiwic3RhdGUiLCJwcm92aXNpb25pbmdFbmFibGVkIiwiU2V0dGluZ3NTdG9yZSIsInNldFZhbHVlIiwiU2V0dGluZ0xldmVsIiwiQUNDT1VOVCIsImNhdGNoIiwiZXJyIiwibG9nZ2VyIiwiZXJyb3IiLCJzZXRTdGF0ZSIsImN1cnJlbnRNYW5hZ2VyIiwiSW50ZWdyYXRpb25NYW5hZ2VycyIsInNoYXJlZEluc3RhbmNlIiwiZ2V0UHJpbWFyeU1hbmFnZXIiLCJnZXRWYWx1ZSIsInJlbmRlciIsIm1hbmFnZXJOYW1lIiwiYm9keVRleHQiLCJuYW1lIiwiX3QiLCJzZXJ2ZXJOYW1lIiwiYiIsInN1YiIsIm9uUHJvdmlzaW9uaW5nVG9nZ2xlZCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL3NldHRpbmdzL1NldEludGVncmF0aW9uTWFuYWdlci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE5IFRoZSBNYXRyaXgub3JnIEZvdW5kYXRpb24gQy5JLkMuXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbmxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9sb2dnZXJcIjtcblxuaW1wb3J0IHsgX3QgfSBmcm9tIFwiLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyXCI7XG5pbXBvcnQgeyBJbnRlZ3JhdGlvbk1hbmFnZXJzIH0gZnJvbSBcIi4uLy4uLy4uL2ludGVncmF0aW9ucy9JbnRlZ3JhdGlvbk1hbmFnZXJzXCI7XG5pbXBvcnQgeyBJbnRlZ3JhdGlvbk1hbmFnZXJJbnN0YW5jZSB9IGZyb20gXCIuLi8uLi8uLi9pbnRlZ3JhdGlvbnMvSW50ZWdyYXRpb25NYW5hZ2VySW5zdGFuY2VcIjtcbmltcG9ydCBTZXR0aW5nc1N0b3JlIGZyb20gXCIuLi8uLi8uLi9zZXR0aW5ncy9TZXR0aW5nc1N0b3JlXCI7XG5pbXBvcnQgeyBTZXR0aW5nTGV2ZWwgfSBmcm9tIFwiLi4vLi4vLi4vc2V0dGluZ3MvU2V0dGluZ0xldmVsXCI7XG5pbXBvcnQgVG9nZ2xlU3dpdGNoIGZyb20gXCIuLi9lbGVtZW50cy9Ub2dnbGVTd2l0Y2hcIjtcblxuaW50ZXJmYWNlIElQcm9wcyB7XG5cbn1cblxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgY3VycmVudE1hbmFnZXI6IEludGVncmF0aW9uTWFuYWdlckluc3RhbmNlO1xuICAgIHByb3Zpc2lvbmluZ0VuYWJsZWQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNldEludGVncmF0aW9uTWFuYWdlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJUHJvcHMsIElTdGF0ZT4ge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBJUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRNYW5hZ2VyID0gSW50ZWdyYXRpb25NYW5hZ2Vycy5zaGFyZWRJbnN0YW5jZSgpLmdldFByaW1hcnlNYW5hZ2VyKCk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGN1cnJlbnRNYW5hZ2VyLFxuICAgICAgICAgICAgcHJvdmlzaW9uaW5nRW5hYmxlZDogU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImludGVncmF0aW9uUHJvdmlzaW9uaW5nXCIpLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgb25Qcm92aXNpb25pbmdUb2dnbGVkID0gKCk6IHZvaWQgPT4ge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5zdGF0ZS5wcm92aXNpb25pbmdFbmFibGVkO1xuICAgICAgICBTZXR0aW5nc1N0b3JlLnNldFZhbHVlKFwiaW50ZWdyYXRpb25Qcm92aXNpb25pbmdcIiwgbnVsbCwgU2V0dGluZ0xldmVsLkFDQ09VTlQsICFjdXJyZW50KS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3IgY2hhbmdpbmcgaW50ZWdyYXRpb24gbWFuYWdlciBwcm92aXNpb25pbmdcIik7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyKTtcblxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHByb3Zpc2lvbmluZ0VuYWJsZWQ6IGN1cnJlbnQgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgcHJvdmlzaW9uaW5nRW5hYmxlZDogIWN1cnJlbnQgfSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyByZW5kZXIoKTogUmVhY3QuUmVhY3ROb2RlIHtcbiAgICAgICAgY29uc3QgY3VycmVudE1hbmFnZXIgPSB0aGlzLnN0YXRlLmN1cnJlbnRNYW5hZ2VyO1xuICAgICAgICBsZXQgbWFuYWdlck5hbWU7XG4gICAgICAgIGxldCBib2R5VGV4dDtcbiAgICAgICAgaWYgKGN1cnJlbnRNYW5hZ2VyKSB7XG4gICAgICAgICAgICBtYW5hZ2VyTmFtZSA9IGAoJHtjdXJyZW50TWFuYWdlci5uYW1lfSlgO1xuICAgICAgICAgICAgYm9keVRleHQgPSBfdChcbiAgICAgICAgICAgICAgICBcIlVzZSBhbiBpbnRlZ3JhdGlvbiBtYW5hZ2VyIDxiPiglKHNlcnZlck5hbWUpcyk8L2I+IHRvIG1hbmFnZSBib3RzLCB3aWRnZXRzLCBcIiArXG4gICAgICAgICAgICAgICAgXCJhbmQgc3RpY2tlciBwYWNrcy5cIixcbiAgICAgICAgICAgICAgICB7IHNlcnZlck5hbWU6IGN1cnJlbnRNYW5hZ2VyLm5hbWUgfSxcbiAgICAgICAgICAgICAgICB7IGI6IHN1YiA9PiA8Yj57IHN1YiB9PC9iPiB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJvZHlUZXh0ID0gX3QoXCJVc2UgYW4gaW50ZWdyYXRpb24gbWFuYWdlciB0byBtYW5hZ2UgYm90cywgd2lkZ2V0cywgYW5kIHN0aWNrZXIgcGFja3MuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdteF9TZXRJbnRlZ3JhdGlvbk1hbmFnZXInPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU2V0dGluZ3NGbGFnXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU2V0SW50ZWdyYXRpb25NYW5hZ2VyX2hlYWRpbmdfbWFuYWdlclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwibXhfU2V0dGluZ3NUYWJfaGVhZGluZ1wiPnsgX3QoXCJNYW5hZ2UgaW50ZWdyYXRpb25zXCIpIH08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJteF9TZXR0aW5nc1RhYl9zdWJoZWFkaW5nXCI+eyBtYW5hZ2VyTmFtZSB9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPFRvZ2dsZVN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5zdGF0ZS5wcm92aXNpb25pbmdFbmFibGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25Qcm92aXNpb25pbmdUb2dnbGVkfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfU2V0dGluZ3NUYWJfc3Vic2VjdGlvblRleHRcIj5cbiAgICAgICAgICAgICAgICAgICAgeyBib2R5VGV4dCB9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9TZXR0aW5nc1RhYl9zdWJzZWN0aW9uVGV4dFwiPlxuICAgICAgICAgICAgICAgICAgICB7IF90KFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJJbnRlZ3JhdGlvbiBtYW5hZ2VycyByZWNlaXZlIGNvbmZpZ3VyYXRpb24gZGF0YSwgYW5kIGNhbiBtb2RpZnkgd2lkZ2V0cywgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZW5kIHJvb20gaW52aXRlcywgYW5kIHNldCBwb3dlciBsZXZlbHMgb24geW91ciBiZWhhbGYuXCIsXG4gICAgICAgICAgICAgICAgICAgICkgfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQWdCQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUF4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcUJlLE1BQU1BLHFCQUFOLFNBQW9DQyxjQUFBLENBQU1DLFNBQTFDLENBQW9FO0VBQy9FQyxXQUFXLENBQUNDLEtBQUQsRUFBZ0I7SUFDdkIsTUFBTUEsS0FBTjtJQUR1Qiw2REFXSyxNQUFZO01BQ3hDLE1BQU1DLE9BQU8sR0FBRyxLQUFLQyxLQUFMLENBQVdDLG1CQUEzQjs7TUFDQUMsc0JBQUEsQ0FBY0MsUUFBZCxDQUF1Qix5QkFBdkIsRUFBa0QsSUFBbEQsRUFBd0RDLDBCQUFBLENBQWFDLE9BQXJFLEVBQThFLENBQUNOLE9BQS9FLEVBQXdGTyxLQUF4RixDQUE4RkMsR0FBRyxJQUFJO1FBQ2pHQyxjQUFBLENBQU9DLEtBQVAsQ0FBYSxpREFBYjs7UUFDQUQsY0FBQSxDQUFPQyxLQUFQLENBQWFGLEdBQWI7O1FBRUEsS0FBS0csUUFBTCxDQUFjO1VBQUVULG1CQUFtQixFQUFFRjtRQUF2QixDQUFkO01BQ0gsQ0FMRDs7TUFNQSxLQUFLVyxRQUFMLENBQWM7UUFBRVQsbUJBQW1CLEVBQUUsQ0FBQ0Y7TUFBeEIsQ0FBZDtJQUNILENBcEIwQjs7SUFHdkIsTUFBTVksY0FBYyxHQUFHQyx3Q0FBQSxDQUFvQkMsY0FBcEIsR0FBcUNDLGlCQUFyQyxFQUF2Qjs7SUFFQSxLQUFLZCxLQUFMLEdBQWE7TUFDVFcsY0FEUztNQUVUVixtQkFBbUIsRUFBRUMsc0JBQUEsQ0FBY2EsUUFBZCxDQUF1Qix5QkFBdkI7SUFGWixDQUFiO0VBSUg7O0VBYU1DLE1BQU0sR0FBb0I7SUFDN0IsTUFBTUwsY0FBYyxHQUFHLEtBQUtYLEtBQUwsQ0FBV1csY0FBbEM7SUFDQSxJQUFJTSxXQUFKO0lBQ0EsSUFBSUMsUUFBSjs7SUFDQSxJQUFJUCxjQUFKLEVBQW9CO01BQ2hCTSxXQUFXLEdBQUksSUFBR04sY0FBYyxDQUFDUSxJQUFLLEdBQXRDO01BQ0FELFFBQVEsR0FBRyxJQUFBRSxtQkFBQSxFQUNQLGlGQUNBLG9CQUZPLEVBR1A7UUFBRUMsVUFBVSxFQUFFVixjQUFjLENBQUNRO01BQTdCLENBSE8sRUFJUDtRQUFFRyxDQUFDLEVBQUVDLEdBQUcsaUJBQUksd0NBQUtBLEdBQUw7TUFBWixDQUpPLENBQVg7SUFNSCxDQVJELE1BUU87TUFDSEwsUUFBUSxHQUFHLElBQUFFLG1CQUFBLEVBQUcsd0VBQUgsQ0FBWDtJQUNIOztJQUVELG9CQUNJO01BQUssU0FBUyxFQUFDO0lBQWYsZ0JBQ0k7TUFBSyxTQUFTLEVBQUM7SUFBZixnQkFDSTtNQUFLLFNBQVMsRUFBQztJQUFmLGdCQUNJO01BQU0sU0FBUyxFQUFDO0lBQWhCLEdBQTJDLElBQUFBLG1CQUFBLEVBQUcscUJBQUgsQ0FBM0MsQ0FESixlQUVJO01BQU0sU0FBUyxFQUFDO0lBQWhCLEdBQThDSCxXQUE5QyxDQUZKLENBREosZUFLSSw2QkFBQyxxQkFBRDtNQUNJLE9BQU8sRUFBRSxLQUFLakIsS0FBTCxDQUFXQyxtQkFEeEI7TUFFSSxRQUFRLEVBQUUsS0FGZDtNQUdJLFFBQVEsRUFBRSxLQUFLdUI7SUFIbkIsRUFMSixDQURKLGVBWUk7TUFBSyxTQUFTLEVBQUM7SUFBZixHQUNNTixRQUROLENBWkosZUFlSTtNQUFLLFNBQVMsRUFBQztJQUFmLEdBQ00sSUFBQUUsbUJBQUEsRUFDRSw4RUFDQSx5REFGRixDQUROLENBZkosQ0FESjtFQXdCSDs7QUEvRDhFIn0=