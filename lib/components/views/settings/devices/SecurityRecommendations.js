"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireDefault(require("react"));

var _languageHandler = require("../../../../languageHandler");

var _AccessibleButton = _interopRequireDefault(require("../../elements/AccessibleButton"));

var _SettingsSubsection = _interopRequireDefault(require("../shared/SettingsSubsection"));

var _DeviceSecurityCard = _interopRequireDefault(require("./DeviceSecurityCard"));

var _filter = require("./filter");

var _types = require("./types");

/*
Copyright 2022 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const SecurityRecommendations = _ref => {
  let {
    devices,
    currentDeviceId,
    goToFilteredList
  } = _ref;
  const devicesArray = Object.values(devices);
  const unverifiedDevicesCount = (0, _filter.filterDevicesBySecurityRecommendation)(devicesArray, [_types.DeviceSecurityVariation.Unverified]) // filter out the current device
  // as unverfied warning and actions
  // will be shown in current session section
  .filter(device => device.device_id !== currentDeviceId).length;
  const inactiveDevicesCount = (0, _filter.filterDevicesBySecurityRecommendation)(devicesArray, [_types.DeviceSecurityVariation.Inactive]).length;

  if (!(unverifiedDevicesCount | inactiveDevicesCount)) {
    return null;
  }

  const inactiveAgeDays = _filter.INACTIVE_DEVICE_AGE_DAYS;
  return /*#__PURE__*/_react.default.createElement(_SettingsSubsection.default, {
    heading: (0, _languageHandler._t)('Security recommendations'),
    description: (0, _languageHandler._t)('Improve your account security by following these recommendations'),
    "data-testid": "security-recommendations-section"
  }, !!unverifiedDevicesCount && /*#__PURE__*/_react.default.createElement(_DeviceSecurityCard.default, {
    variation: _types.DeviceSecurityVariation.Unverified,
    heading: (0, _languageHandler._t)('Unverified sessions'),
    description: (0, _languageHandler._t)(`Verify your sessions for enhanced secure messaging` + ` or sign out from those you don't recognize or use anymore.`)
  }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    kind: "link_inline",
    onClick: () => goToFilteredList(_types.DeviceSecurityVariation.Unverified),
    "data-testid": "unverified-devices-cta"
  }, (0, _languageHandler._t)('View all') + ` (${unverifiedDevicesCount})`)), !!inactiveDevicesCount && /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, !!unverifiedDevicesCount && /*#__PURE__*/_react.default.createElement("div", {
    className: "mx_SecurityRecommendations_spacing"
  }), /*#__PURE__*/_react.default.createElement(_DeviceSecurityCard.default, {
    variation: _types.DeviceSecurityVariation.Inactive,
    heading: (0, _languageHandler._t)('Inactive sessions'),
    description: (0, _languageHandler._t)(`Consider signing out from old sessions ` + `(%(inactiveAgeDays)s days or older) you don't use anymore`, {
      inactiveAgeDays
    })
  }, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
    kind: "link_inline",
    onClick: () => goToFilteredList(_types.DeviceSecurityVariation.Inactive),
    "data-testid": "inactive-devices-cta"
  }, (0, _languageHandler._t)('View all') + ` (${inactiveDevicesCount})`))));
};

var _default = SecurityRecommendations;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTZWN1cml0eVJlY29tbWVuZGF0aW9ucyIsImRldmljZXMiLCJjdXJyZW50RGV2aWNlSWQiLCJnb1RvRmlsdGVyZWRMaXN0IiwiZGV2aWNlc0FycmF5IiwiT2JqZWN0IiwidmFsdWVzIiwidW52ZXJpZmllZERldmljZXNDb3VudCIsImZpbHRlckRldmljZXNCeVNlY3VyaXR5UmVjb21tZW5kYXRpb24iLCJEZXZpY2VTZWN1cml0eVZhcmlhdGlvbiIsIlVudmVyaWZpZWQiLCJmaWx0ZXIiLCJkZXZpY2UiLCJkZXZpY2VfaWQiLCJsZW5ndGgiLCJpbmFjdGl2ZURldmljZXNDb3VudCIsIkluYWN0aXZlIiwiaW5hY3RpdmVBZ2VEYXlzIiwiSU5BQ1RJVkVfREVWSUNFX0FHRV9EQVlTIiwiX3QiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy92aWV3cy9zZXR0aW5ncy9kZXZpY2VzL1NlY3VyaXR5UmVjb21tZW5kYXRpb25zLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMjIgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgeyBfdCB9IGZyb20gJy4uLy4uLy4uLy4uL2xhbmd1YWdlSGFuZGxlcic7XG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiBmcm9tICcuLi8uLi9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uJztcbmltcG9ydCBTZXR0aW5nc1N1YnNlY3Rpb24gZnJvbSAnLi4vc2hhcmVkL1NldHRpbmdzU3Vic2VjdGlvbic7XG5pbXBvcnQgRGV2aWNlU2VjdXJpdHlDYXJkIGZyb20gJy4vRGV2aWNlU2VjdXJpdHlDYXJkJztcbmltcG9ydCB7IGZpbHRlckRldmljZXNCeVNlY3VyaXR5UmVjb21tZW5kYXRpb24sIElOQUNUSVZFX0RFVklDRV9BR0VfREFZUyB9IGZyb20gJy4vZmlsdGVyJztcbmltcG9ydCB7XG4gICAgRGV2aWNlU2VjdXJpdHlWYXJpYXRpb24sXG4gICAgRGV2aWNlV2l0aFZlcmlmaWNhdGlvbixcbiAgICBEZXZpY2VzRGljdGlvbmFyeSxcbn0gZnJvbSAnLi90eXBlcyc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gICAgZGV2aWNlczogRGV2aWNlc0RpY3Rpb25hcnk7XG4gICAgY3VycmVudERldmljZUlkOiBEZXZpY2VXaXRoVmVyaWZpY2F0aW9uWydkZXZpY2VfaWQnXTtcbiAgICBnb1RvRmlsdGVyZWRMaXN0OiAoZmlsdGVyOiBEZXZpY2VTZWN1cml0eVZhcmlhdGlvbikgPT4gdm9pZDtcbn1cblxuY29uc3QgU2VjdXJpdHlSZWNvbW1lbmRhdGlvbnM6IFJlYWN0LkZDPFByb3BzPiA9ICh7XG4gICAgZGV2aWNlcyxcbiAgICBjdXJyZW50RGV2aWNlSWQsXG4gICAgZ29Ub0ZpbHRlcmVkTGlzdCxcbn0pID0+IHtcbiAgICBjb25zdCBkZXZpY2VzQXJyYXkgPSBPYmplY3QudmFsdWVzPERldmljZVdpdGhWZXJpZmljYXRpb24+KGRldmljZXMpO1xuXG4gICAgY29uc3QgdW52ZXJpZmllZERldmljZXNDb3VudCA9IGZpbHRlckRldmljZXNCeVNlY3VyaXR5UmVjb21tZW5kYXRpb24oXG4gICAgICAgIGRldmljZXNBcnJheSxcbiAgICAgICAgW0RldmljZVNlY3VyaXR5VmFyaWF0aW9uLlVudmVyaWZpZWRdLFxuICAgIClcbiAgICAgICAgLy8gZmlsdGVyIG91dCB0aGUgY3VycmVudCBkZXZpY2VcbiAgICAgICAgLy8gYXMgdW52ZXJmaWVkIHdhcm5pbmcgYW5kIGFjdGlvbnNcbiAgICAgICAgLy8gd2lsbCBiZSBzaG93biBpbiBjdXJyZW50IHNlc3Npb24gc2VjdGlvblxuICAgICAgICAuZmlsdGVyKChkZXZpY2UpID0+IGRldmljZS5kZXZpY2VfaWQgIT09IGN1cnJlbnREZXZpY2VJZClcbiAgICAgICAgLmxlbmd0aDtcbiAgICBjb25zdCBpbmFjdGl2ZURldmljZXNDb3VudCA9IGZpbHRlckRldmljZXNCeVNlY3VyaXR5UmVjb21tZW5kYXRpb24oXG4gICAgICAgIGRldmljZXNBcnJheSxcbiAgICAgICAgW0RldmljZVNlY3VyaXR5VmFyaWF0aW9uLkluYWN0aXZlXSxcbiAgICApLmxlbmd0aDtcblxuICAgIGlmICghKHVudmVyaWZpZWREZXZpY2VzQ291bnQgfCBpbmFjdGl2ZURldmljZXNDb3VudCkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgaW5hY3RpdmVBZ2VEYXlzID0gSU5BQ1RJVkVfREVWSUNFX0FHRV9EQVlTO1xuXG4gICAgcmV0dXJuIDxTZXR0aW5nc1N1YnNlY3Rpb25cbiAgICAgICAgaGVhZGluZz17X3QoJ1NlY3VyaXR5IHJlY29tbWVuZGF0aW9ucycpfVxuICAgICAgICBkZXNjcmlwdGlvbj17X3QoJ0ltcHJvdmUgeW91ciBhY2NvdW50IHNlY3VyaXR5IGJ5IGZvbGxvd2luZyB0aGVzZSByZWNvbW1lbmRhdGlvbnMnKX1cbiAgICAgICAgZGF0YS10ZXN0aWQ9J3NlY3VyaXR5LXJlY29tbWVuZGF0aW9ucy1zZWN0aW9uJ1xuICAgID5cbiAgICAgICAge1xuICAgICAgICAgICAgISF1bnZlcmlmaWVkRGV2aWNlc0NvdW50ICYmXG4gICAgICAgICAgICA8RGV2aWNlU2VjdXJpdHlDYXJkXG4gICAgICAgICAgICAgICAgdmFyaWF0aW9uPXtEZXZpY2VTZWN1cml0eVZhcmlhdGlvbi5VbnZlcmlmaWVkfVxuICAgICAgICAgICAgICAgIGhlYWRpbmc9e190KCdVbnZlcmlmaWVkIHNlc3Npb25zJyl9XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e190KFxuICAgICAgICAgICAgICAgICAgICBgVmVyaWZ5IHlvdXIgc2Vzc2lvbnMgZm9yIGVuaGFuY2VkIHNlY3VyZSBtZXNzYWdpbmdgICtcbiAgICAgICAgICAgICAgICAgICAgYCBvciBzaWduIG91dCBmcm9tIHRob3NlIHlvdSBkb24ndCByZWNvZ25pemUgb3IgdXNlIGFueW1vcmUuYCxcbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ9J2xpbmtfaW5saW5lJ1xuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBnb1RvRmlsdGVyZWRMaXN0KERldmljZVNlY3VyaXR5VmFyaWF0aW9uLlVudmVyaWZpZWQpfVxuICAgICAgICAgICAgICAgICAgICBkYXRhLXRlc3RpZD0ndW52ZXJpZmllZC1kZXZpY2VzLWN0YSdcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHsgX3QoJ1ZpZXcgYWxsJykgKyBgICgke3VudmVyaWZpZWREZXZpY2VzQ291bnR9KWAgfVxuICAgICAgICAgICAgICAgIDwvQWNjZXNzaWJsZUJ1dHRvbj5cbiAgICAgICAgICAgIDwvRGV2aWNlU2VjdXJpdHlDYXJkPlxuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICAgICEhaW5hY3RpdmVEZXZpY2VzQ291bnQgJiZcbiAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgeyAhIXVudmVyaWZpZWREZXZpY2VzQ291bnQgJiYgPGRpdiBjbGFzc05hbWU9J214X1NlY3VyaXR5UmVjb21tZW5kYXRpb25zX3NwYWNpbmcnIC8+IH1cbiAgICAgICAgICAgICAgICA8RGV2aWNlU2VjdXJpdHlDYXJkXG4gICAgICAgICAgICAgICAgICAgIHZhcmlhdGlvbj17RGV2aWNlU2VjdXJpdHlWYXJpYXRpb24uSW5hY3RpdmV9XG4gICAgICAgICAgICAgICAgICAgIGhlYWRpbmc9e190KCdJbmFjdGl2ZSBzZXNzaW9ucycpfVxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbj17X3QoXG4gICAgICAgICAgICAgICAgICAgICAgICBgQ29uc2lkZXIgc2lnbmluZyBvdXQgZnJvbSBvbGQgc2Vzc2lvbnMgYCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgKCUoaW5hY3RpdmVBZ2VEYXlzKXMgZGF5cyBvciBvbGRlcikgeW91IGRvbid0IHVzZSBhbnltb3JlYCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgaW5hY3RpdmVBZ2VEYXlzIH0sXG4gICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8QWNjZXNzaWJsZUJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAga2luZD0nbGlua19pbmxpbmUnXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBnb1RvRmlsdGVyZWRMaXN0KERldmljZVNlY3VyaXR5VmFyaWF0aW9uLkluYWN0aXZlKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtdGVzdGlkPSdpbmFjdGl2ZS1kZXZpY2VzLWN0YSdcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBfdCgnVmlldyBhbGwnKSArIGAgKCR7aW5hY3RpdmVEZXZpY2VzQ291bnR9KWAgfVxuICAgICAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICAgICAgICAgPC9EZXZpY2VTZWN1cml0eUNhcmQ+XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgfVxuICAgIDwvU2V0dGluZ3NTdWJzZWN0aW9uPjtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3VyaXR5UmVjb21tZW5kYXRpb25zO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFnQkE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCQSxNQUFNQSx1QkFBd0MsR0FBRyxRQUkzQztFQUFBLElBSjRDO0lBQzlDQyxPQUQ4QztJQUU5Q0MsZUFGOEM7SUFHOUNDO0VBSDhDLENBSTVDO0VBQ0YsTUFBTUMsWUFBWSxHQUFHQyxNQUFNLENBQUNDLE1BQVAsQ0FBc0NMLE9BQXRDLENBQXJCO0VBRUEsTUFBTU0sc0JBQXNCLEdBQUcsSUFBQUMsNkNBQUEsRUFDM0JKLFlBRDJCLEVBRTNCLENBQUNLLDhCQUFBLENBQXdCQyxVQUF6QixDQUYyQixFQUkzQjtFQUNBO0VBQ0E7RUFOMkIsQ0FPMUJDLE1BUDBCLENBT2xCQyxNQUFELElBQVlBLE1BQU0sQ0FBQ0MsU0FBUCxLQUFxQlgsZUFQZCxFQVExQlksTUFSTDtFQVNBLE1BQU1DLG9CQUFvQixHQUFHLElBQUFQLDZDQUFBLEVBQ3pCSixZQUR5QixFQUV6QixDQUFDSyw4QkFBQSxDQUF3Qk8sUUFBekIsQ0FGeUIsRUFHM0JGLE1BSEY7O0VBS0EsSUFBSSxFQUFFUCxzQkFBc0IsR0FBR1Esb0JBQTNCLENBQUosRUFBc0Q7SUFDbEQsT0FBTyxJQUFQO0VBQ0g7O0VBRUQsTUFBTUUsZUFBZSxHQUFHQyxnQ0FBeEI7RUFFQSxvQkFBTyw2QkFBQywyQkFBRDtJQUNILE9BQU8sRUFBRSxJQUFBQyxtQkFBQSxFQUFHLDBCQUFILENBRE47SUFFSCxXQUFXLEVBQUUsSUFBQUEsbUJBQUEsRUFBRyxrRUFBSCxDQUZWO0lBR0gsZUFBWTtFQUhULEdBTUMsQ0FBQyxDQUFDWixzQkFBRixpQkFDQSw2QkFBQywyQkFBRDtJQUNJLFNBQVMsRUFBRUUsOEJBQUEsQ0FBd0JDLFVBRHZDO0lBRUksT0FBTyxFQUFFLElBQUFTLG1CQUFBLEVBQUcscUJBQUgsQ0FGYjtJQUdJLFdBQVcsRUFBRSxJQUFBQSxtQkFBQSxFQUNSLG9EQUFELEdBQ0MsNkRBRlE7RUFIakIsZ0JBUUksNkJBQUMseUJBQUQ7SUFDSSxJQUFJLEVBQUMsYUFEVDtJQUVJLE9BQU8sRUFBRSxNQUFNaEIsZ0JBQWdCLENBQUNNLDhCQUFBLENBQXdCQyxVQUF6QixDQUZuQztJQUdJLGVBQVk7RUFIaEIsR0FLTSxJQUFBUyxtQkFBQSxFQUFHLFVBQUgsSUFBa0IsS0FBSVosc0JBQXVCLEdBTG5ELENBUkosQ0FQRCxFQXlCQyxDQUFDLENBQUNRLG9CQUFGLGlCQUNBLDREQUNNLENBQUMsQ0FBQ1Isc0JBQUYsaUJBQTRCO0lBQUssU0FBUyxFQUFDO0VBQWYsRUFEbEMsZUFFSSw2QkFBQywyQkFBRDtJQUNJLFNBQVMsRUFBRUUsOEJBQUEsQ0FBd0JPLFFBRHZDO0lBRUksT0FBTyxFQUFFLElBQUFHLG1CQUFBLEVBQUcsbUJBQUgsQ0FGYjtJQUdJLFdBQVcsRUFBRSxJQUFBQSxtQkFBQSxFQUNSLHlDQUFELEdBQ0MsMkRBRlEsRUFHVDtNQUFFRjtJQUFGLENBSFM7RUFIakIsZ0JBU0ksNkJBQUMseUJBQUQ7SUFDSSxJQUFJLEVBQUMsYUFEVDtJQUVJLE9BQU8sRUFBRSxNQUFNZCxnQkFBZ0IsQ0FBQ00sOEJBQUEsQ0FBd0JPLFFBQXpCLENBRm5DO0lBR0ksZUFBWTtFQUhoQixHQUtNLElBQUFHLG1CQUFBLEVBQUcsVUFBSCxJQUFrQixLQUFJSixvQkFBcUIsR0FMakQsQ0FUSixDQUZKLENBMUJELENBQVA7QUFnREgsQ0EzRUQ7O2VBNkVlZix1QiJ9