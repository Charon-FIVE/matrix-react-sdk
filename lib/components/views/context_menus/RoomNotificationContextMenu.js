"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RoomNotificationContextMenu = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireDefault(require("react"));

var _KeyboardShortcuts = require("../../../accessibility/KeyboardShortcuts");

var _useRoomNotificationState = require("../../../hooks/useRoomNotificationState");

var _KeyBindingsManager = require("../../../KeyBindingsManager");

var _languageHandler = require("../../../languageHandler");

var _RoomNotifs = require("../../../RoomNotifs");

var _IconizedContextMenu = _interopRequireWildcard(require("../context_menus/IconizedContextMenu"));

const _excluded = ["room", "onFinished"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

const RoomNotificationContextMenu = _ref => {
  let {
    room,
    onFinished
  } = _ref,
      props = (0, _objectWithoutProperties2.default)(_ref, _excluded);
  const [notificationState, setNotificationState] = (0, _useRoomNotificationState.useNotificationState)(room);

  const wrapHandler = function (handler) {
    let persistent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    return ev => {
      ev.preventDefault();
      ev.stopPropagation();
      handler(ev);
      const action = (0, _KeyBindingsManager.getKeyBindingsManager)().getAccessibilityAction(ev);

      if (!persistent || action === _KeyboardShortcuts.KeyBindingAction.Enter) {
        onFinished();
      }
    };
  };

  const defaultOption = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
    label: (0, _languageHandler._t)("Use default"),
    active: notificationState === _RoomNotifs.RoomNotifState.AllMessages,
    iconClassName: "mx_RoomNotificationContextMenu_iconBell",
    onClick: wrapHandler(() => setNotificationState(_RoomNotifs.RoomNotifState.AllMessages))
  });

  const allMessagesOption = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
    label: (0, _languageHandler._t)("All messages"),
    active: notificationState === _RoomNotifs.RoomNotifState.AllMessagesLoud,
    iconClassName: "mx_RoomNotificationContextMenu_iconBellDot",
    onClick: wrapHandler(() => setNotificationState(_RoomNotifs.RoomNotifState.AllMessagesLoud))
  });

  const mentionsOption = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
    label: (0, _languageHandler._t)("Mentions & Keywords"),
    active: notificationState === _RoomNotifs.RoomNotifState.MentionsOnly,
    iconClassName: "mx_RoomNotificationContextMenu_iconBellMentions",
    onClick: wrapHandler(() => setNotificationState(_RoomNotifs.RoomNotifState.MentionsOnly))
  });

  const muteOption = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuRadio, {
    label: (0, _languageHandler._t)("None"),
    active: notificationState === _RoomNotifs.RoomNotifState.Mute,
    iconClassName: "mx_RoomNotificationContextMenu_iconBellCrossed",
    onClick: wrapHandler(() => setNotificationState(_RoomNotifs.RoomNotifState.Mute))
  });

  return /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.default, (0, _extends2.default)({}, props, {
    onFinished: onFinished,
    className: "mx_RoomNotificationContextMenu",
    compact: true
  }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, {
    first: true
  }, defaultOption, allMessagesOption, mentionsOption, muteOption));
};

exports.RoomNotificationContextMenu = RoomNotificationContextMenu;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSb29tTm90aWZpY2F0aW9uQ29udGV4dE1lbnUiLCJyb29tIiwib25GaW5pc2hlZCIsInByb3BzIiwibm90aWZpY2F0aW9uU3RhdGUiLCJzZXROb3RpZmljYXRpb25TdGF0ZSIsInVzZU5vdGlmaWNhdGlvblN0YXRlIiwid3JhcEhhbmRsZXIiLCJoYW5kbGVyIiwicGVyc2lzdGVudCIsImV2IiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJhY3Rpb24iLCJnZXRLZXlCaW5kaW5nc01hbmFnZXIiLCJnZXRBY2Nlc3NpYmlsaXR5QWN0aW9uIiwiS2V5QmluZGluZ0FjdGlvbiIsIkVudGVyIiwiZGVmYXVsdE9wdGlvbiIsIl90IiwiUm9vbU5vdGlmU3RhdGUiLCJBbGxNZXNzYWdlcyIsImFsbE1lc3NhZ2VzT3B0aW9uIiwiQWxsTWVzc2FnZXNMb3VkIiwibWVudGlvbnNPcHRpb24iLCJNZW50aW9uc09ubHkiLCJtdXRlT3B0aW9uIiwiTXV0ZSJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2NvbnRleHRfbWVudXMvUm9vbU5vdGlmaWNhdGlvbkNvbnRleHRNZW51LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMjEgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgeyBSb29tIH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL21vZGVscy9yb29tXCI7XG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5cbmltcG9ydCB7IEtleUJpbmRpbmdBY3Rpb24gfSBmcm9tIFwiLi4vLi4vLi4vYWNjZXNzaWJpbGl0eS9LZXlib2FyZFNob3J0Y3V0c1wiO1xuaW1wb3J0IHsgdXNlTm90aWZpY2F0aW9uU3RhdGUgfSBmcm9tIFwiLi4vLi4vLi4vaG9va3MvdXNlUm9vbU5vdGlmaWNhdGlvblN0YXRlXCI7XG5pbXBvcnQgeyBnZXRLZXlCaW5kaW5nc01hbmFnZXIgfSBmcm9tIFwiLi4vLi4vLi4vS2V5QmluZGluZ3NNYW5hZ2VyXCI7XG5pbXBvcnQgeyBfdCB9IGZyb20gXCIuLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXJcIjtcbmltcG9ydCB7IFJvb21Ob3RpZlN0YXRlIH0gZnJvbSBcIi4uLy4uLy4uL1Jvb21Ob3RpZnNcIjtcbmltcG9ydCB7IElQcm9wcyBhcyBJQ29udGV4dE1lbnVQcm9wcyB9IGZyb20gXCIuLi8uLi9zdHJ1Y3R1cmVzL0NvbnRleHRNZW51XCI7XG5pbXBvcnQgSWNvbml6ZWRDb250ZXh0TWVudSwge1xuICAgIEljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0LFxuICAgIEljb25pemVkQ29udGV4dE1lbnVSYWRpbyxcbn0gZnJvbSBcIi4uL2NvbnRleHRfbWVudXMvSWNvbml6ZWRDb250ZXh0TWVudVwiO1xuaW1wb3J0IHsgQnV0dG9uRXZlbnQgfSBmcm9tIFwiLi4vZWxlbWVudHMvQWNjZXNzaWJsZUJ1dHRvblwiO1xuXG5pbnRlcmZhY2UgSVByb3BzIGV4dGVuZHMgSUNvbnRleHRNZW51UHJvcHMge1xuICAgIHJvb206IFJvb207XG59XG5cbmV4cG9ydCBjb25zdCBSb29tTm90aWZpY2F0aW9uQ29udGV4dE1lbnUgPSAoeyByb29tLCBvbkZpbmlzaGVkLCAuLi5wcm9wcyB9OiBJUHJvcHMpID0+IHtcbiAgICBjb25zdCBbbm90aWZpY2F0aW9uU3RhdGUsIHNldE5vdGlmaWNhdGlvblN0YXRlXSA9IHVzZU5vdGlmaWNhdGlvblN0YXRlKHJvb20pO1xuXG4gICAgY29uc3Qgd3JhcEhhbmRsZXIgPSAoXG4gICAgICAgIGhhbmRsZXI6IChldjogQnV0dG9uRXZlbnQpID0+IHZvaWQsXG4gICAgICAgIHBlcnNpc3RlbnQgPSBmYWxzZSxcbiAgICApOiAoZXY6IEJ1dHRvbkV2ZW50KSA9PiB2b2lkID0+IHtcbiAgICAgICAgcmV0dXJuIChldjogQnV0dG9uRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgaGFuZGxlcihldik7XG5cbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IGdldEtleUJpbmRpbmdzTWFuYWdlcigpLmdldEFjY2Vzc2liaWxpdHlBY3Rpb24oZXYgYXMgUmVhY3QuS2V5Ym9hcmRFdmVudCk7XG4gICAgICAgICAgICBpZiAoIXBlcnNpc3RlbnQgfHwgYWN0aW9uID09PSBLZXlCaW5kaW5nQWN0aW9uLkVudGVyKSB7XG4gICAgICAgICAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBjb25zdCBkZWZhdWx0T3B0aW9uOiBKU1guRWxlbWVudCA9IDxJY29uaXplZENvbnRleHRNZW51UmFkaW9cbiAgICAgICAgbGFiZWw9e190KFwiVXNlIGRlZmF1bHRcIil9XG4gICAgICAgIGFjdGl2ZT17bm90aWZpY2F0aW9uU3RhdGUgPT09IFJvb21Ob3RpZlN0YXRlLkFsbE1lc3NhZ2VzfVxuICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfUm9vbU5vdGlmaWNhdGlvbkNvbnRleHRNZW51X2ljb25CZWxsXCJcbiAgICAgICAgb25DbGljaz17d3JhcEhhbmRsZXIoKCkgPT4gc2V0Tm90aWZpY2F0aW9uU3RhdGUoUm9vbU5vdGlmU3RhdGUuQWxsTWVzc2FnZXMpKX1cbiAgICAvPjtcblxuICAgIGNvbnN0IGFsbE1lc3NhZ2VzT3B0aW9uOiBKU1guRWxlbWVudCA9IDxJY29uaXplZENvbnRleHRNZW51UmFkaW9cbiAgICAgICAgbGFiZWw9e190KFwiQWxsIG1lc3NhZ2VzXCIpfVxuICAgICAgICBhY3RpdmU9e25vdGlmaWNhdGlvblN0YXRlID09PSBSb29tTm90aWZTdGF0ZS5BbGxNZXNzYWdlc0xvdWR9XG4gICAgICAgIGljb25DbGFzc05hbWU9XCJteF9Sb29tTm90aWZpY2F0aW9uQ29udGV4dE1lbnVfaWNvbkJlbGxEb3RcIlxuICAgICAgICBvbkNsaWNrPXt3cmFwSGFuZGxlcigoKSA9PiBzZXROb3RpZmljYXRpb25TdGF0ZShSb29tTm90aWZTdGF0ZS5BbGxNZXNzYWdlc0xvdWQpKX1cbiAgICAvPjtcblxuICAgIGNvbnN0IG1lbnRpb25zT3B0aW9uOiBKU1guRWxlbWVudCA9IDxJY29uaXplZENvbnRleHRNZW51UmFkaW9cbiAgICAgICAgbGFiZWw9e190KFwiTWVudGlvbnMgJiBLZXl3b3Jkc1wiKX1cbiAgICAgICAgYWN0aXZlPXtub3RpZmljYXRpb25TdGF0ZSA9PT0gUm9vbU5vdGlmU3RhdGUuTWVudGlvbnNPbmx5fVxuICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfUm9vbU5vdGlmaWNhdGlvbkNvbnRleHRNZW51X2ljb25CZWxsTWVudGlvbnNcIlxuICAgICAgICBvbkNsaWNrPXt3cmFwSGFuZGxlcigoKSA9PiBzZXROb3RpZmljYXRpb25TdGF0ZShSb29tTm90aWZTdGF0ZS5NZW50aW9uc09ubHkpKX1cbiAgICAvPjtcblxuICAgIGNvbnN0IG11dGVPcHRpb246IEpTWC5FbGVtZW50ID0gPEljb25pemVkQ29udGV4dE1lbnVSYWRpb1xuICAgICAgICBsYWJlbD17X3QoXCJOb25lXCIpfVxuICAgICAgICBhY3RpdmU9e25vdGlmaWNhdGlvblN0YXRlID09PSBSb29tTm90aWZTdGF0ZS5NdXRlfVxuICAgICAgICBpY29uQ2xhc3NOYW1lPVwibXhfUm9vbU5vdGlmaWNhdGlvbkNvbnRleHRNZW51X2ljb25CZWxsQ3Jvc3NlZFwiXG4gICAgICAgIG9uQ2xpY2s9e3dyYXBIYW5kbGVyKCgpID0+IHNldE5vdGlmaWNhdGlvblN0YXRlKFJvb21Ob3RpZlN0YXRlLk11dGUpKX1cbiAgICAvPjtcblxuICAgIHJldHVybiA8SWNvbml6ZWRDb250ZXh0TWVudVxuICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgIG9uRmluaXNoZWQ9e29uRmluaXNoZWR9XG4gICAgICAgIGNsYXNzTmFtZT1cIm14X1Jvb21Ob3RpZmljYXRpb25Db250ZXh0TWVudVwiXG4gICAgICAgIGNvbXBhY3RcbiAgICA+XG4gICAgICAgIDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdCBmaXJzdD5cbiAgICAgICAgICAgIHsgZGVmYXVsdE9wdGlvbiB9XG4gICAgICAgICAgICB7IGFsbE1lc3NhZ2VzT3B0aW9uIH1cbiAgICAgICAgICAgIHsgbWVudGlvbnNPcHRpb24gfVxuICAgICAgICAgICAgeyBtdXRlT3B0aW9uIH1cbiAgICAgICAgPC9JY29uaXplZENvbnRleHRNZW51T3B0aW9uTGlzdD5cbiAgICA8L0ljb25pemVkQ29udGV4dE1lbnU+O1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQWlCQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7Ozs7Ozs7QUFVTyxNQUFNQSwyQkFBMkIsR0FBRyxRQUE0QztFQUFBLElBQTNDO0lBQUVDLElBQUY7SUFBUUM7RUFBUixDQUEyQztFQUFBLElBQXBCQyxLQUFvQjtFQUNuRixNQUFNLENBQUNDLGlCQUFELEVBQW9CQyxvQkFBcEIsSUFBNEMsSUFBQUMsOENBQUEsRUFBcUJMLElBQXJCLENBQWxEOztFQUVBLE1BQU1NLFdBQVcsR0FBRyxVQUNoQkMsT0FEZ0IsRUFHWTtJQUFBLElBRDVCQyxVQUM0Qix1RUFEZixLQUNlO0lBQzVCLE9BQVFDLEVBQUQsSUFBcUI7TUFDeEJBLEVBQUUsQ0FBQ0MsY0FBSDtNQUNBRCxFQUFFLENBQUNFLGVBQUg7TUFFQUosT0FBTyxDQUFDRSxFQUFELENBQVA7TUFFQSxNQUFNRyxNQUFNLEdBQUcsSUFBQUMseUNBQUEsSUFBd0JDLHNCQUF4QixDQUErQ0wsRUFBL0MsQ0FBZjs7TUFDQSxJQUFJLENBQUNELFVBQUQsSUFBZUksTUFBTSxLQUFLRyxtQ0FBQSxDQUFpQkMsS0FBL0MsRUFBc0Q7UUFDbERmLFVBQVU7TUFDYjtJQUNKLENBVkQ7RUFXSCxDQWZEOztFQWlCQSxNQUFNZ0IsYUFBMEIsZ0JBQUcsNkJBQUMsNkNBQUQ7SUFDL0IsS0FBSyxFQUFFLElBQUFDLG1CQUFBLEVBQUcsYUFBSCxDQUR3QjtJQUUvQixNQUFNLEVBQUVmLGlCQUFpQixLQUFLZ0IsMEJBQUEsQ0FBZUMsV0FGZDtJQUcvQixhQUFhLEVBQUMseUNBSGlCO0lBSS9CLE9BQU8sRUFBRWQsV0FBVyxDQUFDLE1BQU1GLG9CQUFvQixDQUFDZSwwQkFBQSxDQUFlQyxXQUFoQixDQUEzQjtFQUpXLEVBQW5DOztFQU9BLE1BQU1DLGlCQUE4QixnQkFBRyw2QkFBQyw2Q0FBRDtJQUNuQyxLQUFLLEVBQUUsSUFBQUgsbUJBQUEsRUFBRyxjQUFILENBRDRCO0lBRW5DLE1BQU0sRUFBRWYsaUJBQWlCLEtBQUtnQiwwQkFBQSxDQUFlRyxlQUZWO0lBR25DLGFBQWEsRUFBQyw0Q0FIcUI7SUFJbkMsT0FBTyxFQUFFaEIsV0FBVyxDQUFDLE1BQU1GLG9CQUFvQixDQUFDZSwwQkFBQSxDQUFlRyxlQUFoQixDQUEzQjtFQUplLEVBQXZDOztFQU9BLE1BQU1DLGNBQTJCLGdCQUFHLDZCQUFDLDZDQUFEO0lBQ2hDLEtBQUssRUFBRSxJQUFBTCxtQkFBQSxFQUFHLHFCQUFILENBRHlCO0lBRWhDLE1BQU0sRUFBRWYsaUJBQWlCLEtBQUtnQiwwQkFBQSxDQUFlSyxZQUZiO0lBR2hDLGFBQWEsRUFBQyxpREFIa0I7SUFJaEMsT0FBTyxFQUFFbEIsV0FBVyxDQUFDLE1BQU1GLG9CQUFvQixDQUFDZSwwQkFBQSxDQUFlSyxZQUFoQixDQUEzQjtFQUpZLEVBQXBDOztFQU9BLE1BQU1DLFVBQXVCLGdCQUFHLDZCQUFDLDZDQUFEO0lBQzVCLEtBQUssRUFBRSxJQUFBUCxtQkFBQSxFQUFHLE1BQUgsQ0FEcUI7SUFFNUIsTUFBTSxFQUFFZixpQkFBaUIsS0FBS2dCLDBCQUFBLENBQWVPLElBRmpCO0lBRzVCLGFBQWEsRUFBQyxnREFIYztJQUk1QixPQUFPLEVBQUVwQixXQUFXLENBQUMsTUFBTUYsb0JBQW9CLENBQUNlLDBCQUFBLENBQWVPLElBQWhCLENBQTNCO0VBSlEsRUFBaEM7O0VBT0Esb0JBQU8sNkJBQUMsNEJBQUQsNkJBQ0N4QixLQUREO0lBRUgsVUFBVSxFQUFFRCxVQUZUO0lBR0gsU0FBUyxFQUFDLGdDQUhQO0lBSUgsT0FBTztFQUpKLGlCQU1ILDZCQUFDLGtEQUFEO0lBQStCLEtBQUs7RUFBcEMsR0FDTWdCLGFBRE4sRUFFTUksaUJBRk4sRUFHTUUsY0FITixFQUlNRSxVQUpOLENBTkcsQ0FBUDtBQWFILENBN0RNIn0=