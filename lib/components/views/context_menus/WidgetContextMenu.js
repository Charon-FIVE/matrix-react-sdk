"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireWildcard(require("react"));

var _matrixWidgetApi = require("matrix-widget-api");

var _logger = require("matrix-js-sdk/src/logger");

var _IconizedContextMenu = _interopRequireWildcard(require("./IconizedContextMenu"));

var _ContextMenu = require("../../structures/ContextMenu");

var _languageHandler = require("../../../languageHandler");

var _WidgetUtils = _interopRequireDefault(require("../../../utils/WidgetUtils"));

var _WidgetMessagingStore = require("../../../stores/widgets/WidgetMessagingStore");

var _RoomContext = _interopRequireDefault(require("../../../contexts/RoomContext"));

var _dispatcher = _interopRequireDefault(require("../../../dispatcher/dispatcher"));

var _SettingsStore = _interopRequireDefault(require("../../../settings/SettingsStore"));

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _QuestionDialog = _interopRequireDefault(require("../dialogs/QuestionDialog"));

var _ErrorDialog = _interopRequireDefault(require("../dialogs/ErrorDialog"));

var _WidgetType = require("../../../widgets/WidgetType");

var _MatrixClientContext = _interopRequireDefault(require("../../../contexts/MatrixClientContext"));

var _WidgetLayoutStore = require("../../../stores/widgets/WidgetLayoutStore");

var _Livestream = require("../../../Livestream");

const _excluded = ["onFinished", "app", "userWidget", "onDeleteClick", "onEditClick", "showUnpin"];

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

const WidgetContextMenu = _ref => {
  let {
    onFinished,
    app,
    userWidget,
    onDeleteClick,
    onEditClick,
    showUnpin
  } = _ref,
      props = (0, _objectWithoutProperties2.default)(_ref, _excluded);
  const cli = (0, _react.useContext)(_MatrixClientContext.default);
  const {
    room,
    roomId
  } = (0, _react.useContext)(_RoomContext.default);

  const widgetMessaging = _WidgetMessagingStore.WidgetMessagingStore.instance.getMessagingForUid(_WidgetUtils.default.getWidgetUid(app));

  const canModify = userWidget || _WidgetUtils.default.canUserModifyWidgets(roomId);

  let streamAudioStreamButton;

  if ((0, _Livestream.getConfigLivestreamUrl)() && _WidgetType.WidgetType.JITSI.matches(app.type)) {
    const onStreamAudioClick = async () => {
      try {
        await (0, _Livestream.startJitsiAudioLivestream)(widgetMessaging, roomId);
      } catch (err) {
        _logger.logger.error("Failed to start livestream", err); // XXX: won't i18n well, but looks like widget api only support 'message'?


        const message = err.message || (0, _languageHandler._t)("Unable to start audio streaming.");

        _Modal.default.createDialog(_ErrorDialog.default, {
          title: (0, _languageHandler._t)('Failed to start livestream'),
          description: message
        });
      }

      onFinished();
    };

    streamAudioStreamButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      onClick: onStreamAudioClick,
      label: (0, _languageHandler._t)("Start audio stream")
    });
  }

  const pinnedWidgets = _WidgetLayoutStore.WidgetLayoutStore.instance.getContainerWidgets(room, _WidgetLayoutStore.Container.Top);

  const widgetIndex = pinnedWidgets.findIndex(widget => widget.id === app.id);
  let editButton;

  if (canModify && _WidgetUtils.default.isManagedByManager(app)) {
    const _onEditClick = () => {
      if (onEditClick) {
        onEditClick();
      } else {
        _WidgetUtils.default.editWidget(room, app);
      }

      onFinished();
    };

    editButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      onClick: _onEditClick,
      label: (0, _languageHandler._t)("Edit")
    });
  }

  let snapshotButton;

  const screenshotsEnabled = _SettingsStore.default.getValue("enableWidgetScreenshots");

  if (screenshotsEnabled && widgetMessaging?.hasCapability(_matrixWidgetApi.MatrixCapabilities.Screenshots)) {
    const onSnapshotClick = () => {
      widgetMessaging?.takeScreenshot().then(data => {
        _dispatcher.default.dispatch({
          action: 'picture_snapshot',
          file: data.screenshot
        });
      }).catch(err => {
        _logger.logger.error("Failed to take screenshot: ", err);
      });
      onFinished();
    };

    snapshotButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      onClick: onSnapshotClick,
      label: (0, _languageHandler._t)("Take a picture")
    });
  }

  let deleteButton;

  if (onDeleteClick || canModify) {
    const _onDeleteClick = () => {
      if (onDeleteClick) {
        onDeleteClick();
      } else {
        // Show delete confirmation dialog
        _Modal.default.createDialog(_QuestionDialog.default, {
          title: (0, _languageHandler._t)("Delete Widget"),
          description: (0, _languageHandler._t)("Deleting a widget removes it for all users in this room." + " Are you sure you want to delete this widget?"),
          button: (0, _languageHandler._t)("Delete widget"),
          onFinished: confirmed => {
            if (!confirmed) return;

            _WidgetUtils.default.setRoomWidget(roomId, app.id);
          }
        });
      }

      onFinished();
    };

    deleteButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      onClick: _onDeleteClick,
      label: userWidget ? (0, _languageHandler._t)("Remove") : (0, _languageHandler._t)("Remove for everyone")
    });
  }

  let isAllowedWidget = _SettingsStore.default.getValue("allowedWidgets", roomId)[app.eventId];

  if (isAllowedWidget === undefined) {
    isAllowedWidget = app.creatorUserId === cli.getUserId();
  }

  const isLocalWidget = _WidgetType.WidgetType.JITSI.matches(app.type);

  let revokeButton;

  if (!userWidget && !isLocalWidget && isAllowedWidget) {
    const onRevokeClick = () => {
      _logger.logger.info("Revoking permission for widget to load: " + app.eventId);

      const current = _SettingsStore.default.getValue("allowedWidgets", roomId);

      current[app.eventId] = false;

      const level = _SettingsStore.default.firstSupportedLevel("allowedWidgets");

      _SettingsStore.default.setValue("allowedWidgets", roomId, level, current).catch(err => {
        _logger.logger.error(err); // We don't really need to do anything about this - the user will just hit the button again.

      });

      onFinished();
    };

    revokeButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      onClick: onRevokeClick,
      label: (0, _languageHandler._t)("Revoke permissions")
    });
  }

  let moveLeftButton;

  if (showUnpin && widgetIndex > 0) {
    const onClick = () => {
      _WidgetLayoutStore.WidgetLayoutStore.instance.moveWithinContainer(room, _WidgetLayoutStore.Container.Top, app, -1);

      onFinished();
    };

    moveLeftButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      onClick: onClick,
      label: (0, _languageHandler._t)("Move left")
    });
  }

  let moveRightButton;

  if (showUnpin && widgetIndex < pinnedWidgets.length - 1) {
    const onClick = () => {
      _WidgetLayoutStore.WidgetLayoutStore.instance.moveWithinContainer(room, _WidgetLayoutStore.Container.Top, app, 1);

      onFinished();
    };

    moveRightButton = /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOption, {
      onClick: onClick,
      label: (0, _languageHandler._t)("Move right")
    });
  }

  return /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.default, (0, _extends2.default)({}, props, {
    chevronFace: _ContextMenu.ChevronFace.None,
    onFinished: onFinished
  }), /*#__PURE__*/_react.default.createElement(_IconizedContextMenu.IconizedContextMenuOptionList, null, streamAudioStreamButton, editButton, revokeButton, deleteButton, snapshotButton, moveLeftButton, moveRightButton));
};

var _default = WidgetContextMenu;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJXaWRnZXRDb250ZXh0TWVudSIsIm9uRmluaXNoZWQiLCJhcHAiLCJ1c2VyV2lkZ2V0Iiwib25EZWxldGVDbGljayIsIm9uRWRpdENsaWNrIiwic2hvd1VucGluIiwicHJvcHMiLCJjbGkiLCJ1c2VDb250ZXh0IiwiTWF0cml4Q2xpZW50Q29udGV4dCIsInJvb20iLCJyb29tSWQiLCJSb29tQ29udGV4dCIsIndpZGdldE1lc3NhZ2luZyIsIldpZGdldE1lc3NhZ2luZ1N0b3JlIiwiaW5zdGFuY2UiLCJnZXRNZXNzYWdpbmdGb3JVaWQiLCJXaWRnZXRVdGlscyIsImdldFdpZGdldFVpZCIsImNhbk1vZGlmeSIsImNhblVzZXJNb2RpZnlXaWRnZXRzIiwic3RyZWFtQXVkaW9TdHJlYW1CdXR0b24iLCJnZXRDb25maWdMaXZlc3RyZWFtVXJsIiwiV2lkZ2V0VHlwZSIsIkpJVFNJIiwibWF0Y2hlcyIsInR5cGUiLCJvblN0cmVhbUF1ZGlvQ2xpY2siLCJzdGFydEppdHNpQXVkaW9MaXZlc3RyZWFtIiwiZXJyIiwibG9nZ2VyIiwiZXJyb3IiLCJtZXNzYWdlIiwiX3QiLCJNb2RhbCIsImNyZWF0ZURpYWxvZyIsIkVycm9yRGlhbG9nIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBpbm5lZFdpZGdldHMiLCJXaWRnZXRMYXlvdXRTdG9yZSIsImdldENvbnRhaW5lcldpZGdldHMiLCJDb250YWluZXIiLCJUb3AiLCJ3aWRnZXRJbmRleCIsImZpbmRJbmRleCIsIndpZGdldCIsImlkIiwiZWRpdEJ1dHRvbiIsImlzTWFuYWdlZEJ5TWFuYWdlciIsIl9vbkVkaXRDbGljayIsImVkaXRXaWRnZXQiLCJzbmFwc2hvdEJ1dHRvbiIsInNjcmVlbnNob3RzRW5hYmxlZCIsIlNldHRpbmdzU3RvcmUiLCJnZXRWYWx1ZSIsImhhc0NhcGFiaWxpdHkiLCJNYXRyaXhDYXBhYmlsaXRpZXMiLCJTY3JlZW5zaG90cyIsIm9uU25hcHNob3RDbGljayIsInRha2VTY3JlZW5zaG90IiwidGhlbiIsImRhdGEiLCJkaXMiLCJkaXNwYXRjaCIsImFjdGlvbiIsImZpbGUiLCJzY3JlZW5zaG90IiwiY2F0Y2giLCJkZWxldGVCdXR0b24iLCJfb25EZWxldGVDbGljayIsIlF1ZXN0aW9uRGlhbG9nIiwiYnV0dG9uIiwiY29uZmlybWVkIiwic2V0Um9vbVdpZGdldCIsImlzQWxsb3dlZFdpZGdldCIsImV2ZW50SWQiLCJ1bmRlZmluZWQiLCJjcmVhdG9yVXNlcklkIiwiZ2V0VXNlcklkIiwiaXNMb2NhbFdpZGdldCIsInJldm9rZUJ1dHRvbiIsIm9uUmV2b2tlQ2xpY2siLCJpbmZvIiwiY3VycmVudCIsImxldmVsIiwiZmlyc3RTdXBwb3J0ZWRMZXZlbCIsInNldFZhbHVlIiwibW92ZUxlZnRCdXR0b24iLCJvbkNsaWNrIiwibW92ZVdpdGhpbkNvbnRhaW5lciIsIm1vdmVSaWdodEJ1dHRvbiIsImxlbmd0aCIsIkNoZXZyb25GYWNlIiwiTm9uZSJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2NvbnRleHRfbWVudXMvV2lkZ2V0Q29udGV4dE1lbnUudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMCBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCwgeyB1c2VDb250ZXh0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBNYXRyaXhDYXBhYmlsaXRpZXMgfSBmcm9tIFwibWF0cml4LXdpZGdldC1hcGlcIjtcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9sb2dnZXJcIjtcblxuaW1wb3J0IEljb25pemVkQ29udGV4dE1lbnUsIHsgSWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbiwgSWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3QgfSBmcm9tIFwiLi9JY29uaXplZENvbnRleHRNZW51XCI7XG5pbXBvcnQgeyBDaGV2cm9uRmFjZSB9IGZyb20gXCIuLi8uLi9zdHJ1Y3R1cmVzL0NvbnRleHRNZW51XCI7XG5pbXBvcnQgeyBfdCB9IGZyb20gXCIuLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXJcIjtcbmltcG9ydCB7IElBcHAgfSBmcm9tIFwiLi4vLi4vLi4vc3RvcmVzL1dpZGdldFN0b3JlXCI7XG5pbXBvcnQgV2lkZ2V0VXRpbHMgZnJvbSBcIi4uLy4uLy4uL3V0aWxzL1dpZGdldFV0aWxzXCI7XG5pbXBvcnQgeyBXaWRnZXRNZXNzYWdpbmdTdG9yZSB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvd2lkZ2V0cy9XaWRnZXRNZXNzYWdpbmdTdG9yZVwiO1xuaW1wb3J0IFJvb21Db250ZXh0IGZyb20gXCIuLi8uLi8uLi9jb250ZXh0cy9Sb29tQ29udGV4dFwiO1xuaW1wb3J0IGRpcyBmcm9tIFwiLi4vLi4vLi4vZGlzcGF0Y2hlci9kaXNwYXRjaGVyXCI7XG5pbXBvcnQgU2V0dGluZ3NTdG9yZSBmcm9tIFwiLi4vLi4vLi4vc2V0dGluZ3MvU2V0dGluZ3NTdG9yZVwiO1xuaW1wb3J0IE1vZGFsIGZyb20gXCIuLi8uLi8uLi9Nb2RhbFwiO1xuaW1wb3J0IFF1ZXN0aW9uRGlhbG9nIGZyb20gXCIuLi9kaWFsb2dzL1F1ZXN0aW9uRGlhbG9nXCI7XG5pbXBvcnQgRXJyb3JEaWFsb2cgZnJvbSBcIi4uL2RpYWxvZ3MvRXJyb3JEaWFsb2dcIjtcbmltcG9ydCB7IFdpZGdldFR5cGUgfSBmcm9tIFwiLi4vLi4vLi4vd2lkZ2V0cy9XaWRnZXRUeXBlXCI7XG5pbXBvcnQgTWF0cml4Q2xpZW50Q29udGV4dCBmcm9tIFwiLi4vLi4vLi4vY29udGV4dHMvTWF0cml4Q2xpZW50Q29udGV4dFwiO1xuaW1wb3J0IHsgQ29udGFpbmVyLCBXaWRnZXRMYXlvdXRTdG9yZSB9IGZyb20gXCIuLi8uLi8uLi9zdG9yZXMvd2lkZ2V0cy9XaWRnZXRMYXlvdXRTdG9yZVwiO1xuaW1wb3J0IHsgZ2V0Q29uZmlnTGl2ZXN0cmVhbVVybCwgc3RhcnRKaXRzaUF1ZGlvTGl2ZXN0cmVhbSB9IGZyb20gXCIuLi8uLi8uLi9MaXZlc3RyZWFtXCI7XG5cbmludGVyZmFjZSBJUHJvcHMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnRQcm9wczx0eXBlb2YgSWNvbml6ZWRDb250ZXh0TWVudT4ge1xuICAgIGFwcDogSUFwcDtcbiAgICB1c2VyV2lkZ2V0PzogYm9vbGVhbjtcbiAgICBzaG93VW5waW4/OiBib29sZWFuO1xuICAgIC8vIG92ZXJyaWRlIGRlbGV0ZSBoYW5kbGVyXG4gICAgb25EZWxldGVDbGljaz8oKTogdm9pZDtcbiAgICAvLyBvdmVycmlkZSBlZGl0IGhhbmRsZXJcbiAgICBvbkVkaXRDbGljaz8oKTogdm9pZDtcbn1cblxuY29uc3QgV2lkZ2V0Q29udGV4dE1lbnU6IFJlYWN0LkZDPElQcm9wcz4gPSAoe1xuICAgIG9uRmluaXNoZWQsXG4gICAgYXBwLFxuICAgIHVzZXJXaWRnZXQsXG4gICAgb25EZWxldGVDbGljayxcbiAgICBvbkVkaXRDbGljayxcbiAgICBzaG93VW5waW4sXG4gICAgLi4ucHJvcHNcbn0pID0+IHtcbiAgICBjb25zdCBjbGkgPSB1c2VDb250ZXh0KE1hdHJpeENsaWVudENvbnRleHQpO1xuICAgIGNvbnN0IHsgcm9vbSwgcm9vbUlkIH0gPSB1c2VDb250ZXh0KFJvb21Db250ZXh0KTtcblxuICAgIGNvbnN0IHdpZGdldE1lc3NhZ2luZyA9IFdpZGdldE1lc3NhZ2luZ1N0b3JlLmluc3RhbmNlLmdldE1lc3NhZ2luZ0ZvclVpZChXaWRnZXRVdGlscy5nZXRXaWRnZXRVaWQoYXBwKSk7XG4gICAgY29uc3QgY2FuTW9kaWZ5ID0gdXNlcldpZGdldCB8fCBXaWRnZXRVdGlscy5jYW5Vc2VyTW9kaWZ5V2lkZ2V0cyhyb29tSWQpO1xuXG4gICAgbGV0IHN0cmVhbUF1ZGlvU3RyZWFtQnV0dG9uO1xuICAgIGlmIChnZXRDb25maWdMaXZlc3RyZWFtVXJsKCkgJiYgV2lkZ2V0VHlwZS5KSVRTSS5tYXRjaGVzKGFwcC50eXBlKSkge1xuICAgICAgICBjb25zdCBvblN0cmVhbUF1ZGlvQ2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHN0YXJ0Sml0c2lBdWRpb0xpdmVzdHJlYW0od2lkZ2V0TWVzc2FnaW5nLCByb29tSWQpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIHN0YXJ0IGxpdmVzdHJlYW1cIiwgZXJyKTtcbiAgICAgICAgICAgICAgICAvLyBYWFg6IHdvbid0IGkxOG4gd2VsbCwgYnV0IGxvb2tzIGxpa2Ugd2lkZ2V0IGFwaSBvbmx5IHN1cHBvcnQgJ21lc3NhZ2UnP1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIubWVzc2FnZSB8fCBfdChcIlVuYWJsZSB0byBzdGFydCBhdWRpbyBzdHJlYW1pbmcuXCIpO1xuICAgICAgICAgICAgICAgIE1vZGFsLmNyZWF0ZURpYWxvZyhFcnJvckRpYWxvZywge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogX3QoJ0ZhaWxlZCB0byBzdGFydCBsaXZlc3RyZWFtJyksXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBtZXNzYWdlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgICAgICB9O1xuICAgICAgICBzdHJlYW1BdWRpb1N0cmVhbUJ1dHRvbiA9IDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uXG4gICAgICAgICAgICBvbkNsaWNrPXtvblN0cmVhbUF1ZGlvQ2xpY2t9XG4gICAgICAgICAgICBsYWJlbD17X3QoXCJTdGFydCBhdWRpbyBzdHJlYW1cIil9XG4gICAgICAgIC8+O1xuICAgIH1cblxuICAgIGNvbnN0IHBpbm5lZFdpZGdldHMgPSBXaWRnZXRMYXlvdXRTdG9yZS5pbnN0YW5jZS5nZXRDb250YWluZXJXaWRnZXRzKHJvb20sIENvbnRhaW5lci5Ub3ApO1xuICAgIGNvbnN0IHdpZGdldEluZGV4ID0gcGlubmVkV2lkZ2V0cy5maW5kSW5kZXgod2lkZ2V0ID0+IHdpZGdldC5pZCA9PT0gYXBwLmlkKTtcblxuICAgIGxldCBlZGl0QnV0dG9uO1xuICAgIGlmIChjYW5Nb2RpZnkgJiYgV2lkZ2V0VXRpbHMuaXNNYW5hZ2VkQnlNYW5hZ2VyKGFwcCkpIHtcbiAgICAgICAgY29uc3QgX29uRWRpdENsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKG9uRWRpdENsaWNrKSB7XG4gICAgICAgICAgICAgICAgb25FZGl0Q2xpY2soKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgV2lkZ2V0VXRpbHMuZWRpdFdpZGdldChyb29tLCBhcHApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGVkaXRCdXR0b24gPSA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbiBvbkNsaWNrPXtfb25FZGl0Q2xpY2t9IGxhYmVsPXtfdChcIkVkaXRcIil9IC8+O1xuICAgIH1cblxuICAgIGxldCBzbmFwc2hvdEJ1dHRvbjtcbiAgICBjb25zdCBzY3JlZW5zaG90c0VuYWJsZWQgPSBTZXR0aW5nc1N0b3JlLmdldFZhbHVlKFwiZW5hYmxlV2lkZ2V0U2NyZWVuc2hvdHNcIik7XG4gICAgaWYgKHNjcmVlbnNob3RzRW5hYmxlZCAmJiB3aWRnZXRNZXNzYWdpbmc/Lmhhc0NhcGFiaWxpdHkoTWF0cml4Q2FwYWJpbGl0aWVzLlNjcmVlbnNob3RzKSkge1xuICAgICAgICBjb25zdCBvblNuYXBzaG90Q2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB3aWRnZXRNZXNzYWdpbmc/LnRha2VTY3JlZW5zaG90KCkudGhlbihkYXRhID0+IHtcbiAgICAgICAgICAgICAgICBkaXMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdwaWN0dXJlX3NuYXBzaG90JyxcbiAgICAgICAgICAgICAgICAgICAgZmlsZTogZGF0YS5zY3JlZW5zaG90LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gdGFrZSBzY3JlZW5zaG90OiBcIiwgZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgb25GaW5pc2hlZCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNuYXBzaG90QnV0dG9uID0gPEljb25pemVkQ29udGV4dE1lbnVPcHRpb24gb25DbGljaz17b25TbmFwc2hvdENsaWNrfSBsYWJlbD17X3QoXCJUYWtlIGEgcGljdHVyZVwiKX0gLz47XG4gICAgfVxuXG4gICAgbGV0IGRlbGV0ZUJ1dHRvbjtcbiAgICBpZiAob25EZWxldGVDbGljayB8fCBjYW5Nb2RpZnkpIHtcbiAgICAgICAgY29uc3QgX29uRGVsZXRlQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAob25EZWxldGVDbGljaykge1xuICAgICAgICAgICAgICAgIG9uRGVsZXRlQ2xpY2soKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gU2hvdyBkZWxldGUgY29uZmlybWF0aW9uIGRpYWxvZ1xuICAgICAgICAgICAgICAgIE1vZGFsLmNyZWF0ZURpYWxvZyhRdWVzdGlvbkRpYWxvZywge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogX3QoXCJEZWxldGUgV2lkZ2V0XCIpLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogX3QoXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkRlbGV0aW5nIGEgd2lkZ2V0IHJlbW92ZXMgaXQgZm9yIGFsbCB1c2VycyBpbiB0aGlzIHJvb20uXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHdpZGdldD9cIiksXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbjogX3QoXCJEZWxldGUgd2lkZ2V0XCIpLFxuICAgICAgICAgICAgICAgICAgICBvbkZpbmlzaGVkOiAoY29uZmlybWVkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbmZpcm1lZCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgV2lkZ2V0VXRpbHMuc2V0Um9vbVdpZGdldChyb29tSWQsIGFwcC5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG9uRmluaXNoZWQoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBkZWxldGVCdXR0b24gPSA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvblxuICAgICAgICAgICAgb25DbGljaz17X29uRGVsZXRlQ2xpY2t9XG4gICAgICAgICAgICBsYWJlbD17dXNlcldpZGdldCA/IF90KFwiUmVtb3ZlXCIpIDogX3QoXCJSZW1vdmUgZm9yIGV2ZXJ5b25lXCIpfVxuICAgICAgICAvPjtcbiAgICB9XG5cbiAgICBsZXQgaXNBbGxvd2VkV2lkZ2V0ID0gU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImFsbG93ZWRXaWRnZXRzXCIsIHJvb21JZClbYXBwLmV2ZW50SWRdO1xuICAgIGlmIChpc0FsbG93ZWRXaWRnZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpc0FsbG93ZWRXaWRnZXQgPSBhcHAuY3JlYXRvclVzZXJJZCA9PT0gY2xpLmdldFVzZXJJZCgpO1xuICAgIH1cblxuICAgIGNvbnN0IGlzTG9jYWxXaWRnZXQgPSBXaWRnZXRUeXBlLkpJVFNJLm1hdGNoZXMoYXBwLnR5cGUpO1xuICAgIGxldCByZXZva2VCdXR0b247XG4gICAgaWYgKCF1c2VyV2lkZ2V0ICYmICFpc0xvY2FsV2lkZ2V0ICYmIGlzQWxsb3dlZFdpZGdldCkge1xuICAgICAgICBjb25zdCBvblJldm9rZUNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgbG9nZ2VyLmluZm8oXCJSZXZva2luZyBwZXJtaXNzaW9uIGZvciB3aWRnZXQgdG8gbG9hZDogXCIgKyBhcHAuZXZlbnRJZCk7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gU2V0dGluZ3NTdG9yZS5nZXRWYWx1ZShcImFsbG93ZWRXaWRnZXRzXCIsIHJvb21JZCk7XG4gICAgICAgICAgICBjdXJyZW50W2FwcC5ldmVudElkXSA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBTZXR0aW5nc1N0b3JlLmZpcnN0U3VwcG9ydGVkTGV2ZWwoXCJhbGxvd2VkV2lkZ2V0c1wiKTtcbiAgICAgICAgICAgIFNldHRpbmdzU3RvcmUuc2V0VmFsdWUoXCJhbGxvd2VkV2lkZ2V0c1wiLCByb29tSWQsIGxldmVsLCBjdXJyZW50KS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIC8vIFdlIGRvbid0IHJlYWxseSBuZWVkIHRvIGRvIGFueXRoaW5nIGFib3V0IHRoaXMgLSB0aGUgdXNlciB3aWxsIGp1c3QgaGl0IHRoZSBidXR0b24gYWdhaW4uXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG9uRmluaXNoZWQoKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXZva2VCdXR0b24gPSA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbiBvbkNsaWNrPXtvblJldm9rZUNsaWNrfSBsYWJlbD17X3QoXCJSZXZva2UgcGVybWlzc2lvbnNcIil9IC8+O1xuICAgIH1cblxuICAgIGxldCBtb3ZlTGVmdEJ1dHRvbjtcbiAgICBpZiAoc2hvd1VucGluICYmIHdpZGdldEluZGV4ID4gMCkge1xuICAgICAgICBjb25zdCBvbkNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgV2lkZ2V0TGF5b3V0U3RvcmUuaW5zdGFuY2UubW92ZVdpdGhpbkNvbnRhaW5lcihyb29tLCBDb250YWluZXIuVG9wLCBhcHAsIC0xKTtcbiAgICAgICAgICAgIG9uRmluaXNoZWQoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBtb3ZlTGVmdEJ1dHRvbiA9IDxJY29uaXplZENvbnRleHRNZW51T3B0aW9uIG9uQ2xpY2s9e29uQ2xpY2t9IGxhYmVsPXtfdChcIk1vdmUgbGVmdFwiKX0gLz47XG4gICAgfVxuXG4gICAgbGV0IG1vdmVSaWdodEJ1dHRvbjtcbiAgICBpZiAoc2hvd1VucGluICYmIHdpZGdldEluZGV4IDwgcGlubmVkV2lkZ2V0cy5sZW5ndGggLSAxKSB7XG4gICAgICAgIGNvbnN0IG9uQ2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBXaWRnZXRMYXlvdXRTdG9yZS5pbnN0YW5jZS5tb3ZlV2l0aGluQ29udGFpbmVyKHJvb20sIENvbnRhaW5lci5Ub3AsIGFwcCwgMSk7XG4gICAgICAgICAgICBvbkZpbmlzaGVkKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgbW92ZVJpZ2h0QnV0dG9uID0gPEljb25pemVkQ29udGV4dE1lbnVPcHRpb24gb25DbGljaz17b25DbGlja30gbGFiZWw9e190KFwiTW92ZSByaWdodFwiKX0gLz47XG4gICAgfVxuXG4gICAgcmV0dXJuIDxJY29uaXplZENvbnRleHRNZW51IHsuLi5wcm9wc30gY2hldnJvbkZhY2U9e0NoZXZyb25GYWNlLk5vbmV9IG9uRmluaXNoZWQ9e29uRmluaXNoZWR9PlxuICAgICAgICA8SWNvbml6ZWRDb250ZXh0TWVudU9wdGlvbkxpc3Q+XG4gICAgICAgICAgICB7IHN0cmVhbUF1ZGlvU3RyZWFtQnV0dG9uIH1cbiAgICAgICAgICAgIHsgZWRpdEJ1dHRvbiB9XG4gICAgICAgICAgICB7IHJldm9rZUJ1dHRvbiB9XG4gICAgICAgICAgICB7IGRlbGV0ZUJ1dHRvbiB9XG4gICAgICAgICAgICB7IHNuYXBzaG90QnV0dG9uIH1cbiAgICAgICAgICAgIHsgbW92ZUxlZnRCdXR0b24gfVxuICAgICAgICAgICAgeyBtb3ZlUmlnaHRCdXR0b24gfVxuICAgICAgICA8L0ljb25pemVkQ29udGV4dE1lbnVPcHRpb25MaXN0PlxuICAgIDwvSWNvbml6ZWRDb250ZXh0TWVudT47XG59O1xuXG5leHBvcnQgZGVmYXVsdCBXaWRnZXRDb250ZXh0TWVudTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQWdCQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUFZQSxNQUFNQSxpQkFBbUMsR0FBRyxRQVF0QztFQUFBLElBUnVDO0lBQ3pDQyxVQUR5QztJQUV6Q0MsR0FGeUM7SUFHekNDLFVBSHlDO0lBSXpDQyxhQUp5QztJQUt6Q0MsV0FMeUM7SUFNekNDO0VBTnlD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