"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PowerStatus = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _AccessibleButton = _interopRequireDefault(require("../elements/AccessibleButton"));

var _languageHandler = require("../../../languageHandler");

var _E2EIcon = _interopRequireDefault(require("./E2EIcon"));

var _BaseAvatar = _interopRequireDefault(require("../avatars/BaseAvatar"));

var _PresenceLabel = _interopRequireDefault(require("./PresenceLabel"));

/*
Copyright 2015, 2016 OpenMarket Ltd
Copyright 2018 New Vector Ltd
Copyright 2020 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
let PowerStatus;
exports.PowerStatus = PowerStatus;

(function (PowerStatus) {
  PowerStatus["Admin"] = "admin";
  PowerStatus["Moderator"] = "moderator";
})(PowerStatus || (exports.PowerStatus = PowerStatus = {}));

const PowerLabel = {
  [PowerStatus.Admin]: (0, _languageHandler._td)("Admin"),
  [PowerStatus.Moderator]: (0, _languageHandler._td)("Mod")
};
const PRESENCE_CLASS = {
  "offline": "mx_EntityTile_offline",
  "online": "mx_EntityTile_online",
  "unavailable": "mx_EntityTile_unavailable"
};

function presenceClassForMember(presenceState, lastActiveAgo, showPresence) {
  if (showPresence === false) {
    return 'mx_EntityTile_online_beenactive';
  } // offline is split into two categories depending on whether we have
  // a last_active_ago for them.


  if (presenceState === 'offline') {
    if (lastActiveAgo) {
      return PRESENCE_CLASS['offline'] + '_beenactive';
    } else {
      return PRESENCE_CLASS['offline'] + '_neveractive';
    }
  } else if (presenceState) {
    return PRESENCE_CLASS[presenceState];
  } else {
    return PRESENCE_CLASS['offline'] + '_neveractive';
  }
}

class EntityTile extends _react.default.PureComponent {
  constructor(props) {
    super(props);
    this.state = {
      hover: false
    };
  }

  render() {
    const mainClassNames = {
      "mx_EntityTile": true,
      "mx_EntityTile_noHover": this.props.suppressOnHover
    };
    if (this.props.className) mainClassNames[this.props.className] = true;
    const presenceClass = presenceClassForMember(this.props.presenceState, this.props.presenceLastActiveAgo, this.props.showPresence);
    mainClassNames[presenceClass] = true;
    let nameEl;
    const name = this.props.nameJSX || this.props.name;

    if (!this.props.suppressOnHover) {
      const activeAgo = this.props.presenceLastActiveAgo ? Date.now() - (this.props.presenceLastTs - this.props.presenceLastActiveAgo) : -1;
      let presenceLabel = null;

      if (this.props.showPresence) {
        presenceLabel = /*#__PURE__*/_react.default.createElement(_PresenceLabel.default, {
          activeAgo: activeAgo,
          currentlyActive: this.props.presenceCurrentlyActive,
          presenceState: this.props.presenceState
        });
      }

      if (this.props.subtextLabel) {
        presenceLabel = /*#__PURE__*/_react.default.createElement("span", {
          className: "mx_EntityTile_subtext"
        }, this.props.subtextLabel);
      }

      nameEl = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EntityTile_details"
      }, /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EntityTile_name"
      }, name), presenceLabel);
    } else if (this.props.subtextLabel) {
      nameEl = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EntityTile_details"
      }, /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EntityTile_name"
      }, name), /*#__PURE__*/_react.default.createElement("span", {
        className: "mx_EntityTile_subtext"
      }, this.props.subtextLabel));
    } else {
      nameEl = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EntityTile_name"
      }, name);
    }

    let inviteButton;

    if (this.props.showInviteButton) {
      inviteButton = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EntityTile_invite"
      }, /*#__PURE__*/_react.default.createElement("img", {
        src: require("../../../../res/img/plus.svg").default,
        width: "16",
        height: "16"
      }));
    }

    let powerLabel;
    const powerStatus = this.props.powerStatus;

    if (powerStatus) {
      const powerText = (0, _languageHandler._t)(PowerLabel[powerStatus]);
      powerLabel = /*#__PURE__*/_react.default.createElement("div", {
        className: "mx_EntityTile_power"
      }, powerText);
    }

    let e2eIcon;
    const {
      e2eStatus
    } = this.props;

    if (e2eStatus) {
      e2eIcon = /*#__PURE__*/_react.default.createElement(_E2EIcon.default, {
        status: e2eStatus,
        isUser: true,
        bordered: true
      });
    }

    const av = this.props.avatarJsx || /*#__PURE__*/_react.default.createElement(_BaseAvatar.default, {
      name: this.props.name,
      width: 36,
      height: 36,
      "aria-hidden": "true"
    }); // The wrapping div is required to make the magic mouse listener work, for some reason.


    return /*#__PURE__*/_react.default.createElement("div", null, /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      className: (0, _classnames.default)(mainClassNames),
      title: this.props.title,
      onClick: this.props.onClick
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_EntityTile_avatar"
    }, av, e2eIcon), nameEl, powerLabel, inviteButton));
  }

}

exports.default = EntityTile;
(0, _defineProperty2.default)(EntityTile, "defaultProps", {
  onClick: () => {},
  presenceState: "offline",
  presenceLastActiveAgo: 0,
  presenceLastTs: 0,
  showInviteButton: false,
  suppressOnHover: false,
  showPresence: true
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQb3dlclN0YXR1cyIsIlBvd2VyTGFiZWwiLCJBZG1pbiIsIl90ZCIsIk1vZGVyYXRvciIsIlBSRVNFTkNFX0NMQVNTIiwicHJlc2VuY2VDbGFzc0Zvck1lbWJlciIsInByZXNlbmNlU3RhdGUiLCJsYXN0QWN0aXZlQWdvIiwic2hvd1ByZXNlbmNlIiwiRW50aXR5VGlsZSIsIlJlYWN0IiwiUHVyZUNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJzdGF0ZSIsImhvdmVyIiwicmVuZGVyIiwibWFpbkNsYXNzTmFtZXMiLCJzdXBwcmVzc09uSG92ZXIiLCJjbGFzc05hbWUiLCJwcmVzZW5jZUNsYXNzIiwicHJlc2VuY2VMYXN0QWN0aXZlQWdvIiwibmFtZUVsIiwibmFtZSIsIm5hbWVKU1giLCJhY3RpdmVBZ28iLCJEYXRlIiwibm93IiwicHJlc2VuY2VMYXN0VHMiLCJwcmVzZW5jZUxhYmVsIiwicHJlc2VuY2VDdXJyZW50bHlBY3RpdmUiLCJzdWJ0ZXh0TGFiZWwiLCJpbnZpdGVCdXR0b24iLCJzaG93SW52aXRlQnV0dG9uIiwicmVxdWlyZSIsImRlZmF1bHQiLCJwb3dlckxhYmVsIiwicG93ZXJTdGF0dXMiLCJwb3dlclRleHQiLCJfdCIsImUyZUljb24iLCJlMmVTdGF0dXMiLCJhdiIsImF2YXRhckpzeCIsImNsYXNzTmFtZXMiLCJ0aXRsZSIsIm9uQ2xpY2siXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy92aWV3cy9yb29tcy9FbnRpdHlUaWxlLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTUsIDIwMTYgT3Blbk1hcmtldCBMdGRcbkNvcHlyaWdodCAyMDE4IE5ldyBWZWN0b3IgTHRkXG5Db3B5cmlnaHQgMjAyMCBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tIFwiY2xhc3NuYW1lc1wiO1xuXG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiBmcm9tICcuLi9lbGVtZW50cy9BY2Nlc3NpYmxlQnV0dG9uJztcbmltcG9ydCB7IF90LCBfdGQgfSBmcm9tICcuLi8uLi8uLi9sYW5ndWFnZUhhbmRsZXInO1xuaW1wb3J0IEUyRUljb24sIHsgRTJFU3RhdGUgfSBmcm9tICcuL0UyRUljb24nO1xuaW1wb3J0IEJhc2VBdmF0YXIgZnJvbSAnLi4vYXZhdGFycy9CYXNlQXZhdGFyJztcbmltcG9ydCBQcmVzZW5jZUxhYmVsIGZyb20gXCIuL1ByZXNlbmNlTGFiZWxcIjtcblxuZXhwb3J0IGVudW0gUG93ZXJTdGF0dXMge1xuICAgIEFkbWluID0gXCJhZG1pblwiLFxuICAgIE1vZGVyYXRvciA9IFwibW9kZXJhdG9yXCIsXG59XG5cbmNvbnN0IFBvd2VyTGFiZWw6IFJlY29yZDxQb3dlclN0YXR1cywgc3RyaW5nPiA9IHtcbiAgICBbUG93ZXJTdGF0dXMuQWRtaW5dOiBfdGQoXCJBZG1pblwiKSxcbiAgICBbUG93ZXJTdGF0dXMuTW9kZXJhdG9yXTogX3RkKFwiTW9kXCIpLFxufTtcblxuY29uc3QgUFJFU0VOQ0VfQ0xBU1MgPSB7XG4gICAgXCJvZmZsaW5lXCI6IFwibXhfRW50aXR5VGlsZV9vZmZsaW5lXCIsXG4gICAgXCJvbmxpbmVcIjogXCJteF9FbnRpdHlUaWxlX29ubGluZVwiLFxuICAgIFwidW5hdmFpbGFibGVcIjogXCJteF9FbnRpdHlUaWxlX3VuYXZhaWxhYmxlXCIsXG59O1xuXG5mdW5jdGlvbiBwcmVzZW5jZUNsYXNzRm9yTWVtYmVyKHByZXNlbmNlU3RhdGU6IHN0cmluZywgbGFzdEFjdGl2ZUFnbzogbnVtYmVyLCBzaG93UHJlc2VuY2U6IGJvb2xlYW4pOiBzdHJpbmcge1xuICAgIGlmIChzaG93UHJlc2VuY2UgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiAnbXhfRW50aXR5VGlsZV9vbmxpbmVfYmVlbmFjdGl2ZSc7XG4gICAgfVxuXG4gICAgLy8gb2ZmbGluZSBpcyBzcGxpdCBpbnRvIHR3byBjYXRlZ29yaWVzIGRlcGVuZGluZyBvbiB3aGV0aGVyIHdlIGhhdmVcbiAgICAvLyBhIGxhc3RfYWN0aXZlX2FnbyBmb3IgdGhlbS5cbiAgICBpZiAocHJlc2VuY2VTdGF0ZSA9PT0gJ29mZmxpbmUnKSB7XG4gICAgICAgIGlmIChsYXN0QWN0aXZlQWdvKSB7XG4gICAgICAgICAgICByZXR1cm4gUFJFU0VOQ0VfQ0xBU1NbJ29mZmxpbmUnXSArICdfYmVlbmFjdGl2ZSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUFJFU0VOQ0VfQ0xBU1NbJ29mZmxpbmUnXSArICdfbmV2ZXJhY3RpdmUnO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChwcmVzZW5jZVN0YXRlKSB7XG4gICAgICAgIHJldHVybiBQUkVTRU5DRV9DTEFTU1twcmVzZW5jZVN0YXRlXTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUFJFU0VOQ0VfQ0xBU1NbJ29mZmxpbmUnXSArICdfbmV2ZXJhY3RpdmUnO1xuICAgIH1cbn1cblxuaW50ZXJmYWNlIElQcm9wcyB7XG4gICAgbmFtZT86IHN0cmluZztcbiAgICBuYW1lSlNYPzogSlNYLkVsZW1lbnQ7XG4gICAgdGl0bGU/OiBzdHJpbmc7XG4gICAgYXZhdGFySnN4PzogSlNYLkVsZW1lbnQ7IC8vIDxCYXNlQXZhdGFyIC8+XG4gICAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICAgIHByZXNlbmNlU3RhdGU/OiBzdHJpbmc7XG4gICAgcHJlc2VuY2VMYXN0QWN0aXZlQWdvPzogbnVtYmVyO1xuICAgIHByZXNlbmNlTGFzdFRzPzogbnVtYmVyO1xuICAgIHByZXNlbmNlQ3VycmVudGx5QWN0aXZlPzogYm9vbGVhbjtcbiAgICBzaG93SW52aXRlQnV0dG9uPzogYm9vbGVhbjtcbiAgICBvbkNsaWNrPygpOiB2b2lkO1xuICAgIHN1cHByZXNzT25Ib3Zlcj86IGJvb2xlYW47XG4gICAgc2hvd1ByZXNlbmNlPzogYm9vbGVhbjtcbiAgICBzdWJ0ZXh0TGFiZWw/OiBzdHJpbmc7XG4gICAgZTJlU3RhdHVzPzogRTJFU3RhdGU7XG4gICAgcG93ZXJTdGF0dXM/OiBQb3dlclN0YXR1cztcbn1cblxuaW50ZXJmYWNlIElTdGF0ZSB7XG4gICAgaG92ZXI6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudGl0eVRpbGUgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PElQcm9wcywgSVN0YXRlPiB7XG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgb25DbGljazogKCkgPT4ge30sXG4gICAgICAgIHByZXNlbmNlU3RhdGU6IFwib2ZmbGluZVwiLFxuICAgICAgICBwcmVzZW5jZUxhc3RBY3RpdmVBZ286IDAsXG4gICAgICAgIHByZXNlbmNlTGFzdFRzOiAwLFxuICAgICAgICBzaG93SW52aXRlQnV0dG9uOiBmYWxzZSxcbiAgICAgICAgc3VwcHJlc3NPbkhvdmVyOiBmYWxzZSxcbiAgICAgICAgc2hvd1ByZXNlbmNlOiB0cnVlLFxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wczogSVByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgaG92ZXI6IGZhbHNlLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgbWFpbkNsYXNzTmFtZXMgPSB7XG4gICAgICAgICAgICBcIm14X0VudGl0eVRpbGVcIjogdHJ1ZSxcbiAgICAgICAgICAgIFwibXhfRW50aXR5VGlsZV9ub0hvdmVyXCI6IHRoaXMucHJvcHMuc3VwcHJlc3NPbkhvdmVyLFxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5jbGFzc05hbWUpIG1haW5DbGFzc05hbWVzW3RoaXMucHJvcHMuY2xhc3NOYW1lXSA9IHRydWU7XG5cbiAgICAgICAgY29uc3QgcHJlc2VuY2VDbGFzcyA9IHByZXNlbmNlQ2xhc3NGb3JNZW1iZXIoXG4gICAgICAgICAgICB0aGlzLnByb3BzLnByZXNlbmNlU3RhdGUsIHRoaXMucHJvcHMucHJlc2VuY2VMYXN0QWN0aXZlQWdvLCB0aGlzLnByb3BzLnNob3dQcmVzZW5jZSxcbiAgICAgICAgKTtcbiAgICAgICAgbWFpbkNsYXNzTmFtZXNbcHJlc2VuY2VDbGFzc10gPSB0cnVlO1xuXG4gICAgICAgIGxldCBuYW1lRWw7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLnByb3BzLm5hbWVKU1ggfHwgdGhpcy5wcm9wcy5uYW1lO1xuXG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5zdXBwcmVzc09uSG92ZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUFnbyA9IHRoaXMucHJvcHMucHJlc2VuY2VMYXN0QWN0aXZlQWdvID9cbiAgICAgICAgICAgICAgICAoRGF0ZS5ub3coKSAtICh0aGlzLnByb3BzLnByZXNlbmNlTGFzdFRzIC0gdGhpcy5wcm9wcy5wcmVzZW5jZUxhc3RBY3RpdmVBZ28pKSA6IC0xO1xuXG4gICAgICAgICAgICBsZXQgcHJlc2VuY2VMYWJlbCA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5zaG93UHJlc2VuY2UpIHtcbiAgICAgICAgICAgICAgICBwcmVzZW5jZUxhYmVsID0gPFByZXNlbmNlTGFiZWwgYWN0aXZlQWdvPXthY3RpdmVBZ299XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseUFjdGl2ZT17dGhpcy5wcm9wcy5wcmVzZW5jZUN1cnJlbnRseUFjdGl2ZX1cbiAgICAgICAgICAgICAgICAgICAgcHJlc2VuY2VTdGF0ZT17dGhpcy5wcm9wcy5wcmVzZW5jZVN0YXRlfSAvPjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLnN1YnRleHRMYWJlbCkge1xuICAgICAgICAgICAgICAgIHByZXNlbmNlTGFiZWwgPSA8c3BhbiBjbGFzc05hbWU9XCJteF9FbnRpdHlUaWxlX3N1YnRleHRcIj57IHRoaXMucHJvcHMuc3VidGV4dExhYmVsIH08L3NwYW4+O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmFtZUVsID0gKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfRW50aXR5VGlsZV9kZXRhaWxzXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXhfRW50aXR5VGlsZV9uYW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IG5hbWUgfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgeyBwcmVzZW5jZUxhYmVsIH1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5zdWJ0ZXh0TGFiZWwpIHtcbiAgICAgICAgICAgIG5hbWVFbCA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0VudGl0eVRpbGVfZGV0YWlsc1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0VudGl0eVRpbGVfbmFtZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyBuYW1lIH1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm14X0VudGl0eVRpbGVfc3VidGV4dFwiPnsgdGhpcy5wcm9wcy5zdWJ0ZXh0TGFiZWwgfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuYW1lRWwgPSAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJteF9FbnRpdHlUaWxlX25hbWVcIj57IG5hbWUgfTwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpbnZpdGVCdXR0b247XG4gICAgICAgIGlmICh0aGlzLnByb3BzLnNob3dJbnZpdGVCdXR0b24pIHtcbiAgICAgICAgICAgIGludml0ZUJ1dHRvbiA9IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0VudGl0eVRpbGVfaW52aXRlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxpbWcgc3JjPXtyZXF1aXJlKFwiLi4vLi4vLi4vLi4vcmVzL2ltZy9wbHVzLnN2Z1wiKS5kZWZhdWx0fSB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwb3dlckxhYmVsO1xuICAgICAgICBjb25zdCBwb3dlclN0YXR1cyA9IHRoaXMucHJvcHMucG93ZXJTdGF0dXM7XG4gICAgICAgIGlmIChwb3dlclN0YXR1cykge1xuICAgICAgICAgICAgY29uc3QgcG93ZXJUZXh0ID0gX3QoUG93ZXJMYWJlbFtwb3dlclN0YXR1c10pO1xuICAgICAgICAgICAgcG93ZXJMYWJlbCA9IDxkaXYgY2xhc3NOYW1lPVwibXhfRW50aXR5VGlsZV9wb3dlclwiPnsgcG93ZXJUZXh0IH08L2Rpdj47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZTJlSWNvbjtcbiAgICAgICAgY29uc3QgeyBlMmVTdGF0dXMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGlmIChlMmVTdGF0dXMpIHtcbiAgICAgICAgICAgIGUyZUljb24gPSA8RTJFSWNvbiBzdGF0dXM9e2UyZVN0YXR1c30gaXNVc2VyPXt0cnVlfSBib3JkZXJlZD17dHJ1ZX0gLz47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhdiA9IHRoaXMucHJvcHMuYXZhdGFySnN4IHx8XG4gICAgICAgICAgICA8QmFzZUF2YXRhciBuYW1lPXt0aGlzLnByb3BzLm5hbWV9IHdpZHRoPXszNn0gaGVpZ2h0PXszNn0gYXJpYS1oaWRkZW49XCJ0cnVlXCIgLz47XG5cbiAgICAgICAgLy8gVGhlIHdyYXBwaW5nIGRpdiBpcyByZXF1aXJlZCB0byBtYWtlIHRoZSBtYWdpYyBtb3VzZSBsaXN0ZW5lciB3b3JrLCBmb3Igc29tZSByZWFzb24uXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhtYWluQ2xhc3NOYW1lcyl9XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlPXt0aGlzLnByb3BzLnRpdGxlfVxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLnByb3BzLm9uQ2xpY2t9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X0VudGl0eVRpbGVfYXZhdGFyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7IGF2IH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgZTJlSWNvbiB9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7IG5hbWVFbCB9XG4gICAgICAgICAgICAgICAgICAgIHsgcG93ZXJMYWJlbCB9XG4gICAgICAgICAgICAgICAgICAgIHsgaW52aXRlQnV0dG9uIH1cbiAgICAgICAgICAgICAgICA8L0FjY2Vzc2libGVCdXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBa0JBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQXpCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0lBV1lBLFc7OztXQUFBQSxXO0VBQUFBLFc7RUFBQUEsVztHQUFBQSxXLDJCQUFBQSxXOztBQUtaLE1BQU1DLFVBQXVDLEdBQUc7RUFDNUMsQ0FBQ0QsV0FBVyxDQUFDRSxLQUFiLEdBQXFCLElBQUFDLG9CQUFBLEVBQUksT0FBSixDQUR1QjtFQUU1QyxDQUFDSCxXQUFXLENBQUNJLFNBQWIsR0FBeUIsSUFBQUQsb0JBQUEsRUFBSSxLQUFKO0FBRm1CLENBQWhEO0FBS0EsTUFBTUUsY0FBYyxHQUFHO0VBQ25CLFdBQVcsdUJBRFE7RUFFbkIsVUFBVSxzQkFGUztFQUduQixlQUFlO0FBSEksQ0FBdkI7O0FBTUEsU0FBU0Msc0JBQVQsQ0FBZ0NDLGFBQWhDLEVBQXVEQyxhQUF2RCxFQUE4RUMsWUFBOUUsRUFBNkc7RUFDekcsSUFBSUEsWUFBWSxLQUFLLEtBQXJCLEVBQTRCO0lBQ3hCLE9BQU8saUNBQVA7RUFDSCxDQUh3RyxDQUt6RztFQUNBOzs7RUFDQSxJQUFJ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