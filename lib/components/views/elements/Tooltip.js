"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.Alignment = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireDefault(require("react"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _classnames = _interopRequireDefault(require("classnames"));

var _UIStore = _interopRequireDefault(require("../../../stores/UIStore"));

var _objects = require("../../../utils/objects");

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

let Alignment;
exports.Alignment = Alignment;

(function (Alignment) {
  Alignment[Alignment["Natural"] = 0] = "Natural";
  Alignment[Alignment["Left"] = 1] = "Left";
  Alignment[Alignment["Right"] = 2] = "Right";
  Alignment[Alignment["Top"] = 3] = "Top";
  Alignment[Alignment["Bottom"] = 4] = "Bottom";
  Alignment[Alignment["InnerBottom"] = 5] = "InnerBottom";
  Alignment[Alignment["TopRight"] = 6] = "TopRight";
})(Alignment || (exports.Alignment = Alignment = {}));

class Tooltip extends _react.default.PureComponent {
  // XXX: This is because some components (Field) are unable to `import` the Tooltip class,
  // so we expose the Alignment options off of us statically.
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "parent", void 0);
    (0, _defineProperty2.default)(this, "updatePosition", () => {
      // When the tooltip is hidden, no need to thrash the DOM with `style` attribute updates (performance)
      if (!this.props.visible) return;
      const parentBox = this.parent.getBoundingClientRect();
      const width = _UIStore.default.instance.windowWidth;
      const spacing = 6;
      const parentWidth = this.props.maxParentWidth ? Math.min(parentBox.width, this.props.maxParentWidth) : parentBox.width;
      const baseTop = parentBox.top + window.scrollY;
      const centerTop = parentBox.top + window.scrollY + parentBox.height / 2;
      const right = width - parentBox.left - window.scrollX;
      const left = parentBox.right + window.scrollX;
      const horizontalCenter = parentBox.left - window.scrollX + parentWidth / 2;
      const style = {};

      switch (this.props.alignment) {
        case Alignment.Natural:
          if (parentBox.right > width / 2) {
            style.right = right + spacing;
            style.top = centerTop;
            style.transform = "translateY(-50%)";
            break;
          }

        // fall through to Right

        case Alignment.Right:
          style.left = left + spacing;
          style.top = centerTop;
          style.transform = "translateY(-50%)";
          break;

        case Alignment.Left:
          style.right = right + spacing;
          style.top = centerTop;
          style.transform = "translateY(-50%)";
          break;

        case Alignment.Top:
          style.top = baseTop - spacing;
          style.left = horizontalCenter;
          style.transform = "translate(-50%, -100%)";
          break;

        case Alignment.Bottom:
          style.top = baseTop + parentBox.height + spacing;
          style.left = horizontalCenter;
          style.transform = "translate(-50%)";
          break;

        case Alignment.InnerBottom:
          style.top = baseTop + parentBox.height - 50;
          style.left = horizontalCenter;
          style.transform = "translate(-50%)";
          break;

        case Alignment.TopRight:
          style.top = baseTop - spacing;
          style.right = width - parentBox.right - window.scrollX;
          style.transform = "translateY(-100%)";
          break;
      }

      this.setState(style);
    });
    this.state = {}; // Create a wrapper for the tooltips and attach it to the body element

    if (!Tooltip.container) {
      Tooltip.container = document.createElement("div");
      Tooltip.container.className = "mx_Tooltip_wrapper";
      document.body.appendChild(Tooltip.container);
    }
  }

  componentDidMount() {
    window.addEventListener('scroll', this.updatePosition, {
      passive: true,
      capture: true
    });
    this.parent = _reactDom.default.findDOMNode(this).parentNode;
    this.updatePosition();
  }

  componentDidUpdate(prevProps) {
    if ((0, _objects.objectHasDiff)(prevProps, this.props)) {
      this.updatePosition();
    }
  } // Remove the wrapper element, as the tooltip has finished using it


  componentWillUnmount() {
    window.removeEventListener('scroll', this.updatePosition, {
      capture: true
    });
  } // Add the parent's position to the tooltips, so it's correctly
  // positioned, also taking into account any window zoom


  render() {
    const tooltipClasses = (0, _classnames.default)("mx_Tooltip", this.props.tooltipClassName, {
      "mx_Tooltip_visible": this.props.visible,
      "mx_Tooltip_invisible": !this.props.visible
    });

    const style = _objectSpread({}, this.state); // Hide the entire container when not visible.
    // This prevents flashing of the tooltip if it is not meant to be visible on first mount.


    style.display = this.props.visible ? "block" : "none";

    const tooltip = /*#__PURE__*/_react.default.createElement("div", {
      role: "tooltip",
      className: tooltipClasses,
      style: style
    }, /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_Tooltip_chevron"
    }), this.props.label);

    return /*#__PURE__*/_react.default.createElement("div", {
      className: this.props.className
    }, /*#__PURE__*/_reactDom.default.createPortal(tooltip, Tooltip.container));
  }

}

exports.default = Tooltip;
(0, _defineProperty2.default)(Tooltip, "container", void 0);
(0, _defineProperty2.default)(Tooltip, "Alignment", Alignment);
(0, _defineProperty2.default)(Tooltip, "defaultProps", {
  visible: true,
  alignment: Alignment.Natural
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBbGlnbm1lbnQiLCJUb29sdGlwIiwiUmVhY3QiLCJQdXJlQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInZpc2libGUiLCJwYXJlbnRCb3giLCJwYXJlbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aWR0aCIsIlVJU3RvcmUiLCJpbnN0YW5jZSIsIndpbmRvd1dpZHRoIiwic3BhY2luZyIsInBhcmVudFdpZHRoIiwibWF4UGFyZW50V2lkdGgiLCJNYXRoIiwibWluIiwiYmFzZVRvcCIsInRvcCIsIndpbmRvdyIsInNjcm9sbFkiLCJjZW50ZXJUb3AiLCJoZWlnaHQiLCJyaWdodCIsImxlZnQiLCJzY3JvbGxYIiwiaG9yaXpvbnRhbENlbnRlciIsInN0eWxlIiwiYWxpZ25tZW50IiwiTmF0dXJhbCIsInRyYW5zZm9ybSIsIlJpZ2h0IiwiTGVmdCIsIlRvcCIsIkJvdHRvbSIsIklubmVyQm90dG9tIiwiVG9wUmlnaHQiLCJzZXRTdGF0ZSIsInN0YXRlIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY29tcG9uZW50RGlkTW91bnQiLCJhZGRFdmVudExpc3RlbmVyIiwidXBkYXRlUG9zaXRpb24iLCJwYXNzaXZlIiwiY2FwdHVyZSIsIlJlYWN0RE9NIiwiZmluZERPTU5vZGUiLCJwYXJlbnROb2RlIiwiY29tcG9uZW50RGlkVXBkYXRlIiwicHJldlByb3BzIiwib2JqZWN0SGFzRGlmZiIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInJlbmRlciIsInRvb2x0aXBDbGFzc2VzIiwiY2xhc3NOYW1lcyIsInRvb2x0aXBDbGFzc05hbWUiLCJkaXNwbGF5IiwidG9vbHRpcCIsImxhYmVsIiwiY3JlYXRlUG9ydGFsIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvdmlld3MvZWxlbWVudHMvVG9vbHRpcC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLypcbkNvcHlyaWdodCAyMDE1LCAyMDE2IE9wZW5NYXJrZXQgTHRkXG5Db3B5cmlnaHQgMjAxOSBOZXcgVmVjdG9yIEx0ZFxuQ29weXJpZ2h0IDIwMTkgTWljaGFlbCBUZWxhdHluc2tpIDw3dDNjaGd1eUBnbWFpbC5jb20+XG5Db3B5cmlnaHQgMjAxOSwgMjAyMCBUaGUgTWF0cml4Lm9yZyBGb3VuZGF0aW9uIEMuSS5DLlxuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG5saW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5cbmltcG9ydCBSZWFjdCwgeyBDU1NQcm9wZXJ0aWVzIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcblxuaW1wb3J0IFVJU3RvcmUgZnJvbSBcIi4uLy4uLy4uL3N0b3Jlcy9VSVN0b3JlXCI7XG5pbXBvcnQgeyBvYmplY3RIYXNEaWZmIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL29iamVjdHNcIjtcblxuZXhwb3J0IGVudW0gQWxpZ25tZW50IHtcbiAgICBOYXR1cmFsLCAvLyBQaWNrIGxlZnQgb3IgcmlnaHRcbiAgICBMZWZ0LFxuICAgIFJpZ2h0LFxuICAgIFRvcCwgLy8gQ2VudGVyZWRcbiAgICBCb3R0b20sIC8vIENlbnRlcmVkXG4gICAgSW5uZXJCb3R0b20sIC8vIEluc2lkZSB0aGUgdGFyZ2V0LCBhdCB0aGUgYm90dG9tXG4gICAgVG9wUmlnaHQsIC8vIE9uIHRvcCBvZiB0aGUgdGFyZ2V0LCByaWdodCBhbGlnbmVkXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRvb2x0aXBQcm9wcyB7XG4gICAgICAgIC8vIENsYXNzIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnQgdXNlZCB0byBwb3NpdGlvbiB0aGUgdG9vbHRpcFxuICAgICAgICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gICAgICAgIC8vIENsYXNzIGFwcGxpZWQgdG8gdGhlIHRvb2x0aXAgaXRzZWxmXG4gICAgICAgIHRvb2x0aXBDbGFzc05hbWU/OiBzdHJpbmc7XG4gICAgICAgIC8vIFdoZXRoZXIgdGhlIHRvb2x0aXAgaXMgdmlzaWJsZSBvciBoaWRkZW4uXG4gICAgICAgIC8vIFRoZSBoaWRkZW4gc3RhdGUgYWxsb3dzIGFuaW1hdGluZyB0aGUgdG9vbHRpcCBhd2F5IHZpYSBDU1MuXG4gICAgICAgIC8vIERlZmF1bHRzIHRvIHZpc2libGUgaWYgdW5zZXQuXG4gICAgICAgIHZpc2libGU/OiBib29sZWFuO1xuICAgICAgICAvLyB0aGUgcmVhY3QgZWxlbWVudCB0byBwdXQgaW50byB0aGUgdG9vbHRpcFxuICAgICAgICBsYWJlbDogUmVhY3QuUmVhY3ROb2RlO1xuICAgICAgICBhbGlnbm1lbnQ/OiBBbGlnbm1lbnQ7IC8vIGRlZmF1bHRzIHRvIE5hdHVyYWxcbiAgICAgICAgLy8gaWQgZGVzY3JpYmluZyB0b29sdGlwXG4gICAgICAgIC8vIHVzZWQgdG8gYXNzb2NpYXRlIHRvb2x0aXAgd2l0aCB0YXJnZXQgZm9yIGExMXlcbiAgICAgICAgaWQ/OiBzdHJpbmc7XG4gICAgICAgIC8vIElmIHRoZSBwYXJlbnQgaXMgb3ZlciB0aGlzIHdpZHRoLCBhY3QgYXMgaWYgaXQgaXMgb25seSB0aGlzIHdpZGVcbiAgICAgICAgbWF4UGFyZW50V2lkdGg/OiBudW1iZXI7XG59XG5cbnR5cGUgU3RhdGUgPSBQYXJ0aWFsPFBpY2s8Q1NTUHJvcGVydGllcywgXCJkaXNwbGF5XCIgfCBcInJpZ2h0XCIgfCBcInRvcFwiIHwgXCJ0cmFuc2Zvcm1cIiB8IFwibGVmdFwiPj47XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvb2x0aXAgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PElUb29sdGlwUHJvcHMsIFN0YXRlPiB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHBhcmVudDogRWxlbWVudDtcblxuICAgIC8vIFhYWDogVGhpcyBpcyBiZWNhdXNlIHNvbWUgY29tcG9uZW50cyAoRmllbGQpIGFyZSB1bmFibGUgdG8gYGltcG9ydGAgdGhlIFRvb2x0aXAgY2xhc3MsXG4gICAgLy8gc28gd2UgZXhwb3NlIHRoZSBBbGlnbm1lbnQgb3B0aW9ucyBvZmYgb2YgdXMgc3RhdGljYWxseS5cbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IEFsaWdubWVudCA9IEFsaWdubWVudDtcblxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICB2aXNpYmxlOiB0cnVlLFxuICAgICAgICBhbGlnbm1lbnQ6IEFsaWdubWVudC5OYXR1cmFsLFxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHt9O1xuXG4gICAgICAgIC8vIENyZWF0ZSBhIHdyYXBwZXIgZm9yIHRoZSB0b29sdGlwcyBhbmQgYXR0YWNoIGl0IHRvIHRoZSBib2R5IGVsZW1lbnRcbiAgICAgICAgaWYgKCFUb29sdGlwLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgVG9vbHRpcC5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgVG9vbHRpcC5jb250YWluZXIuY2xhc3NOYW1lID0gXCJteF9Ub29sdGlwX3dyYXBwZXJcIjtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoVG9vbHRpcC5jb250YWluZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy51cGRhdGVQb3NpdGlvbiwge1xuICAgICAgICAgICAgcGFzc2l2ZTogdHJ1ZSxcbiAgICAgICAgICAgIGNhcHR1cmU6IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucGFyZW50ID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcykucGFyZW50Tm9kZSBhcyBFbGVtZW50O1xuXG4gICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgICAgICBpZiAob2JqZWN0SGFzRGlmZihwcmV2UHJvcHMsIHRoaXMucHJvcHMpKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBvc2l0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgdGhlIHdyYXBwZXIgZWxlbWVudCwgYXMgdGhlIHRvb2x0aXAgaGFzIGZpbmlzaGVkIHVzaW5nIGl0XG4gICAgcHVibGljIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy51cGRhdGVQb3NpdGlvbiwge1xuICAgICAgICAgICAgY2FwdHVyZTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIHRoZSBwYXJlbnQncyBwb3NpdGlvbiB0byB0aGUgdG9vbHRpcHMsIHNvIGl0J3MgY29ycmVjdGx5XG4gICAgLy8gcG9zaXRpb25lZCwgYWxzbyB0YWtpbmcgaW50byBhY2NvdW50IGFueSB3aW5kb3cgem9vbVxuICAgIHByaXZhdGUgdXBkYXRlUG9zaXRpb24gPSAoKTogdm9pZCA9PiB7XG4gICAgICAgIC8vIFdoZW4gdGhlIHRvb2x0aXAgaXMgaGlkZGVuLCBubyBuZWVkIHRvIHRocmFzaCB0aGUgRE9NIHdpdGggYHN0eWxlYCBhdHRyaWJ1dGUgdXBkYXRlcyAocGVyZm9ybWFuY2UpXG4gICAgICAgIGlmICghdGhpcy5wcm9wcy52aXNpYmxlKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgcGFyZW50Qm94ID0gdGhpcy5wYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gVUlTdG9yZS5pbnN0YW5jZS53aW5kb3dXaWR0aDtcbiAgICAgICAgY29uc3Qgc3BhY2luZyA9IDY7XG4gICAgICAgIGNvbnN0IHBhcmVudFdpZHRoID0gKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy5tYXhQYXJlbnRXaWR0aFxuICAgICAgICAgICAgICAgID8gTWF0aC5taW4ocGFyZW50Qm94LndpZHRoLCB0aGlzLnByb3BzLm1heFBhcmVudFdpZHRoKVxuICAgICAgICAgICAgICAgIDogcGFyZW50Qm94LndpZHRoXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGJhc2VUb3AgPSBwYXJlbnRCb3gudG9wICsgd2luZG93LnNjcm9sbFk7XG4gICAgICAgIGNvbnN0IGNlbnRlclRvcCA9IHBhcmVudEJveC50b3AgKyB3aW5kb3cuc2Nyb2xsWSArIChwYXJlbnRCb3guaGVpZ2h0IC8gMik7XG4gICAgICAgIGNvbnN0IHJpZ2h0ID0gd2lkdGggLSBwYXJlbnRCb3gubGVmdCAtIHdpbmRvdy5zY3JvbGxYO1xuICAgICAgICBjb25zdCBsZWZ0ID0gcGFyZW50Qm94LnJpZ2h0ICsgd2luZG93LnNjcm9sbFg7XG4gICAgICAgIGNvbnN0IGhvcml6b250YWxDZW50ZXIgPSAoXG4gICAgICAgICAgICBwYXJlbnRCb3gubGVmdCAtIHdpbmRvdy5zY3JvbGxYICsgKHBhcmVudFdpZHRoIC8gMilcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBzdHlsZTogU3RhdGUgPSB7fTtcbiAgICAgICAgc3dpdGNoICh0aGlzLnByb3BzLmFsaWdubWVudCkge1xuICAgICAgICAgICAgY2FzZSBBbGlnbm1lbnQuTmF0dXJhbDpcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Qm94LnJpZ2h0ID4gd2lkdGggLyAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlLnJpZ2h0ID0gcmlnaHQgKyBzcGFjaW5nO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZS50b3AgPSBjZW50ZXJUb3A7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlWSgtNTAlKVwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZmFsbCB0aHJvdWdoIHRvIFJpZ2h0XG4gICAgICAgICAgICBjYXNlIEFsaWdubWVudC5SaWdodDpcbiAgICAgICAgICAgICAgICBzdHlsZS5sZWZ0ID0gbGVmdCArIHNwYWNpbmc7XG4gICAgICAgICAgICAgICAgc3R5bGUudG9wID0gY2VudGVyVG9wO1xuICAgICAgICAgICAgICAgIHN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlWSgtNTAlKVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBBbGlnbm1lbnQuTGVmdDpcbiAgICAgICAgICAgICAgICBzdHlsZS5yaWdodCA9IHJpZ2h0ICsgc3BhY2luZztcbiAgICAgICAgICAgICAgICBzdHlsZS50b3AgPSBjZW50ZXJUb3A7XG4gICAgICAgICAgICAgICAgc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGVZKC01MCUpXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEFsaWdubWVudC5Ub3A6XG4gICAgICAgICAgICAgICAgc3R5bGUudG9wID0gYmFzZVRvcCAtIHNwYWNpbmc7XG4gICAgICAgICAgICAgICAgc3R5bGUubGVmdCA9IGhvcml6b250YWxDZW50ZXI7XG4gICAgICAgICAgICAgICAgc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGUoLTUwJSwgLTEwMCUpXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEFsaWdubWVudC5Cb3R0b206XG4gICAgICAgICAgICAgICAgc3R5bGUudG9wID0gYmFzZVRvcCArIHBhcmVudEJveC5oZWlnaHQgKyBzcGFjaW5nO1xuICAgICAgICAgICAgICAgIHN0eWxlLmxlZnQgPSBob3Jpem9udGFsQ2VudGVyO1xuICAgICAgICAgICAgICAgIHN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlKC01MCUpXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEFsaWdubWVudC5Jbm5lckJvdHRvbTpcbiAgICAgICAgICAgICAgICBzdHlsZS50b3AgPSBiYXNlVG9wICsgcGFyZW50Qm94LmhlaWdodCAtIDUwO1xuICAgICAgICAgICAgICAgIHN0eWxlLmxlZnQgPSBob3Jpem9udGFsQ2VudGVyO1xuICAgICAgICAgICAgICAgIHN0eWxlLnRyYW5zZm9ybSA9IFwidHJhbnNsYXRlKC01MCUpXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEFsaWdubWVudC5Ub3BSaWdodDpcbiAgICAgICAgICAgICAgICBzdHlsZS50b3AgPSBiYXNlVG9wIC0gc3BhY2luZztcbiAgICAgICAgICAgICAgICBzdHlsZS5yaWdodCA9IHdpZHRoIC0gcGFyZW50Qm94LnJpZ2h0IC0gd2luZG93LnNjcm9sbFg7XG4gICAgICAgICAgICAgICAgc3R5bGUudHJhbnNmb3JtID0gXCJ0cmFuc2xhdGVZKC0xMDAlKVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGF0ZShzdHlsZSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHRvb2x0aXBDbGFzc2VzID0gY2xhc3NOYW1lcyhcIm14X1Rvb2x0aXBcIiwgdGhpcy5wcm9wcy50b29sdGlwQ2xhc3NOYW1lLCB7XG4gICAgICAgICAgICBcIm14X1Rvb2x0aXBfdmlzaWJsZVwiOiB0aGlzLnByb3BzLnZpc2libGUsXG4gICAgICAgICAgICBcIm14X1Rvb2x0aXBfaW52aXNpYmxlXCI6ICF0aGlzLnByb3BzLnZpc2libGUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHN0eWxlID0geyAuLi50aGlzLnN0YXRlIH07XG4gICAgICAgIC8vIEhpZGUgdGhlIGVudGlyZSBjb250YWluZXIgd2hlbiBub3QgdmlzaWJsZS5cbiAgICAgICAgLy8gVGhpcyBwcmV2ZW50cyBmbGFzaGluZyBvZiB0aGUgdG9vbHRpcCBpZiBpdCBpcyBub3QgbWVhbnQgdG8gYmUgdmlzaWJsZSBvbiBmaXJzdCBtb3VudC5cbiAgICAgICAgc3R5bGUuZGlzcGxheSA9IHRoaXMucHJvcHMudmlzaWJsZSA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xuXG4gICAgICAgIGNvbnN0IHRvb2x0aXAgPSAoXG4gICAgICAgICAgICA8ZGl2IHJvbGU9XCJ0b29sdGlwXCIgY2xhc3NOYW1lPXt0b29sdGlwQ2xhc3Nlc30gc3R5bGU9e3N0eWxlfT5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1Rvb2x0aXBfY2hldnJvblwiIC8+XG4gICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLmxhYmVsIH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9PlxuICAgICAgICAgICAgICAgIHsgUmVhY3RET00uY3JlYXRlUG9ydGFsKHRvb2x0aXAsIFRvb2x0aXAuY29udGFpbmVyKSB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBbUJBOztBQUNBOztBQUNBOztBQUVBOztBQUNBOzs7Ozs7SUFFWUEsUzs7O1dBQUFBLFM7RUFBQUEsUyxDQUFBQSxTO0VBQUFBLFMsQ0FBQUEsUztFQUFBQSxTLENBQUFBLFM7RUFBQUEsUyxDQUFBQSxTO0VBQUFBLFMsQ0FBQUEsUztFQUFBQSxTLENBQUFBLFM7RUFBQUEsUyxDQUFBQSxTO0dBQUFBLFMseUJBQUFBLFM7O0FBK0JHLE1BQU1DLE9BQU4sU0FBc0JDLGNBQUEsQ0FBTUMsYUFBNUIsQ0FBZ0U7RUFJM0U7RUFDQTtFQVFBQyxXQUFXLENBQUNDLEtBQUQsRUFBUTtJQUNmLE1BQU1BLEtBQU47SUFEZTtJQUFBLHNEQXVDTSxNQUFZO01BQ2pDO01BQ0EsSUFBSSxDQUFDLEtBQUtBLEtBQUwsQ0FBV0MsT0FBaEIsRUFBeUI7TUFFekIsTUFBTUMsU0FBUyxHQUFHLEtBQUtDLE1BQUwsQ0FBWUMscUJBQVosRUFBbEI7TUFDQSxNQUFNQyxLQUFLLEdBQUdDLGdCQUFBLENBQVFDLFFBQVIsQ0FBaUJDLFdBQS9CO01BQ0EsTUFBTUMsT0FBTyxHQUFHLENBQWhCO01BQ0EsTUFBTUMsV0FBVyxHQUNiLEtBQUtWLEtBQUwsQ0FBV1csY0FBWCxHQUNNQyxJQUFJLENBQUNDLEdBQUwsQ0FBU1gsU0FBUyxDQUFDRyxLQUFuQixFQUEwQixLQUFLTCxLQUFMLENBQVdXLGNBQXJDLENBRE4sR0FFTVQsU0FBUyxDQUFDRyxL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