"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _matrixEventsSdk = require("matrix-events-sdk");

var _ScrollableBaseModal = _interopRequireDefault(require("../dialogs/ScrollableBaseModal"));

var _QuestionDialog = _interopRequireDefault(require("../dialogs/QuestionDialog"));

var _Modal = _interopRequireDefault(require("../../../Modal"));

var _languageHandler = require("../../../languageHandler");

var _arrays = require("../../../utils/arrays");

var _Field = _interopRequireDefault(require("./Field"));

var _AccessibleButton = _interopRequireDefault(require("./AccessibleButton"));

var _Spinner = _interopRequireDefault(require("./Spinner"));

var _localRoom = require("../../../utils/local-room");

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/*
Copyright 2021 - 2022 The Matrix.org Foundation C.I.C.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
var FocusTarget;

(function (FocusTarget) {
  FocusTarget[FocusTarget["Topic"] = 0] = "Topic";
  FocusTarget[FocusTarget["NewOption"] = 1] = "NewOption";
})(FocusTarget || (FocusTarget = {}));

const MIN_OPTIONS = 2;
const MAX_OPTIONS = 20;
const DEFAULT_NUM_OPTIONS = 2;
const MAX_QUESTION_LENGTH = 340;
const MAX_OPTION_LENGTH = 340;

function creatingInitialState() {
  return {
    title: (0, _languageHandler._t)("Create poll"),
    actionLabel: (0, _languageHandler._t)("Create Poll"),
    canSubmit: false,
    // need to add a question and at least one option first
    question: "",
    options: (0, _arrays.arraySeed)("", DEFAULT_NUM_OPTIONS),
    busy: false,
    kind: _matrixEventsSdk.M_POLL_KIND_DISCLOSED,
    autoFocusTarget: FocusTarget.Topic
  };
}

function editingInitialState(editingMxEvent) {
  const poll = editingMxEvent.unstableExtensibleEvent;
  if (!poll?.isEquivalentTo(_matrixEventsSdk.M_POLL_START)) return creatingInitialState();
  return {
    title: (0, _languageHandler._t)("Edit poll"),
    actionLabel: (0, _languageHandler._t)("Done"),
    canSubmit: true,
    question: poll.question.text,
    options: poll.answers.map(ans => ans.text),
    busy: false,
    kind: poll.kind,
    autoFocusTarget: FocusTarget.Topic
  };
}

class PollCreateDialog extends _ScrollableBaseModal.default {
  constructor(props) {
    super(props);
    (0, _defineProperty2.default)(this, "addOptionRef", /*#__PURE__*/(0, _react.createRef)());
    (0, _defineProperty2.default)(this, "onQuestionChange", e => {
      this.setState({
        question: e.target.value
      }, () => this.checkCanSubmit());
    });
    (0, _defineProperty2.default)(this, "onOptionChange", (i, e) => {
      const newOptions = (0, _arrays.arrayFastClone)(this.state.options);
      newOptions[i] = e.target.value;
      this.setState({
        options: newOptions
      }, () => this.checkCanSubmit());
    });
    (0, _defineProperty2.default)(this, "onOptionRemove", i => {
      const newOptions = (0, _arrays.arrayFastClone)(this.state.options);
      newOptions.splice(i, 1);
      this.setState({
        options: newOptions
      }, () => this.checkCanSubmit());
    });
    (0, _defineProperty2.default)(this, "onOptionAdd", () => {
      const newOptions = (0, _arrays.arrayFastClone)(this.state.options);
      newOptions.push("");
      this.setState({
        options: newOptions,
        autoFocusTarget: FocusTarget.NewOption
      }, () => {
        // Scroll the button into view after the state update to ensure we don't experience
        // a pop-in effect, and to avoid the button getting cut off due to a mid-scroll render.
        this.addOptionRef.current?.scrollIntoView?.();
      });
    });
    (0, _defineProperty2.default)(this, "onPollTypeChange", e => {
      this.setState({
        kind: _matrixEventsSdk.M_POLL_KIND_DISCLOSED.matches(e.target.value) ? _matrixEventsSdk.M_POLL_KIND_DISCLOSED : _matrixEventsSdk.M_POLL_KIND_UNDISCLOSED
      });
    });
    this.state = props.editingMxEvent ? editingInitialState(props.editingMxEvent) : creatingInitialState();
  }

  checkCanSubmit() {
    this.setState({
      canSubmit: !this.state.busy && this.state.question.trim().length > 0 && this.state.options.filter(op => op.trim().length > 0).length >= MIN_OPTIONS
    });
  }

  createEvent() {
    const pollStart = _matrixEventsSdk.PollStartEvent.from(this.state.question.trim(), this.state.options.map(a => a.trim()).filter(a => !!a), this.state.kind).serialize();

    if (!this.props.editingMxEvent) {
      return pollStart;
    } else {
      return {
        "content": {
          "m.new_content": pollStart.content,
          "m.relates_to": {
            "rel_type": "m.replace",
            "event_id": this.props.editingMxEvent.getId()
          }
        },
        "type": pollStart.type
      };
    }
  }

  submit() {
    this.setState({
      busy: true,
      canSubmit: false
    });
    const pollEvent = this.createEvent();
    (0, _localRoom.doMaybeLocalRoomAction)(this.props.room.roomId, actualRoomId => this.matrixClient.sendEvent(actualRoomId, this.props.threadId, pollEvent.type, pollEvent.content), this.matrixClient).then(() => this.props.onFinished(true)).catch(e => {
      console.error("Failed to post poll:", e);

      _Modal.default.createDialog(_QuestionDialog.default, {
        title: (0, _languageHandler._t)("Failed to post poll"),
        description: (0, _languageHandler._t)("Sorry, the poll you tried to create was not posted."),
        button: (0, _languageHandler._t)('Try again'),
        cancelButton: (0, _languageHandler._t)('Cancel'),
        onFinished: tryAgain => {
          if (!tryAgain) {
            this.cancel();
          } else {
            this.setState({
              busy: false,
              canSubmit: true
            });
          }
        }
      });
    });
  }

  cancel() {
    this.props.onFinished(false);
  }

  renderContent() {
    return /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_PollCreateDialog"
    }, /*#__PURE__*/_react.default.createElement("h2", null, (0, _languageHandler._t)("Poll type")), /*#__PURE__*/_react.default.createElement(_Field.default, {
      element: "select",
      value: this.state.kind.name,
      onChange: this.onPollTypeChange
    }, /*#__PURE__*/_react.default.createElement("option", {
      key: _matrixEventsSdk.M_POLL_KIND_DISCLOSED.name,
      value: _matrixEventsSdk.M_POLL_KIND_DISCLOSED.name
    }, (0, _languageHandler._t)("Open poll")), /*#__PURE__*/_react.default.createElement("option", {
      key: _matrixEventsSdk.M_POLL_KIND_UNDISCLOSED.name,
      value: _matrixEventsSdk.M_POLL_KIND_UNDISCLOSED.name
    }, (0, _languageHandler._t)("Closed poll"))), /*#__PURE__*/_react.default.createElement("p", null, pollTypeNotes(this.state.kind)), /*#__PURE__*/_react.default.createElement("h2", null, (0, _languageHandler._t)("What is your poll question or topic?")), /*#__PURE__*/_react.default.createElement(_Field.default, {
      id: "poll-topic-input",
      value: this.state.question,
      maxLength: MAX_QUESTION_LENGTH,
      label: (0, _languageHandler._t)("Question or topic"),
      placeholder: (0, _languageHandler._t)("Write something..."),
      onChange: this.onQuestionChange,
      usePlaceholderAsHint: true,
      disabled: this.state.busy,
      autoFocus: this.state.autoFocusTarget === FocusTarget.Topic
    }), /*#__PURE__*/_react.default.createElement("h2", null, (0, _languageHandler._t)("Create options")), this.state.options.map((op, i) => /*#__PURE__*/_react.default.createElement("div", {
      key: `option_${i}`,
      className: "mx_PollCreateDialog_option"
    }, /*#__PURE__*/_react.default.createElement(_Field.default, {
      id: `pollcreate_option_${i}`,
      value: op,
      maxLength: MAX_OPTION_LENGTH,
      label: (0, _languageHandler._t)("Option %(number)s", {
        number: i + 1
      }),
      placeholder: (0, _languageHandler._t)("Write an option"),
      onChange: e => this.onOptionChange(i, e),
      usePlaceholderAsHint: true,
      disabled: this.state.busy,
      autoFocus: this.state.autoFocusTarget === FocusTarget.NewOption && i === this.state.options.length - 1
    }), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: () => this.onOptionRemove(i),
      className: "mx_PollCreateDialog_removeOption",
      disabled: this.state.busy
    }))), /*#__PURE__*/_react.default.createElement(_AccessibleButton.default, {
      onClick: this.onOptionAdd,
      disabled: this.state.busy || this.state.options.length >= MAX_OPTIONS,
      kind: "secondary",
      className: "mx_PollCreateDialog_addOption",
      inputRef: this.addOptionRef
    }, (0, _languageHandler._t)("Add option")), this.state.busy && /*#__PURE__*/_react.default.createElement("div", {
      className: "mx_PollCreateDialog_busy"
    }, /*#__PURE__*/_react.default.createElement(_Spinner.default, null)));
  }

}

exports.default = PollCreateDialog;

function pollTypeNotes(kind) {
  if (_matrixEventsSdk.M_POLL_KIND_DISCLOSED.matches(kind.name)) {
    return (0, _languageHandler._t)("Voters see results as soon as they have voted");
  } else {
    return (0, _languageHandler._t)("Results are only revealed when you end the poll");
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJGb2N1c1RhcmdldCIsIk1JTl9PUFRJT05TIiwiTUFYX09QVElPTlMiLCJERUZBVUxUX05VTV9PUFRJT05TIiwiTUFYX1FVRVNUSU9OX0xFTkdUSCIsIk1BWF9PUFRJT05fTEVOR1RIIiwiY3JlYXRpbmdJbml0aWFsU3RhdGUiLCJ0aXRsZSIsIl90IiwiYWN0aW9uTGFiZWwiLCJjYW5TdWJtaXQiLCJxdWVzdGlvbiIsIm9wdGlvbnMiLCJhcnJheVNlZWQiLCJidXN5Iiwia2luZCIsIk1fUE9MTF9LSU5EX0RJU0NMT1NFRCIsImF1dG9Gb2N1c1RhcmdldCIsIlRvcGljIiwiZWRpdGluZ0luaXRpYWxTdGF0ZSIsImVkaXRpbmdNeEV2ZW50IiwicG9sbCIsInVuc3RhYmxlRXh0ZW5zaWJsZUV2ZW50IiwiaXNFcXVpdmFsZW50VG8iLCJNX1BPTExfU1RBUlQiLCJ0ZXh0IiwiYW5zd2VycyIsIm1hcCIsImFucyIsIlBvbGxDcmVhdGVEaWFsb2ciLCJTY3JvbGxhYmxlQmFzZU1vZGFsIiwiY29uc3RydWN0b3IiLCJwcm9wcyIsImNyZWF0ZVJlZiIsImUiLCJzZXRTdGF0ZSIsInRhcmdldCIsInZhbHVlIiwiY2hlY2tDYW5TdWJtaXQiLCJpIiwibmV3T3B0aW9ucyIsImFycmF5RmFzdENsb25lIiwic3RhdGUiLCJzcGxpY2UiLCJwdXNoIiwiTmV3T3B0aW9uIiwiYWRkT3B0aW9uUmVmIiwiY3VycmVudCIsInNjcm9sbEludG9WaWV3IiwibWF0Y2hlcyIsIk1fUE9MTF9LSU5EX1VORElTQ0xPU0VEIiwidHJpbSIsImxlbmd0aCIsImZpbHRlciIsIm9wIiwiY3JlYXRlRXZlbnQiLCJwb2xsU3RhcnQiLCJQb2xsU3RhcnRFdmVudCIsImZyb20iLCJhIiwic2VyaWFsaXplIiwiY29udGVudCIsImdldElkIiwidHlwZSIsInN1Ym1pdCIsInBvbGxFdmVudCIsImRvTWF5YmVMb2NhbFJvb21BY3Rpb24iLCJyb29tIiwicm9vbUlkIiwiYWN0dWFsUm9vbUlkIiwibWF0cml4Q2xpZW50Iiwic2VuZEV2ZW50IiwidGhyZWFkSWQiLCJ0aGVuIiwib25GaW5pc2hlZCIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiTW9kYWwiLCJjcmVhdGVEaWFsb2ciLCJRdWVzdGlvbkRpYWxvZyIsImRlc2NyaXB0aW9uIiwiYnV0dG9uIiwiY2FuY2VsQnV0dG9uIiwidHJ5QWdhaW4iLCJjYW5jZWwiLCJyZW5kZXJDb250ZW50IiwibmFtZSIsIm9uUG9sbFR5cGVDaGFuZ2UiLCJwb2xsVHlwZU5vdGVzIiwib25RdWVzdGlvbkNoYW5nZSIsIm51bWJlciIsIm9uT3B0aW9uQ2hhbmdlIiwib25PcHRpb25SZW1vdmUiLCJvbk9wdGlvbkFkZCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3ZpZXdzL2VsZW1lbnRzL1BvbGxDcmVhdGVEaWFsb2cudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAyMSAtIDIwMjIgVGhlIE1hdHJpeC5vcmcgRm91bmRhdGlvbiBDLkkuQy5cblxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbnlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbllvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cblVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbmRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxubGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHsgQ2hhbmdlRXZlbnQsIGNyZWF0ZVJlZiB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgUm9vbSB9IGZyb20gXCJtYXRyaXgtanMtc2RrL3NyYy9tb2RlbHMvcm9vbVwiO1xuaW1wb3J0IHtcbiAgICBJUGFydGlhbEV2ZW50LFxuICAgIEtOT1dOX1BPTExfS0lORCxcbiAgICBNX1BPTExfS0lORF9ESVNDTE9TRUQsXG4gICAgTV9QT0xMX0tJTkRfVU5ESVNDTE9TRUQsXG4gICAgTV9QT0xMX1NUQVJULFxuICAgIFBvbGxTdGFydEV2ZW50LFxufSBmcm9tIFwibWF0cml4LWV2ZW50cy1zZGtcIjtcbmltcG9ydCB7IE1hdHJpeEV2ZW50IH0gZnJvbSBcIm1hdHJpeC1qcy1zZGsvc3JjL21vZGVscy9ldmVudFwiO1xuXG5pbXBvcnQgU2Nyb2xsYWJsZUJhc2VNb2RhbCwgeyBJU2Nyb2xsYWJsZUJhc2VTdGF0ZSB9IGZyb20gXCIuLi9kaWFsb2dzL1Njcm9sbGFibGVCYXNlTW9kYWxcIjtcbmltcG9ydCB7IElEaWFsb2dQcm9wcyB9IGZyb20gXCIuLi9kaWFsb2dzL0lEaWFsb2dQcm9wc1wiO1xuaW1wb3J0IFF1ZXN0aW9uRGlhbG9nIGZyb20gXCIuLi9kaWFsb2dzL1F1ZXN0aW9uRGlhbG9nXCI7XG5pbXBvcnQgTW9kYWwgZnJvbSAnLi4vLi4vLi4vTW9kYWwnO1xuaW1wb3J0IHsgX3QgfSBmcm9tIFwiLi4vLi4vLi4vbGFuZ3VhZ2VIYW5kbGVyXCI7XG5pbXBvcnQgeyBhcnJheUZhc3RDbG9uZSwgYXJyYXlTZWVkIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL2FycmF5c1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuL0ZpZWxkXCI7XG5pbXBvcnQgQWNjZXNzaWJsZUJ1dHRvbiBmcm9tIFwiLi9BY2Nlc3NpYmxlQnV0dG9uXCI7XG5pbXBvcnQgU3Bpbm5lciBmcm9tIFwiLi9TcGlubmVyXCI7XG5pbXBvcnQgeyBkb01heWJlTG9jYWxSb29tQWN0aW9uIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL2xvY2FsLXJvb21cIjtcblxuaW50ZXJmYWNlIElQcm9wcyBleHRlbmRzIElEaWFsb2dQcm9wcyB7XG4gICAgcm9vbTogUm9vbTtcbiAgICB0aHJlYWRJZD86IHN0cmluZztcbiAgICBlZGl0aW5nTXhFdmVudD86IE1hdHJpeEV2ZW50OyAgLy8gVHJ1dGh5IGlmIHdlIGFyZSBlZGl0aW5nIGFuIGV4aXN0aW5nIHBvbGxcbn1cblxuZW51bSBGb2N1c1RhcmdldCB7XG4gICAgVG9waWMsXG4gICAgTmV3T3B0aW9uLFxufVxuaW50ZXJmYWNlIElTdGF0ZSBleHRlbmRzIElTY3JvbGxhYmxlQmFzZVN0YXRlIHtcbiAgICBxdWVzdGlvbjogc3RyaW5nO1xuICAgIG9wdGlvbnM6IHN0cmluZ1tdO1xuICAgIGJ1c3k6IGJvb2xlYW47XG4gICAga2luZDogS05PV05fUE9MTF9LSU5EO1xuICAgIGF1dG9Gb2N1c1RhcmdldDogRm9jdXNUYXJnZXQ7XG59XG5cbmNvbnN0IE1JTl9PUFRJT05TID0gMjtcbmNvbnN0IE1BWF9PUFRJT05TID0gMjA7XG5jb25zdCBERUZBVUxUX05VTV9PUFRJT05TID0gMjtcbmNvbnN0IE1BWF9RVUVTVElPTl9MRU5HVEggPSAzNDA7XG5jb25zdCBNQVhfT1BUSU9OX0xFTkdUSCA9IDM0MDtcblxuZnVuY3Rpb24gY3JlYXRpbmdJbml0aWFsU3RhdGUoKTogSVN0YXRlIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogX3QoXCJDcmVhdGUgcG9sbFwiKSxcbiAgICAgICAgYWN0aW9uTGFiZWw6IF90KFwiQ3JlYXRlIFBvbGxcIiksXG4gICAgICAgIGNhblN1Ym1pdDogZmFsc2UsIC8vIG5lZWQgdG8gYWRkIGEgcXVlc3Rpb24gYW5kIGF0IGxlYXN0IG9uZSBvcHRpb24gZmlyc3RcbiAgICAgICAgcXVlc3Rpb246IFwiXCIsXG4gICAgICAgIG9wdGlvbnM6IGFycmF5U2VlZChcIlwiLCBERUZBVUxUX05VTV9PUFRJT05TKSxcbiAgICAgICAgYnVzeTogZmFsc2UsXG4gICAgICAgIGtpbmQ6IE1fUE9MTF9LSU5EX0RJU0NMT1NFRCxcbiAgICAgICAgYXV0b0ZvY3VzVGFyZ2V0OiBGb2N1c1RhcmdldC5Ub3BpYyxcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBlZGl0aW5nSW5pdGlhbFN0YXRlKGVkaXRpbmdNeEV2ZW50OiBNYXRyaXhFdmVudCk6IElTdGF0ZSB7XG4gICAgY29uc3QgcG9sbCA9IGVkaXRpbmdNeEV2ZW50LnVuc3RhYmxlRXh0ZW5zaWJsZUV2ZW50IGFzIFBvbGxTdGFydEV2ZW50O1xuICAgIGlmICghcG9sbD8uaXNFcXVpdmFsZW50VG8oTV9QT0xMX1NUQVJUKSkgcmV0dXJuIGNyZWF0aW5nSW5pdGlhbFN0YXRlKCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICB0aXRsZTogX3QoXCJFZGl0IHBvbGxcIiksXG4gICAgICAgIGFjdGlvbkxhYmVsOiBfdChcIkRvbmVcIiksXG4gICAgICAgIGNhblN1Ym1pdDogdHJ1ZSxcbiAgICAgICAgcXVlc3Rpb246IHBvbGwucXVlc3Rpb24udGV4dCxcbiAgICAgICAgb3B0aW9uczogcG9sbC5hbnN3ZXJzLm1hcChhbnMgPT4gYW5zLnRleHQpLFxuICAgICAgICBidXN5OiBmYWxzZSxcbiAgICAgICAga2luZDogcG9sbC5raW5kLFxuICAgICAgICBhdXRvRm9jdXNUYXJnZXQ6IEZvY3VzVGFyZ2V0LlRvcGljLFxuICAgIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvbGxDcmVhdGVEaWFsb2cgZXh0ZW5kcyBTY3JvbGxhYmxlQmFzZU1vZGFsPElQcm9wcywgSVN0YXRlPiB7XG4gICAgcHJpdmF0ZSBhZGRPcHRpb25SZWYgPSBjcmVhdGVSZWY8SFRNTERpdkVsZW1lbnQ+KCk7XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IocHJvcHM6IElQcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IChcbiAgICAgICAgICAgIHByb3BzLmVkaXRpbmdNeEV2ZW50XG4gICAgICAgICAgICAgICAgPyBlZGl0aW5nSW5pdGlhbFN0YXRlKHByb3BzLmVkaXRpbmdNeEV2ZW50KVxuICAgICAgICAgICAgICAgIDogY3JlYXRpbmdJbml0aWFsU3RhdGUoKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2hlY2tDYW5TdWJtaXQoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgY2FuU3VibWl0OlxuICAgICAgICAgICAgICAgICF0aGlzLnN0YXRlLmJ1c3kgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnF1ZXN0aW9uLnRyaW0oKS5sZW5ndGggPiAwICYmXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5vcHRpb25zLmZpbHRlcihvcCA9PiBvcC50cmltKCkubGVuZ3RoID4gMCkubGVuZ3RoID49IE1JTl9PUFRJT05TLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uUXVlc3Rpb25DaGFuZ2UgPSAoZTogQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHF1ZXN0aW9uOiBlLnRhcmdldC52YWx1ZSB9LCAoKSA9PiB0aGlzLmNoZWNrQ2FuU3VibWl0KCkpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uT3B0aW9uQ2hhbmdlID0gKGk6IG51bWJlciwgZTogQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgICAgY29uc3QgbmV3T3B0aW9ucyA9IGFycmF5RmFzdENsb25lKHRoaXMuc3RhdGUub3B0aW9ucyk7XG4gICAgICAgIG5ld09wdGlvbnNbaV0gPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG9wdGlvbnM6IG5ld09wdGlvbnMgfSwgKCkgPT4gdGhpcy5jaGVja0NhblN1Ym1pdCgpKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbk9wdGlvblJlbW92ZSA9IChpOiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgbmV3T3B0aW9ucyA9IGFycmF5RmFzdENsb25lKHRoaXMuc3RhdGUub3B0aW9ucyk7XG4gICAgICAgIG5ld09wdGlvbnMuc3BsaWNlKGksIDEpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgb3B0aW9uczogbmV3T3B0aW9ucyB9LCAoKSA9PiB0aGlzLmNoZWNrQ2FuU3VibWl0KCkpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIG9uT3B0aW9uQWRkID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdPcHRpb25zID0gYXJyYXlGYXN0Q2xvbmUodGhpcy5zdGF0ZS5vcHRpb25zKTtcbiAgICAgICAgbmV3T3B0aW9ucy5wdXNoKFwiXCIpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgb3B0aW9uczogbmV3T3B0aW9ucywgYXV0b0ZvY3VzVGFyZ2V0OiBGb2N1c1RhcmdldC5OZXdPcHRpb24gfSwgKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2Nyb2xsIHRoZSBidXR0b24gaW50byB2aWV3IGFmdGVyIHRoZSBzdGF0ZSB1cGRhdGUgdG8gZW5zdXJlIHdlIGRvbid0IGV4cGVyaWVuY2VcbiAgICAgICAgICAgIC8vIGEgcG9wLWluIGVmZmVjdCwgYW5kIHRvIGF2b2lkIHRoZSBidXR0b24gZ2V0dGluZyBjdXQgb2ZmIGR1ZSB0byBhIG1pZC1zY3JvbGwgcmVuZGVyLlxuICAgICAgICAgICAgdGhpcy5hZGRPcHRpb25SZWYuY3VycmVudD8uc2Nyb2xsSW50b1ZpZXc/LigpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVFdmVudCgpOiBJUGFydGlhbEV2ZW50PG9iamVjdD4ge1xuICAgICAgICBjb25zdCBwb2xsU3RhcnQgPSBQb2xsU3RhcnRFdmVudC5mcm9tKFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5xdWVzdGlvbi50cmltKCksXG4gICAgICAgICAgICB0aGlzLnN0YXRlLm9wdGlvbnMubWFwKGEgPT4gYS50cmltKCkpLmZpbHRlcihhID0+ICEhYSksXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmtpbmQsXG4gICAgICAgICkuc2VyaWFsaXplKCk7XG5cbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmVkaXRpbmdNeEV2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gcG9sbFN0YXJ0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBcImNvbnRlbnRcIjoge1xuICAgICAgICAgICAgICAgICAgICBcIm0ubmV3X2NvbnRlbnRcIjogcG9sbFN0YXJ0LmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgIFwibS5yZWxhdGVzX3RvXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVsX3R5cGVcIjogXCJtLnJlcGxhY2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZXZlbnRfaWRcIjogdGhpcy5wcm9wcy5lZGl0aW5nTXhFdmVudC5nZXRJZCgpLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJ0eXBlXCI6IHBvbGxTdGFydC50eXBlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBzdWJtaXQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBidXN5OiB0cnVlLCBjYW5TdWJtaXQ6IGZhbHNlIH0pO1xuICAgICAgICBjb25zdCBwb2xsRXZlbnQgPSB0aGlzLmNyZWF0ZUV2ZW50KCk7XG4gICAgICAgIGRvTWF5YmVMb2NhbFJvb21BY3Rpb24oXG4gICAgICAgICAgICB0aGlzLnByb3BzLnJvb20ucm9vbUlkLFxuICAgICAgICAgICAgKGFjdHVhbFJvb21JZDogc3RyaW5nKSA9PiB0aGlzLm1hdHJpeENsaWVudC5zZW5kRXZlbnQoXG4gICAgICAgICAgICAgICAgYWN0dWFsUm9vbUlkLFxuICAgICAgICAgICAgICAgIHRoaXMucHJvcHMudGhyZWFkSWQsXG4gICAgICAgICAgICAgICAgcG9sbEV2ZW50LnR5cGUsXG4gICAgICAgICAgICAgICAgcG9sbEV2ZW50LmNvbnRlbnQsXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgdGhpcy5tYXRyaXhDbGllbnQsXG4gICAgICAgICkudGhlbihcbiAgICAgICAgICAgICgpID0+IHRoaXMucHJvcHMub25GaW5pc2hlZCh0cnVlKSxcbiAgICAgICAgKS5jYXRjaChlID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gcG9zdCBwb2xsOlwiLCBlKTtcbiAgICAgICAgICAgIE1vZGFsLmNyZWF0ZURpYWxvZyhRdWVzdGlvbkRpYWxvZywge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfdChcIkZhaWxlZCB0byBwb3N0IHBvbGxcIiksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IF90KFxuICAgICAgICAgICAgICAgICAgICBcIlNvcnJ5LCB0aGUgcG9sbCB5b3UgdHJpZWQgdG8gY3JlYXRlIHdhcyBub3QgcG9zdGVkLlwiKSxcbiAgICAgICAgICAgICAgICBidXR0b246IF90KCdUcnkgYWdhaW4nKSxcbiAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b246IF90KCdDYW5jZWwnKSxcbiAgICAgICAgICAgICAgICBvbkZpbmlzaGVkOiAodHJ5QWdhaW46IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0cnlBZ2Fpbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBidXN5OiBmYWxzZSwgY2FuU3VibWl0OiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY2FuY2VsKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnByb3BzLm9uRmluaXNoZWQoZmFsc2UpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCByZW5kZXJDb250ZW50KCk6IFJlYWN0LlJlYWN0Tm9kZSB7XG4gICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cIm14X1BvbGxDcmVhdGVEaWFsb2dcIj5cbiAgICAgICAgICAgIDxoMj57IF90KFwiUG9sbCB0eXBlXCIpIH08L2gyPlxuICAgICAgICAgICAgPEZpZWxkXG4gICAgICAgICAgICAgICAgZWxlbWVudD1cInNlbGVjdFwiXG4gICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUua2luZC5uYW1lfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uUG9sbFR5cGVDaGFuZ2V9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPG9wdGlvblxuICAgICAgICAgICAgICAgICAgICBrZXk9e01fUE9MTF9LSU5EX0RJU0NMT1NFRC5uYW1lfVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17TV9QT0xMX0tJTkRfRElTQ0xPU0VELm5hbWV9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7IF90KFwiT3BlbiBwb2xsXCIpIH1cbiAgICAgICAgICAgICAgICA8L29wdGlvbj5cbiAgICAgICAgICAgICAgICA8b3B0aW9uXG4gICAgICAgICAgICAgICAgICAgIGtleT17TV9QT0xMX0tJTkRfVU5ESVNDTE9TRUQubmFtZX1cbiAgICAgICAgICAgICAgICAgICAgdmFsdWU9e01fUE9MTF9LSU5EX1VORElTQ0xPU0VELm5hbWV9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7IF90KFwiQ2xvc2VkIHBvbGxcIikgfVxuICAgICAgICAgICAgICAgIDwvb3B0aW9uPlxuICAgICAgICAgICAgPC9GaWVsZD5cbiAgICAgICAgICAgIDxwPnsgcG9sbFR5cGVOb3Rlcyh0aGlzLnN0YXRlLmtpbmQpIH08L3A+XG4gICAgICAgICAgICA8aDI+eyBfdChcIldoYXQgaXMgeW91ciBwb2xsIHF1ZXN0aW9uIG9yIHRvcGljP1wiKSB9PC9oMj5cbiAgICAgICAgICAgIDxGaWVsZFxuICAgICAgICAgICAgICAgIGlkPSdwb2xsLXRvcGljLWlucHV0J1xuICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnF1ZXN0aW9ufVxuICAgICAgICAgICAgICAgIG1heExlbmd0aD17TUFYX1FVRVNUSU9OX0xFTkdUSH1cbiAgICAgICAgICAgICAgICBsYWJlbD17X3QoXCJRdWVzdGlvbiBvciB0b3BpY1wiKX1cbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17X3QoXCJXcml0ZSBzb21ldGhpbmcuLi5cIil9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMub25RdWVzdGlvbkNoYW5nZX1cbiAgICAgICAgICAgICAgICB1c2VQbGFjZWhvbGRlckFzSGludD17dHJ1ZX1cbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5idXN5fVxuICAgICAgICAgICAgICAgIGF1dG9Gb2N1cz17dGhpcy5zdGF0ZS5hdXRvRm9jdXNUYXJnZXQgPT09IEZvY3VzVGFyZ2V0LlRvcGljfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxoMj57IF90KFwiQ3JlYXRlIG9wdGlvbnNcIikgfTwvaDI+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5vcHRpb25zLm1hcCgob3AsIGkpID0+IDxkaXYga2V5PXtgb3B0aW9uXyR7aX1gfSBjbGFzc05hbWU9XCJteF9Qb2xsQ3JlYXRlRGlhbG9nX29wdGlvblwiPlxuICAgICAgICAgICAgICAgICAgICA8RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPXtgcG9sbGNyZWF0ZV9vcHRpb25fJHtpfWB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17b3B9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhMZW5ndGg9e01BWF9PUFRJT05fTEVOR1RIfVxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw9e190KFwiT3B0aW9uICUobnVtYmVyKXNcIiwgeyBudW1iZXI6IGkgKyAxIH0pfVxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e190KFwiV3JpdGUgYW4gb3B0aW9uXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlOiBDaGFuZ2VFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wdGlvbkNoYW5nZShpLCBlKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlUGxhY2Vob2xkZXJBc0hpbnQ9e3RydWV9XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5idXN5fVxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0ZvY3VzPXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmF1dG9Gb2N1c1RhcmdldCA9PT0gRm9jdXNUYXJnZXQuTmV3T3B0aW9uICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9PT0gdGhpcy5zdGF0ZS5vcHRpb25zLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPEFjY2Vzc2libGVCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMub25PcHRpb25SZW1vdmUoaSl9XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJteF9Qb2xsQ3JlYXRlRGlhbG9nX3JlbW92ZU9wdGlvblwiXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5idXN5fVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDxBY2Nlc3NpYmxlQnV0dG9uXG4gICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5vbk9wdGlvbkFkZH1cbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5zdGF0ZS5idXN5IHx8IHRoaXMuc3RhdGUub3B0aW9ucy5sZW5ndGggPj0gTUFYX09QVElPTlN9XG4gICAgICAgICAgICAgICAga2luZD1cInNlY29uZGFyeVwiXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibXhfUG9sbENyZWF0ZURpYWxvZ19hZGRPcHRpb25cIlxuICAgICAgICAgICAgICAgIGlucHV0UmVmPXt0aGlzLmFkZE9wdGlvblJlZn1cbiAgICAgICAgICAgID57IF90KFwiQWRkIG9wdGlvblwiKSB9PC9BY2Nlc3NpYmxlQnV0dG9uPlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUuYnVzeSAmJlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm14X1BvbGxDcmVhdGVEaWFsb2dfYnVzeVwiPjxTcGlubmVyIC8+PC9kaXY+XG4gICAgICAgICAgICB9XG4gICAgICAgIDwvZGl2PjtcbiAgICB9XG5cbiAgICBvblBvbGxUeXBlQ2hhbmdlID0gKGU6IENoYW5nZUV2ZW50PEhUTUxTZWxlY3RFbGVtZW50PikgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGtpbmQ6IChcbiAgICAgICAgICAgICAgICBNX1BPTExfS0lORF9ESVNDTE9TRUQubWF0Y2hlcyhlLnRhcmdldC52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgPyBNX1BPTExfS0lORF9ESVNDTE9TRURcbiAgICAgICAgICAgICAgICAgICAgOiBNX1BPTExfS0lORF9VTkRJU0NMT1NFRFxuICAgICAgICAgICAgKSxcbiAgICAgICAgfSk7XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gcG9sbFR5cGVOb3RlcyhraW5kOiBLTk9XTl9QT0xMX0tJTkQpOiBzdHJpbmcge1xuICAgIGlmIChNX1BPTExfS0lORF9ESVNDTE9TRUQubWF0Y2hlcyhraW5kLm5hbWUpKSB7XG4gICAgICAgIHJldHVybiBfdChcIlZvdGVycyBzZWUgcmVzdWx0cyBhcyBzb29uIGFzIHRoZXkgaGF2ZSB2b3RlZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gX3QoXCJSZXN1bHRzIGFyZSBvbmx5IHJldmVhbGVkIHdoZW4geW91IGVuZCB0aGUgcG9sbFwiKTtcbiAgICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBZ0JBOztBQUVBOztBQVVBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7QUFyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0lBK0JLQSxXOztXQUFBQSxXO0VBQUFBLFcsQ0FBQUEsVztFQUFBQSxXLENBQUFBLFc7R0FBQUEsVyxLQUFBQSxXOztBQVlMLE1BQU1DLFdBQVcsR0FBRyxDQUFwQjtBQUNBLE1BQU1DLFdBQVcsR0FBRyxFQUFwQjtBQUNBLE1BQU1DLG1CQUFtQixHQUFHLENBQTVCO0FBQ0EsTUFBTUMsbUJBQW1CLEdBQUcsR0FBNUI7QUFDQSxNQUFNQyxpQkFBaUIsR0FBRyxHQUExQjs7QUFFQSxTQUFTQyxvQkFBVCxHQUF3QztFQUNwQyxPQUFPO0lBQ0hDLEtBQUssRUFBRSxJQUFBQyxtQkFBQSxFQUFHLGFBQUgsQ0FESjtJQUVIQyxXQUFXLEVBQUUsSUFBQUQsbUJBQUEsRUFBRyxhQUFILENBRlY7SUFHSEUsU0FBUyxFQUFFLEtBSFI7SUFHZTtJQUNsQkMsUUFBUSxFQUFFLEVBSlA7SUFLSEMsT0FBTyxFQUFFLElBQUFDLGlCQUFBLEVBQVUsRUFBVixFQUFjVixtQkFBZCxDQUxOO0lBTUhXLElBQUksRUFBRSxLQU5IO0lBT0hDLElBQUksRUFBRUMsc0NBUEg7SUFRSEMsZUFBZSxFQUFFakIsV0FBVyxDQUFDa0I7RUFSMUIsQ0FBUDtBQVVIOztBQUVELFNBQVNDLG1CQUFULENBQTZCQyxjQUE3QixFQUFrRTtFQUM5RCxNQUFNQyxJQUFJLEdBQUdELGNBQWMsQ0FBQ0UsdUJBQTVCO0VBQ0EsSUFBSSxDQUFDRCxJQUFJLEVBQUVFLGNBQU4sQ0FBcUJDLDZCQUFyQixDQUFMLEVBQXlDLE9BQU9sQixvQkFBb0IsRUFBM0I7RUFFekMsT0FBTztJQUNIQyxLQUFLLEVBQUUsSUFBQUMsbUJBQUEsRUFBRyxXQUFILENBREo7SUFFSEMsV0FBVyxFQUFFLElBQUFELG1CQUFBLEVBQUcsTUFBSCxDQUZWO0lBR0hFLFNBQVMsRUFBRSxJQUhSO0lBSUhDLFFBQVEsRUFBRVUsSUFBSSxDQUFDVixRQUFMLENBQWNjLElBSnJCO0lBS0hiLE9BQU8sRUFBRVMsSUFBSSxDQUFDSyxPQUFMLENBQWFDLEdBQWIsQ0FBaUJDLEdBQUcsSUFBSUEsR0FBRyxDQUFDSCxJQUE1QixDQUxOO0lBTUhYLElBQUksRUFBRSxLQU5IO0lBT0hDLElBQUksRUFBRU0sSUFBSSxDQUFDTixJQVBSO0lBUUhFLGVBQWUsRUFBRWpCLFdBQVcsQ0FBQ2tCO0VBUjFCLENBQVA7QUFVSDs7QUFFYyxNQUFNVyxnQkFBTixTQUErQkMsNEJBQS9CLENBQW1FO0VBR3ZFQyxXQUFXLENBQUNDLEtBQUQsRUFBZ0I7SUFDOUIsTUFBTUEsS0FBTjtJQUQ4QixpRUFGWCxJQUFBQyxnQkFBQSxHQUVXO0lBQUEsd0RBbUJOQyxDQUFELElBQXNDO01BQzdELEtBQUtDLFFBQUwsQ0FBYztRQUFFeEIsUUFBUSxFQUFFdUIsQ0FBQyxDQUFDRSxNQUFGLENBQVNDO01BQXJCLENBQWQsRUFBNEMsTUFBTSxLQUFLQyxjQUFMLEVBQWxEO0lBQ0gsQ0FyQmlDO0lBQUEsc0RBdUJULENBQUNDLENBQUQsRUFBWUwsQ0FBWixLQUFpRDtNQUN0RSxNQUFNTSxVQUFVLEdBQUcsSUFBQUMsc0JBQUEsRUFBZSxLQUFLQyxLQUFMLENBQVc5QixPQUExQixDQUFuQjtNQUNBNEIsVUFBVSxDQUFDRCxDQUFELENBQVYsR0FBZ0JMLENBQUMsQ0FBQ0UsTUFBRixDQUFTQyxLQUF6QjtNQUNBLEtBQUtGLFFBQUwsQ0FBYztRQUFFdkIsT0FBTyxFQUFFNEI7TUFBWCxDQUFkLEVBQXVDLE1BQU0sS0FBS0YsY0FBTCxFQUE3QztJQUNILENBM0JpQztJQUFBLHNEQTZCUkMsQ0FBRCxJQUFlO01BQ3BDLE1BQU1DLFVBQVUsR0FBRyxJQUFBQyxzQkFBQSxFQUFlLEtBQUtDLEtBQUwsQ0FBVzlCLE9BQTFCLENBQW5CO01BQ0E0QixVQUFVLENBQUNHLE1BQVgsQ0FBa0JKLENBQWxCLEVBQXFCLENBQXJCO01BQ0EsS0FBS0osUUFBTCxDQUFjO1FBQUV2QixPQUFPLEVBQUU0QjtNQUFYLENBQWQsRUFBdUMsTUFBTSxLQUFLRixjQUFMLEVBQTdDO0lBQ0gsQ0FqQ2lDO0lBQUEsbURBbUNaLE1BQU07TUFDeEIsTUFBTUUsVUFBVSxHQUFHLElBQUFDLHNCQUFBLEVBQWUsS0FBS0MsS0FBTCxDQUFXOUIsT0FBMUIsQ0FBbkI7TUFDQTRCLFVBQVUsQ0FBQ0ksSUFBWCxDQUFnQixFQUFoQjtNQUNBLEtBQUtULFFBQUwsQ0FBYztRQUFFdkIsT0FBTyxFQUFFNEIsVUFBWDtRQUF1QnZCLGVBQWUsRUFBRWpCLFdBQVcsQ0FBQzZDO01BQXBELENBQWQsRUFBK0UsTUFBTTtRQUNqRjtRQUNBO1FBQ0EsS0FBS0MsWUFBTCxDQUFrQkMsT0FBbEIsRUFBMkJDLGNBQTNCO01BQ0gsQ0FKRDtJQUtILENBM0NpQztJQUFBLHdEQW9MZGQsQ0FBRCxJQUF1QztNQUN0RCxLQUFLQyxRQUFMLENBQWM7UUFDVnBCLElBQUksRUFDQUMsc0NBQUEsQ0FBc0JpQyxPQUF0QixDQUE4QmYsQ0FBQyxDQUFDRSxNQUFGLENBQVNDLEtBQXZDLElBQ01yQixzQ0FETixHQUVNa0M7TUFKQSxDQUFkO0lBT0gsQ0E1TGlDO0lBRzlCLEtBQUtSLEtBQUwsR0FDSVYsS0FBSyxDQUFDWixjQUFOLEdBQ01ELG1CQUFtQixDQUFDYSxLQUFLLENBQUNaLGNBQVAsQ0FEekIsR0FFTWQsb0JBQW9CLEVBSDlCO0VBS0g7O0VBRU9nQyxjQUFjLEdBQUc7SUFDckIsS0FBS0gsUUFBTCxDQUFjO01BQ1Z6QixTQUFTLEVBQ0wsQ0FBQyxLQUFLZ0MsS0FBTCxDQUFXNUIsSUFBWixJQUNBLEtBQUs0QixLQUFMLENBQVcvQixRQUFYLENBQW9Cd0MsSUFBcEIsR0FBMkJDLE1BQTNCLEdBQW9DLENBRHBDLElBRUEsS0FBS1YsS0FBTCxDQUFXOUIsT0FBWCxDQUFtQnlDLE1BQW5CLENBQTBCQyxFQUFFLElBQUlBLEVBQUUsQ0FBQ0gsSUFBSCxHQUFVQyxNQUFWLEdBQW1CLENBQW5ELEVBQXNEQSxNQUF0RCxJQUFnRW5EO0lBSjFELENBQWQ7RUFNSDs7RUE0Qk9zRCxXQUFXLEdBQTBCO0lBQ3pDLE1BQU1DLFNBQVMsR0FBR0MsK0JBQUEsQ0FBZUMsSUFBZixDQUNkLEtBQUtoQixLQUFMLENBQVcvQixRQUFYLENBQW9Cd0MsSUFBcEIsRUFEYyxFQUVkLEtBQUtULEtBQUwsQ0FBVzlCLE9BQVgsQ0FBbUJlLEdBQW5CLENBQXVCZ0MsQ0FBQyxJQUFJQSxDQUFDLENBQUNSLElBQUYsRUFBNUIsRUFBc0NFLE1BQXRDLENBQTZDTSxDQUFDLElBQUksQ0FBQyxDQUFDQSxDQUFwRCxDQUZjLEVBR2QsS0FBS2pCLEtBQUwsQ0FBVzNCLElBSEcsRUFJaEI2QyxTQUpnQixFQUFsQjs7SUFNQSxJQUFJLENBQUMsS0FBSzVCLEtBQUwsQ0FBV1osY0FBaEIsRUFBZ0M7TUFDNUIsT0FBT29DLFNBQVA7SUFDSCxDQUZELE1BRU87TUFDSCxPQUFPO1FBQ0gsV0FBVztVQUNQLGlCQUFpQkEsU0FBUyxDQUFDSyxPQURwQjtVQUVQLGdCQUFnQjtZQUNaLFlBQVksV0FEQTtZQUVaLFlBQVksS0FBSzdCLEtBQUwsQ0FBV1osY0FBWCxDQUEwQjBDLEtBQTFCO1VBRkE7UUFGVCxDQURSO1FBUUgsUUFBUU4sU0FBUyxDQUFDTztNQVJmLENBQVA7SUFVSDtFQUNKOztFQUVTQyxNQUFNLEdBQVM7SUFDckIsS0FBSzdCLFFBQUwsQ0FBYztNQUFFckIsSUFBSSxFQUFFLElBQVI7TUFBY0osU0FBUyxFQUFFO0lBQXpCLENBQWQ7SUFDQSxNQUFNdUQsU0FBUyxHQUFHLEtBQUtWLFdBQUwsRUFBbEI7SUFDQSxJQUFBVyxpQ0FBQSxFQUNJLEtBQUtsQyxLQUFMLENBQVdtQyxJQUFYLENBQWdCQyxNQURwQixFQUVLQyxZQUFELElBQTBCLEtBQUtDLFlBQUwsQ0FBa0JDLFNBQWxCLENBQ3RCRixZQURzQixFQUV0QixLQUFLckMsS0FBTCxDQUFXd0MsUUFGVyxFQUd0QlAsU0FBUyxDQUFDRixJQUhZLEVBSXRCRSxTQUFTLENBQUNKLE9BSlksQ0FGOUIsRUFRSSxLQUFLUyxZQVJULEVBU0VHLElBVEYsQ0FVSSxNQUFNLEtBQUt6QyxLQUFMLENBQVcwQyxVQUFYLENBQXNCLElBQXRCLENBVlYsRUFXRUMsS0FYRixDQVdRekMsQ0FBQyxJQUFJO01BQ1QwQyxPQUFPLENBQUNDLEtBQVIsQ0FBYyxzQkFBZCxFQUFzQzNDLENBQXRDOztNQUNBNEMsY0FBQSxDQUFNQyxZQUFOLENBQW1CQyx1QkFBbkIsRUFBbUM7UUFDL0J6RSxLQUFLLEVBQUUsSUFBQUMsbUJBQUEsRUFBRyxxQkFBSCxDQUR3QjtRQUUvQnlFLFdBQVcsRUFBRSxJQUFBekUsbUJBQUEsRUFDVCxxREFEUyxDQUZrQjtRQUkvQjBFLE1BQU0sRUFBRSxJQUFBMUUsbUJBQUEsRUFBRyxXQUFILENBSnVCO1FBSy9CMkUsWUFBWSxFQUFFLElBQUEzRSxtQkFBQSxFQUFHLFFBQUgsQ0FMaUI7UUFNL0JrRSxVQUFVLEVBQUdVLFFBQUQsSUFBdUI7VUFDL0IsSUFBSSxDQUFDQSxRQUFMLEVBQWU7WUFDWCxLQUFLQyxNQUFMO1VBQ0gsQ0FGRCxNQUVPO1lBQ0gsS0FBS2xELFFBQUwsQ0FBYztjQUFFckIsSUFBSSxFQUFFLEtBQVI7Y0FBZUosU0FBUyxFQUFFO1lBQTFCLENBQWQ7VUFDSDtRQUNKO01BWjhCLENBQW5DO0lBY0gsQ0EzQkQ7RUE0Qkg7O0VBRVMyRSxNQUFNLEdBQVM7SUFDckIsS0FBS3JELEtBQUwsQ0FBVzBDLFVBQVgsQ0FBc0IsS0FBdEI7RUFDSDs7RUFFU1ksYUFBYSxHQUFvQjtJQUN2QyxvQkFBTztNQUFLLFNBQVMsRUFBQztJQUFmLGdCQUNILHlDQUFNLElBQUE5RSxtQkFBQSxFQUFHLFdBQUgsQ0FBTixDQURHLGVBRUgsNkJBQUMsY0FBRDtNQUNJLE9BQU8sRUFBQyxRQURaO01BRUksS0FBSyxFQUFFLEtBQUtrQyxLQUFMLENBQVczQixJQUFYLENBQWdCd0UsSUFGM0I7TUFHSSxRQUFRLEVBQUUsS0FBS0M7SUFIbkIsZ0JBS0k7TUFDSSxHQUFHLEVBQUV4RSxzQ0FBQSxDQUFzQnVFLElBRC9CO01BRUksS0FBSyxFQUFFdkUsc0NBQUEsQ0FBc0J1RTtJQUZqQyxHQUlNLElBQUEvRSxtQkFBQSxFQUFHLFdBQUgsQ0FKTixDQUxKLGVBV0k7TUFDSSxHQUFHLEVBQUUwQyx3Q0FBQSxDQUF3QnFDLElBRGpDO01BRUksS0FBSyxFQUFFckMsd0NBQUEsQ0FBd0JxQztJQUZuQyxHQUlNLElBQUEvRSxtQkFBQSxFQUFHLGFBQUgsQ0FKTixDQVhKLENBRkcsZUFvQkgsd0NBQUtpRixhQUFhLENBQUMsS0FBSy9DLEtBQUwsQ0FBVzNCLElBQVosQ0FBbEIsQ0FwQkcsZUFxQkgseUNBQU0sSUFBQVAsbUJBQUEsRUFBRyxzQ0FBSCxDQUFOLENBckJHLGVBc0JILDZCQUFDLGNBQUQ7TUFDSSxFQUFFLEVBQUMsa0JBRFA7TUFFSSxLQUFLLEVBQUUsS0FBS2tDLEtBQUwsQ0FBVy9CLFFBRnRCO01BR0ksU0FBUyxFQUFFUCxtQkFIZjtNQUlJLEtBQUssRUFBRSxJQUFBSSxtQkFBQSxFQUFHLG1CQUFILENBSlg7TUFLSSxXQUFXLEVBQUUsSUFBQUEsbUJBQUEsRUFBRyxvQkFBSCxDQUxqQjtNQU1JLFFBQVEsRUFBRSxLQUFLa0YsZ0JBTm5CO01BT0ksb0JBQW9CLEVBQUUsSUFQMUI7TUFRSSxRQUFRLEVBQUUsS0FBS2hELEtBQUwsQ0FBVzVCLElBUnpCO01BU0ksU0FBUyxFQUFFLEtBQUs0QixLQUFMLENBQVd6QixlQUFYLEtBQStCakIsV0FBVyxDQUFDa0I7SUFUMUQsRUF0QkcsZUFpQ0gseUNBQU0sSUFBQVYsbUJBQUEsRUFBRyxnQkFBSCxDQUFOLENBakNHLEVBbUNDLEtBQUtrQyxLQUFMLENBQVc5QixPQUFYLENBQW1CZSxHQUFuQixDQUF1QixDQUFDMkIsRUFBRCxFQUFLZixDQUFMLGtCQUFXO01BQUssR0FBRyxFQUFHLFVBQVNBLENBQUUsRUFBdEI7TUFBeUIsU0FBUyxFQUFDO0lBQW5DLGdCQUM5Qiw2QkFBQyxjQUFEO01BQ0ksRUFBRSxFQUFHLHFCQUFvQkEsQ0FBRSxFQUQvQjtNQUVJLEtBQUssRUFBRWUsRUFGWDtNQUdJLFNBQVMsRUFBRWpELGlCQUhmO01BSUksS0FBSyxFQUFFLElBQUFHLG1CQUFBLEVBQUcsbUJBQUgsRUFBd0I7UUFBRW1GLE1BQU0sRUFBRXBELENBQUMsR0FBRztNQUFkLENBQXhCLENBSlg7TUFLSSxXQUFXLEVBQUUsSUFBQS9CLG1CQUFBLEVBQUcsaUJBQUgsQ0FMakI7TUFNSSxRQUFRLEVBQ0gwQixDQUFELElBQ0ksS0FBSzBELGNBQUwsQ0FBb0JyRCxDQUFwQixFQUF1QkwsQ0FBdkIsQ0FSWjtNQVVJLG9CQUFvQixFQUFFLElBVjFCO01BV0ksUUFBUSxFQUFFLEtBQUtRLEtBQUwsQ0FBVzVCLElBWHpCO01BWUksU0FBUyxFQUNMLEtBQUs0QixLQUFMLENBQVd6QixlQUFYLEtBQStCakIsV0FBVyxDQUFDNkMsU0FBM0MsSUFDQU4sQ0FBQyxLQUFLLEtBQUtHLEtBQUwsQ0FBVzlCLE9BQVgsQ0FBbUJ3QyxNQUFuQixHQUE0QjtJQWQxQyxFQUQ4QixlQWtCOUIsNkJBQUMseUJBQUQ7TUFDSSxPQUFPLEVBQUUsTUFBTSxLQUFLeUMsY0FBTCxDQUFvQnRELENBQXBCLENBRG5CO01BRUksU0FBUyxFQUFDLGtDQUZkO01BR0ksUUFBUSxFQUFFLEtBQUtHLEtBQUwsQ0FBVzVCO0lBSHpCLEVBbEI4QixDQUFsQyxDQW5DRCxlQTRESCw2QkFBQyx5QkFBRDtNQUNJLE9BQU8sRUFBRSxLQUFLZ0YsV0FEbEI7TUFFSSxRQUFRLEVBQUUsS0FBS3BELEtBQUwsQ0FBVzVCLElBQVgsSUFBbUIsS0FBSzRCLEtBQUwsQ0FBVzlCLE9BQVgsQ0FBbUJ3QyxNQUFuQixJQUE2QmxELFdBRjlEO01BR0ksSUFBSSxFQUFDLFdBSFQ7TUFJSSxTQUFTLEVBQUMsK0JBSmQ7TUFLSSxRQUFRLEVBQUUsS0FBSzRDO0lBTG5CLEdBTUcsSUFBQXRDLG1CQUFBLEVBQUcsWUFBSCxDQU5ILENBNURHLEVBb0VDLEtBQUtrQyxLQUFMLENBQVc1QixJQUFYLGlCQUNJO01BQUssU0FBUyxFQUFDO0lBQWYsZ0JBQTBDLDZCQUFDLGdCQUFELE9BQTFDLENBckVMLENBQVA7RUF3RUg7O0FBckw2RTs7OztBQWtNbEYsU0FBUzJFLGFBQVQsQ0FBdUIxRSxJQUF2QixFQUFzRDtFQUNsRCxJQUFJQyxzQ0FBQSxDQUFzQmlDLE9BQXRCLENBQThCbEMsSUFBSSxDQUFDd0UsSUFBbkMsQ0FBSixFQUE4QztJQUMxQyxPQUFPLElBQUEvRSxtQkFBQSxFQUFHLCtDQUFILENBQVA7RUFDSCxDQUZELE1BRU87SUFDSCxPQUFPLElBQUFBLG1CQUFBLEVBQUcsaURBQUgsQ0FBUDtFQUNIO0FBQ0oifQ==